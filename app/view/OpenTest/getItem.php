<?php

use app\view\components\CustomCatalogItem\CustomCatalogItem;
use \app\view\components\CustomRadio\CustomRadio;
use \app\model\User;

if ($item) {
  return getEmployeeHtml($item, $this);
} else {
  ob_start();
  ?>
	<div class="no-element">
		Элемент не найден
		<a class="to-list" href="/adminsc/<?= $this->model; ?>/list">К списку</a>
	</div>
  <?
  return ob_get_clean();
}

function getEmployeeHtml($item, $self)
{
  $options = employeeOptions($item, $self);
  $t = new CustomCatalogItem($options);
  return $t->html;
}


function employeeOptions($item, $self)
{
  $options = [
    'item' => $item,
    'model' => $self->model,
    'tableClassName' => $self->table,
    'pageTitle' => 'Редактировать открытый тест: ' . $item['name'],

//    'tabs' => [
//      ['title' => 'Права',
//        'html' => getRights($item),
//        'field' => 'rights'
//      ]
//    ],

    'fields' => [
      'id' => [
        'className' => 'id',
        'field' => 'id',
        'name' => 'ID',
        'contenteditable' => '',
        'data-type' => 'number',
      ],


      'name' => [
        'className' => 'name',
        'field' => 'name',
        'name' => 'Имя',
        'contenteditable' => 'contenteditable',
        'data-type' => 'string',
      ],


    ],
    'delBttn' => true,
    'toListBttn' => true,
    'saveBttn' => true
  ];

//  if (User::can($item, ['role_admin'])) {
//    $options['fields'] = $options['fields'] + getConfirmRow($item);
//    $options['fields'] = $options['fields'] + getHiredRow($item);
//    $options['fields'] = $options['fields'] + getFiredRow($item);
//  }

  return $options;
}

function getSex($item)
{
  $sex = new CustomRadio([
    'className' => 'custom-radio',
    'title' => '',
    'field' => 'sex',
    'nameFieldName' => 'test_name',
    'tree' => ['m' => 'М', 'f' => 'Ж'],
    'selected' => $item['sex'],
  ]);
  return $sex->html;
}


function getRights($user)
{
  $rights = \app\model\Right::findAll();
  return include ROOT . '/app/view/User/getRightsTab.php';
}




