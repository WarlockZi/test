<?php


namespace app\Repository;


use app\model\Openquestion;
use app\model\Opentest;
use Illuminate\Database\Eloquent\Collection;

class OpenTestRepository
{
    public static function getAnswers(int $testId): array
    {
        return Openquestion::where('opentest_id', '=', $testId)
            ->with('answers')
            ->orderBy('sort')
            ->get()->toArray();
    }

    public static function do(int $testId): array
    {
        return
            Opentest::where('opentest_id', $testId)
                ->with('openquestions.openanswers')
                ->get()
                ->toArray();
    }

    public static function tree()
    {
        return Opentest::whereNull('opentest_id')
            ->with('children')
            ->get();
    }

    public static function getQuestions(int $testId): Collection
    {
        return Openquestion::where('opentest_id', '=', $testId)
            ->orderBy('sort')->get();
    }
}