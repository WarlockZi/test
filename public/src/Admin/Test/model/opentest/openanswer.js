import {$, popup, post} from '../../../../common.js'

export let _answer = {

  async create(button) {

    let question = button.closest('.question-edit')
    let openquestion_id = question.dataset.id
    let sort = question.querySelectorAll('.answer').length + 1
    let res = await post('/adminsc/openanswer/updateOrCreate',
      {openquestion_id, sort})
    let html = res.arr.html
    if (html) {
      button.insertAdjacentHTML("beforebegin", html)
    } else {
      popup.show('Сохранено')
    }
  },

  async del(target) {
    let del_button = target.closest('.delete')
    if (!del_button) return false
    if (confirm("Удалить этот ответ?")) {
      let answer = del_button.closest('.answer')
      let id = +answer.dataset['answerId']
      let res = await post('/adminsc/openanswer/delete', {id})

      if (res) {
        answer.remove()
      }
    }
  },
}
