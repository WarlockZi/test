/*! For license information please see test_edit.js.LICENSE.txt */
!function(){"use strict";let e={serverModel:()=>({id:+window.location.href.split("/").pop(),test_name:i("#test_name").text(),enable:+i("#enable").el[0].checked,isTest:+i("[isTest]").el[0].getAttribute("isTest"),parent:i("select").selectedIndexValue()}),viewModel:()=>({id:+window.location.href.split("/").pop(),test_name:i("#test_name").text(),enable:i("#enable").el[0],parent:i("select").selectedIndexValue()}),id:e=>e??i(".test-name").value(),children:()=>{let e=i(".children").el;return"не содержит"===!e[0].innerText&&e.length},path_create:async()=>{let t=e.serverModel();t.id=0,t.isTest=0;let o=await n("/test/create",t);o=await JSON.parse(o),o&&(window.location.href="/adminsc/test/edit/"+(o.id-1))},name:()=>i(".test-name").el[0].innerText,create:async()=>{let t=e.serverModel();t.id=0,t.isTest=1;let o=await n("/test/updateOrCreate",t);o=await JSON.parse(o),o&&(window.location.href="/adminsc/test/edit/"+(o.id-1))},update:async()=>{let t=e.serverModel(),o=`/adminsc/test/update/${t.id}`,i=await n(o,t);i=await JSON.parse(i),i&&(window.location.href=`/adminsc/test/edit/${t.id}`)},delete:async function(){if(e.children())return t.show("Сначала удалите все тесты из папки"),!1;e.viewModel().enable.checked=!1;let o=e.serverModel(),i=await n("/test/delete",{test:o});i=await JSON.parse(i),i.notAdmin?(t.show("Видимость теста скрыта. Чтобы удалить полностью - обратитесь к ГД"),setTimeout((()=>{window.location="/adminsc/test/edit/400"}),4e3)):window.location="/adminsc/test/edit/400"}},t={show:function(e,t){let n=this.el("div","popup__close");n.innerText="X";let o=this.el("div","popup__item");o.innerText=e,o.append(n);let r=i(".popup").el[0];r||(r=this.el("div","popup")),r.append(o),r.addEventListener("click",this.close),document.body.append(r),setTimeout((()=>{o.classList.remove("popup__item"),o.classList.add("popup-hide")}),5e3),setTimeout((()=>{o.remove(),t&&t()}),5950)},close:function(e){e.target.classList.contains("popup__close")&&this.closest(".popup").remove()},el:function(e,t){let n=document.createElement(e);return n.classList.add(t),n}};async function n(e,t={}){return new Promise((function(n,o){t.token=document.querySelector('meta[name="token"]').getAttribute("content");let i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),t instanceof FormData?i.send(t):(i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send("param="+JSON.stringify(t))),i.onerror=function(){o(Error("Network Error"))},i.onload=async function(){n(i.response)}}))}function o(e){this.el=e,this.elType={}.toString.call(e),this.on=function(t,n){this.el&&("[object HTMLDivElement]"===this.elType&&this.el.addEventListener(t,n),"[object NodeList]"===this.elType&&e.forEach((e=>e.addEventListener(t,n))))},this.value=function(){return this.el[0].getAttribute("value")},this.attr=function(e,t){return t&&this.el[0].setAttribute(e,t),this.el[0].getAttribute(e)},this.selectedIndexValue=function(){if(this.el.length)return this.el[0].selectedOptions[0].value},this.options=function(){if(this.el.length)return this.el[0].options},this.count=function(){return this.el.length},this.text=function(){if(this.el.length)return this.el[0].innerText},this.checked=function(){if(this.el.length)return this.el[0].checked},this.getWithStyle=function(t,n){let o=[];return e.forEach((e=>{e.style[t]===n&&o.push(e)})),o},this.addClass=function(e){"[object HTMLDivElement]"===this.elType&&this.el.classList.add(e),["[object NodeList]","[object Array]"].includes(this.elType)&&this.el.forEach((t=>{t.classList.add(e)}))},this.removeClass=function(e){"[object HTMLDivElement]"===this.elType&&this.el.classList.remove(e),["[object NodeList]","[object Array]"].includes(this.elType)&&this.el.forEach((t=>{t.classList.remove(e)}))},this.hasClass=function(e){if(this.el.classList.contains(e))return!0},this.append=function(e){this.el[0].appendChild(e)},this.find=function(e){return["[object HTMLDivElement]","[object HTMLInputElement]"].includes(this.elType)?this.el.querySelector(e):["[object NodeList]","[object Array]"].includes(this.elType)?this.el[0].querySelector(e):void 0},this.css=function(t,n){if(!n)return this.el[0].style[t];"[object HTMLDivElement]"===this.elType&&(this.el.style[t]=n),"[object NodeList]"===this.elType&&e.forEach((e=>{e.style[t]=n}))}}function i(e){let t="";return t="string"==typeof e?document.querySelectorAll(e):e,new o(t)}i(".test__save").on("click",e.update),i(".test__delete").on("click",e.delete),i(".test-path__create").on("click",e.path_create),i(".test__create").on("click",e.create);let r={el:e=>{let t=e.parentNode.querySelectorAll(".answer"),n=0;t.length&&(n=+i(t[t.length-1]).find(".answer__sort").innerText);let o=i(".answer__create").find(".answer").cloneNode(!0);return o.classList.add("answer"),o.classList.remove("answer__create"),{el:o,id:"new",q_id:+e.closest(".question-edit").id,previous_sort:n,sort:i(o).find(".answer__sort"),checked:i(o).find("input"),text:i(o).find(".answer__text"),delete:i(i(o).find(".answer__delete")).on("click",(function(){r.del(this)}))}},getModelForServer:e=>({answer:"",parent_question:e.q_id,correct_answer:0,pica:""}),async create(e){let t=e.target;!function(e){let n=r.el(t);n.checked.checked=!1,n.el.dataset.answerId=e,n.text.innerText="",n.sort.innerText=n.previous_sort+1,n.el.style.display="flex",t.before(n.el),n.el.style.opacity=1}(await async function(e){let t=r.getModelForServer(r.el(e)),o=await n("/answer/create",t);return o=JSON.parse(o),o.id}(t))},async del(e){let o=e.target;confirm("Удалить этот ответ?")&&(await async function(e){let o=+e.closest(".answer").dataset.answerId,i=await n("/answer/delete",{a_id:o});i=JSON.parse(i),"ok"===i.msg&&t.show("Ответ удален")}(o),function(e){e.parentNode.remove()}(o))}},a={sort:async function(e){let o=[...a.questions()].filter((function(t,n){if(n+1<e)return t})),r=o.map((e=>e.id)),l=await n("/question/sort",{toChange:r});l=JSON.parse(l),l.msg&&t.show(l.msg),o.map(((e,t)=>{i(e).find(".question__sort").innerText=t+1}))},showFirst:()=>{let e=a.cloneEmptyModel();if(!e)return;let t=a.viewModel(e);t.sort.innerText="1",i(t.save).on("click",a.save),i(t.del).on("click",a.delete),i(e).addClass("question-edit"),i(e).removeClass("question__create"),i(".questions").el[0].prepend(e)},cloneEmptyModel:()=>{let e=i(".questions .question__create .question-edit").el[0];if(e)return e.cloneNode(!0)},showAnswers:e=>{let t=e.target,n=i(t.parentNode.parentNode).find(".question__answers");n.classList.toggle("height"),n.classList.toggle("scale"),t.classList.toggle("rotate")},viewModel:e=>({id:+e.id,el:e,sort:e.querySelector(".question__sort"),save:e.querySelector(".question__save"),text:e.querySelector(".question__text"),del:e.querySelector(".question__delete"),createAnswerButton:e.querySelector(".answer__create-button"),addButton:i(i(".questions").el[0]).find(".question__create-button")}),serverModel:()=>({question:{id:null,qustion:"",parent:+window.location.href.split("/").pop(),sort:a.questionsCount()}}),questions:()=>i(".questions>.question-edit").el,questionsCount:()=>i(".questions>.question-edit").el.length,create:async e=>{let t=await a.createOnServer(e);t&&a.createOnView(t)},createOnServer:async()=>{let e=a.serverModel(),t=await n("/question/updateOrCreate",{question:e.question,answers:{}});return t=await JSON.parse(t),t.id},createOnView:e=>{let t=a.cloneEmptyModel(),n=a.viewModel(t);i(n.save).on("click",a.save),i(n.del).on("click",a.delete),i(n.text).on("click",a.showAnswers),i(n.createAnswerButton).on("click",r.create),n.sort.innerText=a.questions().length+1,n.text.innerText="",n.el.id=e,n.addButton.before(t)},save:async e=>{let o=e.target.closest(".question-edit"),i=await n("/question/UpdateOrCreate",{question:a.getModelForServer(o),answers:a.getAnswers(o)});i=await JSON.parse(i),t.show(i.msg)},delete:async e=>{if(confirm("Удалить вопрос со всеми его ответами?")){let n=a.viewModel(e.target.closest(".question-edit")),o=n.id,i=await a.deleteFromServer(o);i&&(a.deleteFromView(n),t.show(i.msg))}},deleteFromView:async e=>{e.el.remove()},deleteFromServer:async e=>{let t=await n("/question/delete",{q_id:e});return JSON.parse(t)},getModelForServer:e=>({id:+e.id,parent:+i(".test-name").el[0].getAttribute("value"),picq:"",qustion:i(e).find(".question__text").innerText,sort:+i(e).find(".question__sort").innerText}),getAnswers:e=>[...e.querySelectorAll(".answer")].map((t=>({id:+t.dataset.answerId,answer:t.querySelector(".answer__text").innerText,correct_answer:+t.querySelector('[type="checkbox"]').checked,parent_question:+e.id,pica:""})),e)};function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function p(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var f=p(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),g=p(/Edge/i),v=p(/firefox/i),m=p(/safari/i)&&!p(/chrome/i)&&!p(/android/i),b=p(/iP(ad|od|hone)/i),w=p(/chrome/i)&&p(/android/i),y={capture:!1,passive:!1};function _(e,t,n){e.addEventListener(t,n,!f&&y)}function E(e,t,n){e.removeEventListener(t,n,!f&&y)}function S(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function T(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function D(e,t,n,o){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&S(e,t):S(e,t))||o&&e===n)return e;if(e===n)break}while(e=T(e))}return null}var x,C=/\s+/g;function O(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(C," ").replace(" "+t+" "," ");e.className=(o+(n?" "+t:"")).replace(C," ")}}function M(e,t,n){var o=e&&e.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in o||-1!==t.indexOf("webkit")||(t="-webkit-"+t),o[t]=n+("string"==typeof n?"":"px")}}function N(e,t){var n="";if("string"==typeof e)n=e;else do{var o=M(e,"transform");o&&"none"!==o&&(n=o+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function A(e,t,n){if(e){var o=e.getElementsByTagName(t),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function k(){return document.scrollingElement||document.documentElement}function q(e,t,n,o,i){if(e.getBoundingClientRect||e===window){var r,a,l,s,c,u,d;if(e!==window&&e.parentNode&&e!==k()?(a=(r=e.getBoundingClientRect()).top,l=r.left,s=r.bottom,c=r.right,u=r.height,d=r.width):(a=0,l=0,s=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!f))do{if(i&&i.getBoundingClientRect&&("none"!==M(i,"transform")||n&&"static"!==M(i,"position"))){var h=i.getBoundingClientRect();a-=h.top+parseInt(M(i,"border-top-width")),l-=h.left+parseInt(M(i,"border-left-width")),s=a+r.height,c=l+r.width;break}}while(i=i.parentNode);if(o&&e!==window){var p=N(i||e),g=p&&p.a,v=p&&p.d;p&&(s=(a/=v)+(u/=v),c=(l/=g)+(d/=g))}return{top:a,left:l,bottom:s,right:c,width:d,height:u}}}function I(e,t,n){for(var o=F(e,!0),i=q(e)[t];o;){var r=q(o)[n];if(!("top"===n||"left"===n?i>=r:i<=r))return o;if(o===k())break;o=F(o,!1)}return!1}function P(e,t,n,o){for(var i=0,r=0,a=e.children;r<a.length;){if("none"!==a[r].style.display&&a[r]!==je.ghost&&(o||a[r]!==je.dragged)&&D(a[r],n.draggable,e,!1)){if(i===t)return a[r];i++}r++}return null}function L(e,t){for(var n=e.lastElementChild;n&&(n===je.ghost||"none"===M(n,"display")||t&&!S(n,t));)n=n.previousElementSibling;return n||null}function X(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===je.clone||t&&!S(e,t)||n++;return n}function R(e){var t=0,n=0,o=k();if(e)do{var i=N(e),r=i.a,a=i.d;t+=e.scrollLeft*r,n+=e.scrollTop*a}while(e!==o&&(e=e.parentNode));return[t,n]}function F(e,t){if(!e||!e.getBoundingClientRect)return k();var n=e,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=M(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return k();if(o||t)return n;o=!0}}}while(n=n.parentNode);return k()}function Y(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function j(e,t){return function(){if(!x){var n=arguments,o=this;1===n.length?e.call(o,n[0]):e.apply(o,n),x=setTimeout((function(){x=void 0}),t)}}}function B(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function H(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var W="Sortable"+(new Date).getTime();var z=[],J={initializeByDefault:!0},V={mount:function(e){for(var t in J)J.hasOwnProperty(t)&&!(t in e)&&(e[t]=J[t]);z.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),z.push(e)},pluginEvent:function(e,t,n){var o=this;this.eventCanceled=!1,n.cancel=function(){o.eventCanceled=!0};var i=e+"Global";z.forEach((function(o){t[o.pluginName]&&(t[o.pluginName][i]&&t[o.pluginName][i](s({sortable:t},n)),t.options[o.pluginName]&&t[o.pluginName][e]&&t[o.pluginName][e](s({sortable:t},n)))}))},initializePlugins:function(e,t,n,o){for(var i in z.forEach((function(o){var i=o.pluginName;if(e.options[i]||o.initializeByDefault){var r=new o(e,t,e.options);r.sortable=e,r.options=e.options,e[i]=r,d(n,r.defaults)}})),e.options)if(e.options.hasOwnProperty(i)){var r=this.modifyOption(e,i,e.options[i]);void 0!==r&&(e.options[i]=r)}},getEventProperties:function(e,t){var n={};return z.forEach((function(o){"function"==typeof o.eventProperties&&d(n,o.eventProperties.call(t[o.pluginName],e))})),n},modifyOption:function(e,t,n){var o;return z.forEach((function(i){e[i.pluginName]&&i.optionListeners&&"function"==typeof i.optionListeners[t]&&(o=i.optionListeners[t].call(e[i.pluginName],n))})),o}};var G=["evt"],U=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.evt,i=h(n,G);V.pluginEvent.bind(je)(e,t,s({dragEl:Z,parentEl:K,ghostEl:Q,rootEl:ee,nextEl:te,lastDownEl:ne,cloneEl:oe,cloneHidden:ie,dragStarted:me,putSortable:ue,activeSortable:je.active,originalEvent:o,oldIndex:re,oldDraggableIndex:le,newIndex:ae,newDraggableIndex:se,hideGhostForTarget:Xe,unhideGhostForTarget:Re,cloneNowHidden:function(){ie=!0},cloneNowShown:function(){ie=!1},dispatchSortableEvent:function(e){$({sortable:t,name:e,originalEvent:o})}},i))};function $(e){!function(e){var t=e.sortable,n=e.rootEl,o=e.name,i=e.targetEl,r=e.cloneEl,a=e.toEl,l=e.fromEl,c=e.oldIndex,u=e.newIndex,d=e.oldDraggableIndex,h=e.newDraggableIndex,p=e.originalEvent,v=e.putSortable,m=e.extraEventProperties;if(t=t||n&&n[W]){var b,w=t.options,y="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||f||g?(b=document.createEvent("Event")).initEvent(o,!0,!0):b=new CustomEvent(o,{bubbles:!0,cancelable:!0}),b.to=a||n,b.from=l||n,b.item=i||n,b.clone=r,b.oldIndex=c,b.newIndex=u,b.oldDraggableIndex=d,b.newDraggableIndex=h,b.originalEvent=p,b.pullMode=v?v.lastPutMode:void 0;var _=s(s({},m),V.getEventProperties(o,t));for(var E in _)b[E]=_[E];n&&n.dispatchEvent(b),w[y]&&w[y].call(t,b)}}(s({putSortable:ue,cloneEl:oe,targetEl:Z,rootEl:ee,oldIndex:re,oldDraggableIndex:le,newIndex:ae,newDraggableIndex:se},e))}var Z,K,Q,ee,te,ne,oe,ie,re,ae,le,se,ce,ue,de,he,pe,fe,ge,ve,me,be,we,ye,_e,Ee=!1,Se=!1,Te=[],De=!1,xe=!1,Ce=[],Oe=!1,Me=[],Ne="undefined"!=typeof document,Ae=b,ke=g||f?"cssFloat":"float",qe=Ne&&!w&&!b&&"draggable"in document.createElement("div"),Ie=function(){if(Ne){if(f)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Pe=function(e,t){var n=M(e),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=P(e,0,t),r=P(e,1,t),a=i&&M(i),l=r&&M(r),s=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+q(i).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+q(r).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&a.float&&"none"!==a.float){var u="left"===a.float?"left":"right";return!r||"both"!==l.clear&&l.clear!==u?"horizontal":"vertical"}return i&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||s>=o&&"none"===n[ke]||r&&"none"===n[ke]&&s+c>o)?"vertical":"horizontal"},Le=function(e){function t(e,n){return function(o,i,r,a){var l=o.options.group.name&&i.options.group.name&&o.options.group.name===i.options.group.name;if(null==e&&(n||l))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(o,i,r,a),n)(o,i,r,a);var s=(n?o:i).options.group.name;return!0===e||"string"==typeof e&&e===s||e.join&&e.indexOf(s)>-1}}var n={},o=e.group;o&&"object"==c(o)||(o={name:o}),n.name=o.name,n.checkPull=t(o.pull,!0),n.checkPut=t(o.put),n.revertClone=o.revertClone,e.group=n},Xe=function(){!Ie&&Q&&M(Q,"display","none")},Re=function(){!Ie&&Q&&M(Q,"display","")};Ne&&document.addEventListener("click",(function(e){if(Se)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Se=!1,!1}),!0);var Fe=function(e){if(Z){e=e.touches?e.touches[0]:e;var t=(i=e.clientX,r=e.clientY,Te.some((function(e){var t=e[W].options.emptyInsertThreshold;if(t&&!L(e)){var n=q(e),o=i>=n.left-t&&i<=n.right+t,l=r>=n.top-t&&r<=n.bottom+t;return o&&l?a=e:void 0}})),a);if(t){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[W]._onDragOver(n)}}var i,r,a},Ye=function(e){Z&&Z.parentNode[W]._isOutsideThisEl(e.target)};function je(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=d({},t),e[W]=this;var n,o,i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Pe(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==je.supportPointer&&"PointerEvent"in window&&!m,emptyInsertThreshold:5};for(var r in V.initializePlugins(this,e,i),i)!(r in t)&&(t[r]=i[r]);for(var a in Le(t),this)"_"===a.charAt(0)&&"function"==typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!t.forceFallback&&qe,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?_(e,"pointerdown",this._onTapStart):(_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Te.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),d(this,(o=[],{captureAnimationState:function(){o=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(e){if("none"!==M(e,"display")&&e!==je.ghost){o.push({target:e,rect:q(e)});var t=s({},o[o.length-1].rect);if(e.thisAnimationDuration){var n=N(e,!0);n&&(t.top-=n.f,t.left-=n.e)}e.fromRect=t}}))},addAnimationState:function(e){o.push(e)},removeAnimationState:function(e){o.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[n][o])return Number(n);return-1}(o,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(n),void("function"==typeof e&&e());var i=!1,r=0;o.forEach((function(e){var n=0,o=e.target,a=o.fromRect,l=q(o),s=o.prevFromRect,c=o.prevToRect,u=e.rect,d=N(o,!0);d&&(l.top-=d.f,l.left-=d.e),o.toRect=l,o.thisAnimationDuration&&Y(s,l)&&!Y(a,l)&&(u.top-l.top)/(u.left-l.left)==(a.top-l.top)/(a.left-l.left)&&(n=function(e,t,n,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*o.animation}(u,s,c,t.options)),Y(l,a)||(o.prevFromRect=a,o.prevToRect=l,n||(n=t.options.animation),t.animate(o,u,l,n)),n&&(i=!0,r=Math.max(r,n),clearTimeout(o.animationResetTimer),o.animationResetTimer=setTimeout((function(){o.animationTime=0,o.prevFromRect=null,o.fromRect=null,o.prevToRect=null,o.thisAnimationDuration=null}),n),o.thisAnimationDuration=n)})),clearTimeout(n),i?n=setTimeout((function(){"function"==typeof e&&e()}),r):"function"==typeof e&&e(),o=[]},animate:function(e,t,n,o){if(o){M(e,"transition",""),M(e,"transform","");var i=N(this.el),r=i&&i.a,a=i&&i.d,l=(t.left-n.left)/(r||1),s=(t.top-n.top)/(a||1);e.animatingX=!!l,e.animatingY=!!s,M(e,"transform","translate3d("+l+"px,"+s+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),M(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),M(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){M(e,"transition",""),M(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),o)}}}))}function Be(e,t,n,o,i,r,a,l){var s,c,u=e[W],d=u.options.onMove;return!window.CustomEvent||f||g?(s=document.createEvent("Event")).initEvent("move",!0,!0):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=t,s.from=e,s.dragged=n,s.draggedRect=o,s.related=i||t,s.relatedRect=r||q(t),s.willInsertAfter=l,s.originalEvent=a,e.dispatchEvent(s),d&&(c=d.call(u,s,a)),c}function He(e){e.draggable=!1}function We(){Oe=!1}function ze(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,o=0;n--;)o+=t.charCodeAt(n);return o.toString(36)}function Je(e){return setTimeout(e,0)}function Ve(e){return clearTimeout(e)}je.prototype={constructor:je,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(be=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Z):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,o=this.options,i=o.preventOnFilter,r=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,l=(a||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=o.filter;if(function(e){Me.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var o=t[n];o.checked&&Me.push(o)}}(n),!Z&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||o.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!m||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=D(l,o.draggable,n,!1))&&l.animated||ne===l)){if(re=X(l),le=X(l,o.draggable),"function"==typeof c){if(c.call(this,e,l,this))return $({sortable:t,rootEl:s,name:"filter",targetEl:l,toEl:n,fromEl:n}),U("filter",t,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(o){if(o=D(s,o.trim(),n,!1))return $({sortable:t,rootEl:o,name:"filter",targetEl:l,fromEl:n,toEl:n}),U("filter",t,{evt:e}),!0}))))return void(i&&e.cancelable&&e.preventDefault());o.handle&&!D(s,o.handle,n,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,t,n){var o,i=this,r=i.el,a=i.options,l=r.ownerDocument;if(n&&!Z&&n.parentNode===r){var s=q(n);if(ee=r,K=(Z=n).parentNode,te=Z.nextSibling,ne=n,ce=a.group,je.dragged=Z,de={target:Z,clientX:(t||e).clientX,clientY:(t||e).clientY},ge=de.clientX-s.left,ve=de.clientY-s.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Z.style["will-change"]="all",o=function(){U("delayEnded",i,{evt:e}),je.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!v&&i.nativeDraggable&&(Z.draggable=!0),i._triggerDragStart(e,t),$({sortable:i,name:"choose",originalEvent:e}),O(Z,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){A(Z,e.trim(),He)})),_(l,"dragover",Fe),_(l,"mousemove",Fe),_(l,"touchmove",Fe),_(l,"mouseup",i._onDrop),_(l,"touchend",i._onDrop),_(l,"touchcancel",i._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Z.draggable=!0),U("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(g||f))o();else{if(je.eventCanceled)return void this._onDrop();_(l,"mouseup",i._disableDelayedDrag),_(l,"touchend",i._disableDelayedDrag),_(l,"touchcancel",i._disableDelayedDrag),_(l,"mousemove",i._delayedDragTouchMoveHandler),_(l,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&_(l,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(o,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Z&&He(Z),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;E(e,"mouseup",this._disableDelayedDrag),E(e,"touchend",this._disableDelayedDrag),E(e,"touchcancel",this._disableDelayedDrag),E(e,"mousemove",this._delayedDragTouchMoveHandler),E(e,"touchmove",this._delayedDragTouchMoveHandler),E(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?_(document,"pointermove",this._onTouchMove):_(document,t?"touchmove":"mousemove",this._onTouchMove):(_(Z,"dragend",this),_(ee,"dragstart",this._onDragStart));try{document.selection?Je((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(Ee=!1,ee&&Z){U("dragStarted",this,{evt:t}),this.nativeDraggable&&_(document,"dragover",Ye);var n=this.options;!e&&O(Z,n.dragClass,!1),O(Z,n.ghostClass,!0),je.active=this,e&&this._appendGhost(),$({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(he){this._lastX=he.clientX,this._lastY=he.clientY,Xe();for(var e=document.elementFromPoint(he.clientX,he.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(he.clientX,he.clientY))!==t;)t=e;if(Z.parentNode[W]._isOutsideThisEl(e),t)do{if(t[W]&&t[W]._onDragOver({clientX:he.clientX,clientY:he.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);Re()}},_onTouchMove:function(e){if(de){var t=this.options,n=t.fallbackTolerance,o=t.fallbackOffset,i=e.touches?e.touches[0]:e,r=Q&&N(Q,!0),a=Q&&r&&r.a,l=Q&&r&&r.d,s=Ae&&_e&&R(_e),c=(i.clientX-de.clientX+o.x)/(a||1)+(s?s[0]-Ce[0]:0)/(a||1),u=(i.clientY-de.clientY+o.y)/(l||1)+(s?s[1]-Ce[1]:0)/(l||1);if(!je.active&&!Ee){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Q){r?(r.e+=c-(pe||0),r.f+=u-(fe||0)):r={a:1,b:0,c:0,d:1,e:c,f:u};var d="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");M(Q,"webkitTransform",d),M(Q,"mozTransform",d),M(Q,"msTransform",d),M(Q,"transform",d),pe=c,fe=u,he=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Q){var e=this.options.fallbackOnBody?document.body:ee,t=q(Z,!0,Ae,!0,e),n=this.options;if(Ae){for(_e=e;"static"===M(_e,"position")&&"none"===M(_e,"transform")&&_e!==document;)_e=_e.parentNode;_e!==document.body&&_e!==document.documentElement?(_e===document&&(_e=k()),t.top+=_e.scrollTop,t.left+=_e.scrollLeft):_e=k(),Ce=R(_e)}O(Q=Z.cloneNode(!0),n.ghostClass,!1),O(Q,n.fallbackClass,!0),O(Q,n.dragClass,!0),M(Q,"transition",""),M(Q,"transform",""),M(Q,"box-sizing","border-box"),M(Q,"margin",0),M(Q,"top",t.top),M(Q,"left",t.left),M(Q,"width",t.width),M(Q,"height",t.height),M(Q,"opacity","0.8"),M(Q,"position",Ae?"absolute":"fixed"),M(Q,"zIndex","100000"),M(Q,"pointerEvents","none"),je.ghost=Q,e.appendChild(Q),M(Q,"transform-origin",ge/parseInt(Q.style.width)*100+"% "+ve/parseInt(Q.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,o=e.dataTransfer,i=n.options;U("dragStart",this,{evt:e}),je.eventCanceled?this._onDrop():(U("setupClone",this),je.eventCanceled||((oe=H(Z)).draggable=!1,oe.style["will-change"]="",this._hideClone(),O(oe,this.options.chosenClass,!1),je.clone=oe),n.cloneId=Je((function(){U("clone",n),je.eventCanceled||(n.options.removeCloneOnHide||ee.insertBefore(oe,Z),n._hideClone(),$({sortable:n,name:"clone"}))})),!t&&O(Z,i.dragClass,!0),t?(Se=!0,n._loopId=setInterval(n._emulateDragOver,50)):(E(document,"mouseup",n._onDrop),E(document,"touchend",n._onDrop),E(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(n,o,Z)),_(document,"drop",n),M(Z,"transform","translateZ(0)")),Ee=!0,n._dragStartId=Je(n._dragStarted.bind(n,t,e)),_(document,"selectstart",n),me=!0,m&&M(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,o,i,r=this.el,a=e.target,l=this.options,c=l.group,u=je.active,d=ce===c,h=l.sort,p=ue||u,f=this,g=!1;if(!Oe){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),a=D(a,l.draggable,r,!0),R("dragOver"),je.eventCanceled)return g;if(Z.contains(e.target)||a.animated&&a.animatingX&&a.animatingY||f._ignoreWhileAnimating===a)return Y(!1);if(Se=!1,u&&!l.disabled&&(d?h||(o=K!==ee):ue===this||(this.lastPutMode=ce.checkPull(this,u,Z,e))&&c.checkPut(this,u,Z,e))){if(i="vertical"===this._getDirection(e,a),t=q(Z),R("dragOverValid"),je.eventCanceled)return g;if(o)return K=ee,F(),this._hideClone(),R("revert"),je.eventCanceled||(te?ee.insertBefore(Z,te):ee.appendChild(Z)),Y(!0);var v=L(r,l.draggable);if(!v||function(e,t,n){var o=q(L(n.el,n.options.draggable));return t?e.clientX>o.right+10||e.clientX<=o.right&&e.clientY>o.bottom&&e.clientX>=o.left:e.clientX>o.right&&e.clientY>o.top||e.clientX<=o.right&&e.clientY>o.bottom+10}(e,i,this)&&!v.animated){if(v===Z)return Y(!1);if(v&&r===e.target&&(a=v),a&&(n=q(a)),!1!==Be(ee,r,Z,t,a,n,e,!!a))return F(),r.appendChild(Z),K=r,j(),Y(!0)}else if(v&&function(e,t,n){var o=q(P(n.el,0,n.options,!0));return t?e.clientX<o.left-10||e.clientY<o.top&&e.clientX<o.right:e.clientY<o.top-10||e.clientY<o.bottom&&e.clientX<o.left}(e,i,this)){var m=P(r,0,l,!0);if(m===Z)return Y(!1);if(n=q(a=m),!1!==Be(ee,r,Z,t,a,n,e,!1))return F(),r.insertBefore(Z,m),K=r,j(),Y(!0)}else if(a.parentNode===r){n=q(a);var b,w,y,_=Z.parentNode!==r,E=!function(e,t,n){var o=n?e.left:e.top,i=n?e.right:e.bottom,r=n?e.width:e.height,a=n?t.left:t.top,l=n?t.right:t.bottom,s=n?t.width:t.height;return o===a||i===l||o+r/2===a+s/2}(Z.animated&&Z.toRect||t,a.animated&&a.toRect||n,i),S=i?"top":"left",T=I(a,"top","top")||I(Z,"top","top"),x=T?T.scrollTop:void 0;if(be!==a&&(w=n[S],De=!1,xe=!E&&l.invertSwap||_),0!==(b=function(e,t,n,o,i,r,a,l){var s=o?e.clientY:e.clientX,c=o?n.height:n.width,u=o?n.top:n.left,d=o?n.bottom:n.right,h=!1;if(!a)if(l&&ye<c*i){if(!De&&(1===we?s>u+c*r/2:s<d-c*r/2)&&(De=!0),De)h=!0;else if(1===we?s<u+ye:s>d-ye)return-we}else if(s>u+c*(1-i)/2&&s<d-c*(1-i)/2)return function(e){return X(Z)<X(e)?1:-1}(t);return(h=h||a)&&(s<u+c*r/2||s>d-c*r/2)?s>u+c/2?1:-1:0}(e,a,n,i,E?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,xe,be===a))){var C=X(Z);do{C-=b,y=K.children[C]}while(y&&("none"===M(y,"display")||y===Q))}if(0===b||y===a)return Y(!1);be=a,we=b;var N=a.nextElementSibling,A=!1,k=Be(ee,r,Z,t,a,n,e,A=1===b);if(!1!==k)return 1!==k&&-1!==k||(A=1===k),Oe=!0,setTimeout(We,30),F(),A&&!N?r.appendChild(Z):a.parentNode.insertBefore(Z,A?N:a),T&&B(T,0,x-T.scrollTop),K=Z.parentNode,void 0===w||xe||(ye=Math.abs(w-q(a)[S])),j(),Y(!0)}if(r.contains(Z))return Y(!1)}return!1}function R(l,c){U(l,f,s({evt:e,isOwner:d,axis:i?"vertical":"horizontal",revert:o,dragRect:t,targetRect:n,canSort:h,fromSortable:p,target:a,completed:Y,onMove:function(n,o){return Be(ee,r,Z,t,n,q(n),e,o)},changed:j},c))}function F(){R("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function Y(t){return R("dragOverCompleted",{insertion:t}),t&&(d?u._hideClone():u._showClone(f),f!==p&&(O(Z,ue?ue.options.ghostClass:u.options.ghostClass,!1),O(Z,l.ghostClass,!0)),ue!==f&&f!==je.active?ue=f:f===je.active&&ue&&(ue=null),p===f&&(f._ignoreWhileAnimating=a),f.animateAll((function(){R("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(a===Z&&!Z.animated||a===r&&!a.animated)&&(be=null),l.dragoverBubble||e.rootEl||a===document||(Z.parentNode[W]._isOutsideThisEl(e.target),!t&&Fe(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function j(){ae=X(Z),se=X(Z,l.draggable),$({sortable:f,name:"change",toEl:r,newIndex:ae,newDraggableIndex:se,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){E(document,"mousemove",this._onTouchMove),E(document,"touchmove",this._onTouchMove),E(document,"pointermove",this._onTouchMove),E(document,"dragover",Fe),E(document,"mousemove",Fe),E(document,"touchmove",Fe)},_offUpEvents:function(){var e=this.el.ownerDocument;E(e,"mouseup",this._onDrop),E(e,"touchend",this._onDrop),E(e,"pointerup",this._onDrop),E(e,"touchcancel",this._onDrop),E(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;ae=X(Z),se=X(Z,n.draggable),U("drop",this,{evt:e}),K=Z&&Z.parentNode,ae=X(Z),se=X(Z,n.draggable),je.eventCanceled||(Ee=!1,xe=!1,De=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ve(this.cloneId),Ve(this._dragStartId),this.nativeDraggable&&(E(document,"drop",this),E(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),m&&M(document.body,"user-select",""),M(Z,"transform",""),e&&(me&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Q&&Q.parentNode&&Q.parentNode.removeChild(Q),(ee===K||ue&&"clone"!==ue.lastPutMode)&&oe&&oe.parentNode&&oe.parentNode.removeChild(oe),Z&&(this.nativeDraggable&&E(Z,"dragend",this),He(Z),Z.style["will-change"]="",me&&!Ee&&O(Z,ue?ue.options.ghostClass:this.options.ghostClass,!1),O(Z,this.options.chosenClass,!1),$({sortable:this,name:"unchoose",toEl:K,newIndex:null,newDraggableIndex:null,originalEvent:e}),ee!==K?(ae>=0&&($({rootEl:K,name:"add",toEl:K,fromEl:ee,originalEvent:e}),$({sortable:this,name:"remove",toEl:K,originalEvent:e}),$({rootEl:K,name:"sort",toEl:K,fromEl:ee,originalEvent:e}),$({sortable:this,name:"sort",toEl:K,originalEvent:e})),ue&&ue.save()):ae!==re&&ae>=0&&($({sortable:this,name:"update",toEl:K,originalEvent:e}),$({sortable:this,name:"sort",toEl:K,originalEvent:e})),je.active&&(null!=ae&&-1!==ae||(ae=re,se=le),$({sortable:this,name:"end",toEl:K,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){U("nulling",this),ee=Z=K=Q=te=oe=ne=ie=de=he=me=ae=se=re=le=be=we=ue=ce=je.dragged=je.ghost=je.clone=je.active=null,Me.forEach((function(e){e.checked=!0})),Me.length=pe=fe=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Z&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,o=0,i=n.length,r=this.options;o<i;o++)D(e=n[o],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||ze(e));return t},sort:function(e,t){var n={},o=this.el;this.toArray().forEach((function(e,t){var i=o.children[t];D(i,this.options.draggable,o,!1)&&(n[e]=i)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(o.removeChild(n[e]),o.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return D(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var o=V.modifyOption(this,e,t);n[e]=void 0!==o?o:t,"group"===e&&Le(n)},destroy:function(){U("destroy",this);var e=this.el;e[W]=null,E(e,"mousedown",this._onTapStart),E(e,"touchstart",this._onTapStart),E(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(E(e,"dragover",this),E(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Te.splice(Te.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ie){if(U("hideClone",this),je.eventCanceled)return;M(oe,"display","none"),this.options.removeCloneOnHide&&oe.parentNode&&oe.parentNode.removeChild(oe),ie=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ie){if(U("showClone",this),je.eventCanceled)return;Z.parentNode!=ee||this.options.group.revertClone?te?ee.insertBefore(oe,te):ee.appendChild(oe):ee.insertBefore(oe,Z),this.options.group.revertClone&&this.animate(Z,oe),M(oe,"display",""),ie=!1}}else this._hideClone()}},Ne&&_(document,"touchmove",(function(e){(je.active||Ee)&&e.cancelable&&e.preventDefault()})),je.utils={on:_,off:E,css:M,find:A,is:function(e,t){return!!D(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:j,closest:D,toggleClass:O,clone:H,index:X,nextTick:Je,cancelNextTick:Ve,detectDirection:Pe,getChild:P},je.get=function(e){return e[W]},je.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(je.utils=s(s({},je.utils),e.utils)),V.mount(e)}))},je.create=function(e,t){return new je(e,t)},je.version="1.14.0";var Ge,Ue,$e,Ze,Ke,Qe,et=[],tt=!1;function nt(){et.forEach((function(e){clearInterval(e.pid)})),et=[]}function ot(){clearInterval(Qe)}var it=j((function(e,t,n,o){if(t.scroll){var i,r=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,s=t.scrollSpeed,c=k(),u=!1;Ue!==n&&(Ue=n,nt(),Ge=t.scroll,i=t.scrollFn,!0===Ge&&(Ge=F(n,!0)));var d=0,h=Ge;do{var p=h,f=q(p),g=f.top,v=f.bottom,m=f.left,b=f.right,w=f.width,y=f.height,_=void 0,E=void 0,S=p.scrollWidth,T=p.scrollHeight,D=M(p),x=p.scrollLeft,C=p.scrollTop;p===c?(_=w<S&&("auto"===D.overflowX||"scroll"===D.overflowX||"visible"===D.overflowX),E=y<T&&("auto"===D.overflowY||"scroll"===D.overflowY||"visible"===D.overflowY)):(_=w<S&&("auto"===D.overflowX||"scroll"===D.overflowX),E=y<T&&("auto"===D.overflowY||"scroll"===D.overflowY));var O=_&&(Math.abs(b-r)<=l&&x+w<S)-(Math.abs(m-r)<=l&&!!x),N=E&&(Math.abs(v-a)<=l&&C+y<T)-(Math.abs(g-a)<=l&&!!C);if(!et[d])for(var A=0;A<=d;A++)et[A]||(et[A]={});et[d].vx==O&&et[d].vy==N&&et[d].el===p||(et[d].el=p,et[d].vx=O,et[d].vy=N,clearInterval(et[d].pid),0==O&&0==N||(u=!0,et[d].pid=setInterval(function(){o&&0===this.layer&&je.active._onTouchMove(Ke);var t=et[this.layer].vy?et[this.layer].vy*s:0,n=et[this.layer].vx?et[this.layer].vx*s:0;"function"==typeof i&&"continue"!==i.call(je.dragged.parentNode[W],n,t,e,Ke,et[this.layer].el)||B(et[this.layer].el,n,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==c&&(h=F(h,!1)));tt=u}}),30),rt=function(e){var t=e.originalEvent,n=e.putSortable,o=e.dragEl,i=e.activeSortable,r=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var s=n||i;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(c.clientX,c.clientY);l(),s&&!s.el.contains(u)&&(r("spill"),this.onSpill({dragEl:o,putSortable:n}))}};function at(){}function lt(){}at.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var o=P(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:rt},d(at,{pluginName:"revertOnSpill"}),lt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:rt},d(lt,{pluginName:"removeOnSpill"}),je.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):this.options.supportPointer?_(document,"pointermove",this._handleFallbackAutoScroll):t.touches?_(document,"touchmove",this._handleFallbackAutoScroll):_(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?E(document,"dragover",this._handleAutoScroll):(E(document,"pointermove",this._handleFallbackAutoScroll),E(document,"touchmove",this._handleFallbackAutoScroll),E(document,"mousemove",this._handleFallbackAutoScroll)),ot(),nt(),clearTimeout(x),x=void 0},nulling:function(){Ke=Ue=Ge=tt=Qe=$e=Ze=null,et.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,r=document.elementFromPoint(o,i);if(Ke=e,t||this.options.forceAutoScrollFallback||g||f||m){it(e,this.options,r,t);var a=F(r,!0);!tt||Qe&&o===$e&&i===Ze||(Qe&&ot(),Qe=setInterval((function(){var r=F(document.elementFromPoint(o,i),!0);r!==a&&(a=r,nt()),it(e,n.options,r,t)}),10),$e=o,Ze=i)}else{if(!this.options.bubbleScroll||F(r,!0)===k())return void nt();it(e,this.options,F(r,!1),!1)}}},d(e,{pluginName:"scroll",initializeByDefault:!0})}),je.mount(lt,at);var st=je;!function(e){switch(!0){case/\/adminsc\/test/.test(e):i(".module.test").addClass("activ")}}(window.location.pathname),!a.questions().length&&/\/adminsc\/test\/edit/.test(window.location.pathname)&&a.showFirst(),(e=>{let t=i(e).el[0];t&&st.create(t,{animation:150,onEnd:function(e){a.questions(),a.sort(e.newIndex);for(let t=0;t<e.newIndex;t++);}})})(".questions"),i(".test__update").on("click",e.update),i(".test-path__update").on("click",e.update),i(".question__save").on("click",a.save),i(".question__text").on("click",a.showAnswers),i(".question__delete").on("click",a.delete),i(".question__create-button").on("click",a.create),i(".answer__delete").on("click",r.del),i(".answer__create-button").on("click",r.create)}();