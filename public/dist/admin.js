/*! For license information please see admin.js.LICENSE.txt */
!function(){"use strict";var e={317:function(e,t,n){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{$:function(){return d},$k:function(){return s},Ds:function(){return a},MT:function(){return u},gk:function(){return r},mN:function(){return o},v_:function(){return l}});const a=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700;return function(){const i=()=>e.apply(this,arguments);clearTimeout(t),t=setTimeout(i,n)}};function o(e){return function(e){return e.trim()}(e=function(e){var t=new RegExp("\\t?","g");return e.replace(t,"")}(e=function(e){var t=new RegExp("\\n?","g");return e.replace(t,"")}(e=function(e){var t=new RegExp("&nbsp;?","g");return e.replace(t," ")}(e))))}function s(e){return o(d(e)[0].outerHTML)}let r={show:function(e,t){let n=this.el("div","popup__close");n.innerText="X";let i=this.el("div","popup__item");i.innerText=e,i.append(n);let a=d(".popup")[0];a||(a=this.el("div","popup")),a.append(i),a.addEventListener("click",this.close,!0),document.body.append(a),setTimeout((()=>{i.classList.remove("popup__item"),i.classList.add("popup-hide")}),5e3),setTimeout((()=>{i.remove(),t&&t()}),5950)},close:function(e){e.target.classList.contains("popup__close")&&this.closest(".popup").remove()},el:function(e,t){let n=document.createElement(e);return n.classList.add(t),n}};async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((async function(n,i){t.token=document.querySelector('meta[name="token"]').getAttribute("content");let a=new XMLHttpRequest;a.open("POST",e,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),t instanceof FormData?a.send(t):(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send("param="+JSON.stringify(t))),a.onerror=function(e){i(Error("Network Error"+e))},a.onload=function(){var e;let t=JSON.parse(a.response),i=d(".message")[0];var o;t.popup||null!=t&&null!==(e=t.arr)&&void 0!==e&&e.popup?r.show(t.popup??(null==t||null===(o=t.arr)||void 0===o?void 0:o.popup)):t.msg?i&&(i.innerHTML=t.msg,i.innerHTML=t.msg,d(i).removeClass("success"),d(i).removeClass("error")):t.success?i&&(i.innerHTML=t.success,d(i).addClass("success"),d(i).removeClass("error")):t.error&&i&&(i.innerHTML="",i.innerHTML=t.error,d(i).removeClass("success"),d(i).addClass("error")),n(t)}}))}class c extends Array{constructor(){super(...arguments),i(this,"value",(function(){return this[0].getAttribute("value")})),i(this,"attr",(function(e,t){return t&&this[0].setAttribute(e,t),this[0].getAttribute(e)})),i(this,"selectedIndexValue",(function(){if(this.length)return this[0].selectedOptions[0].value})),i(this,"options",(function(){if(this.length)return this[0].options})),i(this,"count",(function(){return this.length})),i(this,"text",(function(){if(this.length)return this[0].innerText})),i(this,"checked",(function(){if(this.length)return this[0].checked})),i(this,"getWithStyle",(function(e,t){let n=[];return this.forEach((i=>{i.style[e]===t&&n.push(i)})),n})),i(this,"addClass",(function(e){this.forEach((t=>{t.classList.add(e)}))})),i(this,"removeClass",(function(e){this.forEach((t=>{t.classList.remove(e)}))})),i(this,"hasClass",(function(e){if(this.classList.contains(e))return!0})),i(this,"append",(function(e){this[0].appendChild(e)})),i(this,"find",(function(e){return"string"==typeof e?this[0].querySelector(e):this[0].filter((t=>t===e))[0]})),i(this,"findAll",(function(e){if("string"==typeof e)return this[0].querySelectorAll(e)})),i(this,"css",(function(e,t){if(!t)return this[0].style[e];this.forEach((n=>{n.style[e]=t}))}))}on(e,t,n){"function"==typeof t?this.forEach((n=>n.addEventListener(e,t))):this.forEach((i=>{i.addEventListener(e,(e=>{e.target===t&&n(e)}))}))}ready(e){this.some((e=>null!=e.readyState&&"loading"!=e.readyState))?e():document.addEventListener("DOMContentLoaded",e)}}function d(e){return"string"==typeof e||e instanceof String?new c(...document.querySelectorAll(e)):new c(e)}function u(e,t,n,i,a,o){let s=new Date(e),r=s.getFullYear(),l=s.getMonth()+1,c=s.getDate();return c<10&&(c="0"+c),l<10&&(l="0"+l),{yyyy:r,mm:l,dd:c,M:["January","February","March","April","May","June","July","August","September","October","November","December"][s.getMonth()],D:s.getDay(),wd:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"][s.getDay()]}}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e=n(317);if((0,e.$)("[accordion]")){let n=(0,e.$)("[accordion] [type='checkbox']");n&&[...n].filter((e=>{e.checked=!1})),(0,e.$)("[accordion]").on("click",(function(n){let{target:i}=n,a=i.closest("li");if(!a)return;let o=(0,e.$)(a).find("ul");if(o)if(o.classList.contains("open"))t(o,a);else{if(!o)return;let n=a.closest("ul");!function(n){if(!n)return;let i=(0,e.$)(n).find("li>ul.open");if(i){let e=i.closest("li");t(i,e)}}(n),function(e,t,n){n&&(n.style.maxHeight=e.scrollHeight+n.scrollHeight+"px"),e.style.maxHeight=e.scrollHeight+"px",e.classList.toggle("open"),t.classList.toggle("rotate")}(o,a,n)}else!function(e){e.classList.toggle("rotate")}(a)}))}function t(e,t){e.style.maxHeight="0px",e.classList.toggle("open"),t.classList.toggle("rotate")}(0,e.$)(".admin_sidebar")[0]&&(0,e.$)("svg#burger").on("click",(function(){(0,e.$)(".admin_sidebar [accordion]")[0].classList.toggle("show")}));let i=(0,e.$)("[custom-date]");if(i)for(let t of i)t.onchange=function(t){let{target:n}=t,{yyyy:i,mm:a,dd:o}=(0,e.MT)(n.value),s=`${i}-${a}-${o}`;n.value,n.setAttribute("data-value",s)};const a={delServer:async t=>{(0,e.$)(".opentest")[0]?await(0,e.v_)("/adminsc/opentestresult/delete",{id:t}):await(0,e.v_)("/adminsc/testresult/delete",{id:t})},delDom:t=>{[].map.call((0,e.$)(`[data-row = "${t}"]`),(function(e){e.remove()}))},delete:e=>{confirm("Удалить результат теста?")&&(a.delServer(e),a.delDom(e))}};let o=(0,e.$)(".test-results__table")[0];function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}o&&(0,e.$)(o).on("click",(function(e){let{target:t}=e;if(t.closest(".del-btn")){let e=t.closest(".del-btn").dataset.row;a.delete(e)}})),(0,e.$)(".testresult")[0]&&((0,e.$)(".accordion_wrap")[0].remove(),(0,e.$)(".page-name")[0].remove(),(0,e.$)(".test-name")[0].remove(),(0,e.$)(".test-do__finish-btn")[0].remove());const r=new class{constructor(){var t;s(this,"model","openquestion"),s(this,"questions",(0,e.$)(".questions>.question-edit")),s(this,"testId",+(null===(t=(0,e.$)(".questions")[0])||void 0===t?void 0:t.dataset.testId)??null),s(this,"questionCnt",(0,e.$)(".questions>.question-edit").length??null)}async create(t){let n=this.testId,i=this.questionCnt+1,a=await(0,e.v_)(`/adminsc/${this.model}/updateOrCreate`,{id:0,opentest_id:n,sort:i});if(a.arr.id){let e=this.cloneEmptyModel();e.querySelector(".sort").innerText=this.questionCnt+1,e.querySelector(".text").innerText="",e.dataset.id=a.arr.id,t.before(e)}}cloneEmptyModel(){let t=(0,e.$)(".questions .question-edit")[0];if(t){let e=t.cloneNode(!0),n=e.querySelectorAll(".row .answer");return[].forEach.call(n,(function(e){e.remove()})),e}}async sort(t){let n=this.questions.filter((function(e,n){if(n+1<t)return e})),i=n.map((e=>e.dataset.id));await(0,e.v_)(`/${this.model}/sort`,{toChange:i}),n.map(((t,n)=>{(0,e.$)(t).find(".sort").innerText=n+1}))}async changeParent(t){let n=+t.options[t.selectedIndex].value;if(!n)return;let i=t.closest(".question-edit"),a=i.dataset.id,o=t.innerText;await(0,e.v_)(`/adminsc/${this.model}/changeParent`,{id:a,test_id:n})&&(i.remove(),e.gk.show("Перемещен в "+o))}showAnswers(t){let n=t.closest(".question-edit"),i=(0,e.$)(n).find(".question__answers");i.classList.toggle("height"),i.classList.toggle("scale"),t.classList.toggle("rotate")}async del(t){if(confirm("Удалить вопрос со всеми его ответами?")){let n=t.closest(".question-edit"),i=n.dataset.id;await(0,e.v_)(`/adminsc/${this.model}/delete`,{id:i})&&n.remove()}}};function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},p.apply(this,arguments)}function h(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function f(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var m=f(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),g=f(/Edge/i),v=f(/firefox/i),b=f(/safari/i)&&!f(/chrome/i)&&!f(/android/i),w=f(/iP(ad|od|hone)/i),y=f(/chrome/i)&&f(/android/i),_={capture:!1,passive:!1};function E(e,t,n){e.addEventListener(t,n,!m&&_)}function $(e,t,n){e.removeEventListener(t,n,!m&&_)}function S(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function x(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function T(e,t,n,i){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&S(e,t):S(e,t))||i&&e===n)return e;if(e===n)break}while(e=x(e))}return null}var C,L=/\s+/g;function D(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(L," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(L," ")}}function A(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function k(e,t){var n="";if("string"==typeof e)n=e;else do{var i=A(e,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(n)}function q(e,t,n){if(e){var i=e.getElementsByTagName(t),a=0,o=i.length;if(n)for(;a<o;a++)n(i[a],a);return i}return[]}function O(){return document.scrollingElement||document.documentElement}function M(e,t,n,i,a){if(e.getBoundingClientRect||e===window){var o,s,r,l,c,d,u;if(e!==window&&e.parentNode&&e!==O()?(s=(o=e.getBoundingClientRect()).top,r=o.left,l=o.bottom,c=o.right,d=o.height,u=o.width):(s=0,r=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(a=a||e.parentNode,!m))do{if(a&&a.getBoundingClientRect&&("none"!==A(a,"transform")||n&&"static"!==A(a,"position"))){var p=a.getBoundingClientRect();s-=p.top+parseInt(A(a,"border-top-width")),r-=p.left+parseInt(A(a,"border-left-width")),l=s+o.height,c=r+o.width;break}}while(a=a.parentNode);if(i&&e!==window){var h=k(a||e),f=h&&h.a,g=h&&h.d;h&&(l=(s/=g)+(d/=g),c=(r/=f)+(u/=f))}return{top:s,left:r,bottom:l,right:c,width:u,height:d}}}function I(e,t,n){for(var i=X(e,!0),a=M(e)[t];i;){var o=M(i)[n];if(!("top"===n||"left"===n?a>=o:a<=o))return i;if(i===O())break;i=X(i,!1)}return!1}function N(e,t,n,i){for(var a=0,o=0,s=e.children;o<s.length;){if("none"!==s[o].style.display&&s[o]!==Ye.ghost&&(i||s[o]!==Ye.dragged)&&T(s[o],n.draggable,e,!1)){if(a===t)return s[o];a++}o++}return null}function P(e,t){for(var n=e.lastElementChild;n&&(n===Ye.ghost||"none"===A(n,"display")||t&&!S(n,t));)n=n.previousElementSibling;return n||null}function R(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ye.clone||t&&!S(e,t)||n++;return n}function B(e){var t=0,n=0,i=O();if(e)do{var a=k(e),o=a.a,s=a.d;t+=e.scrollLeft*o,n+=e.scrollTop*s}while(e!==i&&(e=e.parentNode));return[t,n]}function X(e,t){if(!e||!e.getBoundingClientRect)return O();var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var a=A(n);if(n.clientWidth<n.scrollWidth&&("auto"==a.overflowX||"scroll"==a.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==a.overflowY||"scroll"==a.overflowY)){if(!n.getBoundingClientRect||n===document.body)return O();if(i||t)return n;i=!0}}}while(n=n.parentNode);return O()}function H(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function Y(e,t){return function(){if(!C){var n=arguments,i=this;1===n.length?e.call(i,n[0]):e.apply(i,n),C=setTimeout((function(){C=void 0}),t)}}}function j(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function F(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var W="Sortable"+(new Date).getTime();var z=[],V={initializeByDefault:!0},U={mount:function(e){for(var t in V)V.hasOwnProperty(t)&&!(t in e)&&(e[t]=V[t]);z.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),z.push(e)},pluginEvent:function(e,t,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var a=e+"Global";z.forEach((function(i){t[i.pluginName]&&(t[i.pluginName][a]&&t[i.pluginName][a](c({sortable:t},n)),t.options[i.pluginName]&&t[i.pluginName][e]&&t[i.pluginName][e](c({sortable:t},n)))}))},initializePlugins:function(e,t,n,i){for(var a in z.forEach((function(i){var a=i.pluginName;if(e.options[a]||i.initializeByDefault){var o=new i(e,t,e.options);o.sortable=e,o.options=e.options,e[a]=o,p(n,o.defaults)}})),e.options)if(e.options.hasOwnProperty(a)){var o=this.modifyOption(e,a,e.options[a]);void 0!==o&&(e.options[a]=o)}},getEventProperties:function(e,t){var n={};return z.forEach((function(i){"function"==typeof i.eventProperties&&p(n,i.eventProperties.call(t[i.pluginName],e))})),n},modifyOption:function(e,t,n){var i;return z.forEach((function(a){e[a.pluginName]&&a.optionListeners&&"function"==typeof a.optionListeners[t]&&(i=a.optionListeners[t].call(e[a.pluginName],n))})),i}};var G=["evt"],Q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.evt,a=h(n,G);U.pluginEvent.bind(Ye)(e,t,c({dragEl:Z,parentEl:K,ghostEl:ee,rootEl:te,nextEl:ne,lastDownEl:ie,cloneEl:ae,cloneHidden:oe,dragStarted:be,putSortable:ue,activeSortable:Ye.active,originalEvent:i,oldIndex:se,oldDraggableIndex:le,newIndex:re,newDraggableIndex:ce,hideGhostForTarget:Re,unhideGhostForTarget:Be,cloneNowHidden:function(){oe=!0},cloneNowShown:function(){oe=!1},dispatchSortableEvent:function(e){J({sortable:t,name:e,originalEvent:i})}},a))};function J(e){!function(e){var t=e.sortable,n=e.rootEl,i=e.name,a=e.targetEl,o=e.cloneEl,s=e.toEl,r=e.fromEl,l=e.oldIndex,d=e.newIndex,u=e.oldDraggableIndex,p=e.newDraggableIndex,h=e.originalEvent,f=e.putSortable,v=e.extraEventProperties;if(t=t||n&&n[W]){var b,w=t.options,y="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||m||g?(b=document.createEvent("Event")).initEvent(i,!0,!0):b=new CustomEvent(i,{bubbles:!0,cancelable:!0}),b.to=s||n,b.from=r||n,b.item=a||n,b.clone=o,b.oldIndex=l,b.newIndex=d,b.oldDraggableIndex=u,b.newDraggableIndex=p,b.originalEvent=h,b.pullMode=f?f.lastPutMode:void 0;var _=c(c({},v),U.getEventProperties(i,t));for(var E in _)b[E]=_[E];n&&n.dispatchEvent(b),w[y]&&w[y].call(t,b)}}(c({putSortable:ue,cloneEl:ae,targetEl:Z,rootEl:te,oldIndex:se,oldDraggableIndex:le,newIndex:re,newDraggableIndex:ce},e))}var Z,K,ee,te,ne,ie,ae,oe,se,re,le,ce,de,ue,pe,he,fe,me,ge,ve,be,we,ye,_e,Ee,$e=!1,Se=!1,xe=[],Te=!1,Ce=!1,Le=[],De=!1,Ae=[],ke="undefined"!=typeof document,qe=w,Oe=g||m?"cssFloat":"float",Me=ke&&!y&&!w&&"draggable"in document.createElement("div"),Ie=function(){if(ke){if(m)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Ne=function(e,t){var n=A(e),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),a=N(e,0,t),o=N(e,1,t),s=a&&A(a),r=o&&A(o),l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+M(a).width,c=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+M(o).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&s.float&&"none"!==s.float){var d="left"===s.float?"left":"right";return!o||"both"!==r.clear&&r.clear!==d?"horizontal":"vertical"}return a&&("block"===s.display||"flex"===s.display||"table"===s.display||"grid"===s.display||l>=i&&"none"===n[Oe]||o&&"none"===n[Oe]&&l+c>i)?"vertical":"horizontal"},Pe=function(e){function t(e,n){return function(i,a,o,s){var r=i.options.group.name&&a.options.group.name&&i.options.group.name===a.options.group.name;if(null==e&&(n||r))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(i,a,o,s),n)(i,a,o,s);var l=(n?i:a).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},i=e.group;i&&"object"==d(i)||(i={name:i}),n.name=i.name,n.checkPull=t(i.pull,!0),n.checkPut=t(i.put),n.revertClone=i.revertClone,e.group=n},Re=function(){!Ie&&ee&&A(ee,"display","none")},Be=function(){!Ie&&ee&&A(ee,"display","")};ke&&!y&&document.addEventListener("click",(function(e){if(Se)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Se=!1,!1}),!0);var Xe=function(e){if(Z){e=e.touches?e.touches[0]:e;var t=(a=e.clientX,o=e.clientY,xe.some((function(e){var t=e[W].options.emptyInsertThreshold;if(t&&!P(e)){var n=M(e),i=a>=n.left-t&&a<=n.right+t,r=o>=n.top-t&&o<=n.bottom+t;return i&&r?s=e:void 0}})),s);if(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[W]._onDragOver(n)}}var a,o,s},He=function(e){Z&&Z.parentNode[W]._isOutsideThisEl(e.target)};function Ye(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=p({},t),e[W]=this;var n,i,a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ne(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ye.supportPointer&&"PointerEvent"in window&&!b,emptyInsertThreshold:5};for(var o in U.initializePlugins(this,e,a),a)!(o in t)&&(t[o]=a[o]);for(var s in Pe(t),this)"_"===s.charAt(0)&&"function"==typeof this[s]&&(this[s]=this[s].bind(this));this.nativeDraggable=!t.forceFallback&&Me,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?E(e,"pointerdown",this._onTapStart):(E(e,"mousedown",this._onTapStart),E(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(E(e,"dragover",this),E(e,"dragenter",this)),xe.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),p(this,(i=[],{captureAnimationState:function(){i=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(e){if("none"!==A(e,"display")&&e!==Ye.ghost){i.push({target:e,rect:M(e)});var t=c({},i[i.length-1].rect);if(e.thisAnimationDuration){var n=k(e,!0);n&&(t.top-=n.f,t.left-=n.e)}e.fromRect=t}}))},addAnimationState:function(e){i.push(e)},removeAnimationState:function(e){i.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n);return-1}(i,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(n),void("function"==typeof e&&e());var a=!1,o=0;i.forEach((function(e){var n=0,i=e.target,s=i.fromRect,r=M(i),l=i.prevFromRect,c=i.prevToRect,d=e.rect,u=k(i,!0);u&&(r.top-=u.f,r.left-=u.e),i.toRect=r,i.thisAnimationDuration&&H(l,r)&&!H(s,r)&&(d.top-r.top)/(d.left-r.left)==(s.top-r.top)/(s.left-r.left)&&(n=function(e,t,n,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*i.animation}(d,l,c,t.options)),H(r,s)||(i.prevFromRect=s,i.prevToRect=r,n||(n=t.options.animation),t.animate(i,d,r,n)),n&&(a=!0,o=Math.max(o,n),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),n),i.thisAnimationDuration=n)})),clearTimeout(n),a?n=setTimeout((function(){"function"==typeof e&&e()}),o):"function"==typeof e&&e(),i=[]},animate:function(e,t,n,i){if(i){A(e,"transition",""),A(e,"transform","");var a=k(this.el),o=a&&a.a,s=a&&a.d,r=(t.left-n.left)/(o||1),l=(t.top-n.top)/(s||1);e.animatingX=!!r,e.animatingY=!!l,A(e,"transform","translate3d("+r+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),A(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),A(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){A(e,"transition",""),A(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),i)}}}))}function je(e,t,n,i,a,o,s,r){var l,c,d=e[W],u=d.options.onMove;return!window.CustomEvent||m||g?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=i,l.related=a||t,l.relatedRect=o||M(t),l.willInsertAfter=r,l.originalEvent=s,e.dispatchEvent(l),u&&(c=u.call(d,l,s)),c}function Fe(e){e.draggable=!1}function We(){De=!1}function ze(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function Ve(e){return setTimeout(e,0)}function Ue(e){return clearTimeout(e)}Ye.prototype={constructor:Ye,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(we=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Z):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,i=this.options,a=i.preventOnFilter,o=e.type,s=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,r=(s||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||r,c=i.filter;if(function(e){Ae.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&Ae.push(i)}}(n),!Z&&!(/mousedown|pointerdown/.test(o)&&0!==e.button||i.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!b||!r||"SELECT"!==r.tagName.toUpperCase())&&!((r=T(r,i.draggable,n,!1))&&r.animated||ie===r)){if(se=R(r),le=R(r,i.draggable),"function"==typeof c){if(c.call(this,e,r,this))return J({sortable:t,rootEl:l,name:"filter",targetEl:r,toEl:n,fromEl:n}),Q("filter",t,{evt:e}),void(a&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(i){if(i=T(l,i.trim(),n,!1))return J({sortable:t,rootEl:i,name:"filter",targetEl:r,fromEl:n,toEl:n}),Q("filter",t,{evt:e}),!0}))))return void(a&&e.cancelable&&e.preventDefault());i.handle&&!T(l,i.handle,n,!1)||this._prepareDragStart(e,s,r)}}},_prepareDragStart:function(e,t,n){var i,a=this,o=a.el,s=a.options,r=o.ownerDocument;if(n&&!Z&&n.parentNode===o){var l=M(n);if(te=o,K=(Z=n).parentNode,ne=Z.nextSibling,ie=n,de=s.group,Ye.dragged=Z,pe={target:Z,clientX:(t||e).clientX,clientY:(t||e).clientY},ge=pe.clientX-l.left,ve=pe.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Z.style["will-change"]="all",i=function(){Q("delayEnded",a,{evt:e}),Ye.eventCanceled?a._onDrop():(a._disableDelayedDragEvents(),!v&&a.nativeDraggable&&(Z.draggable=!0),a._triggerDragStart(e,t),J({sortable:a,name:"choose",originalEvent:e}),D(Z,s.chosenClass,!0))},s.ignore.split(",").forEach((function(e){q(Z,e.trim(),Fe)})),E(r,"dragover",Xe),E(r,"mousemove",Xe),E(r,"touchmove",Xe),E(r,"mouseup",a._onDrop),E(r,"touchend",a._onDrop),E(r,"touchcancel",a._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Z.draggable=!0),Q("delayStart",this,{evt:e}),!s.delay||s.delayOnTouchOnly&&!t||this.nativeDraggable&&(g||m))i();else{if(Ye.eventCanceled)return void this._onDrop();E(r,"mouseup",a._disableDelayedDrag),E(r,"touchend",a._disableDelayedDrag),E(r,"touchcancel",a._disableDelayedDrag),E(r,"mousemove",a._delayedDragTouchMoveHandler),E(r,"touchmove",a._delayedDragTouchMoveHandler),s.supportPointer&&E(r,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(i,s.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Z&&Fe(Z),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;$(e,"mouseup",this._disableDelayedDrag),$(e,"touchend",this._disableDelayedDrag),$(e,"touchcancel",this._disableDelayedDrag),$(e,"mousemove",this._delayedDragTouchMoveHandler),$(e,"touchmove",this._delayedDragTouchMoveHandler),$(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?E(document,"pointermove",this._onTouchMove):E(document,t?"touchmove":"mousemove",this._onTouchMove):(E(Z,"dragend",this),E(te,"dragstart",this._onDragStart));try{document.selection?Ve((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if($e=!1,te&&Z){Q("dragStarted",this,{evt:t}),this.nativeDraggable&&E(document,"dragover",He);var n=this.options;!e&&D(Z,n.dragClass,!1),D(Z,n.ghostClass,!0),Ye.active=this,e&&this._appendGhost(),J({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(he){this._lastX=he.clientX,this._lastY=he.clientY,Re();for(var e=document.elementFromPoint(he.clientX,he.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(he.clientX,he.clientY))!==t;)t=e;if(Z.parentNode[W]._isOutsideThisEl(e),t)do{if(t[W]&&t[W]._onDragOver({clientX:he.clientX,clientY:he.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);Be()}},_onTouchMove:function(e){if(pe){var t=this.options,n=t.fallbackTolerance,i=t.fallbackOffset,a=e.touches?e.touches[0]:e,o=ee&&k(ee,!0),s=ee&&o&&o.a,r=ee&&o&&o.d,l=qe&&Ee&&B(Ee),c=(a.clientX-pe.clientX+i.x)/(s||1)+(l?l[0]-Le[0]:0)/(s||1),d=(a.clientY-pe.clientY+i.y)/(r||1)+(l?l[1]-Le[1]:0)/(r||1);if(!Ye.active&&!$e){if(n&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(ee){o?(o.e+=c-(fe||0),o.f+=d-(me||0)):o={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");A(ee,"webkitTransform",u),A(ee,"mozTransform",u),A(ee,"msTransform",u),A(ee,"transform",u),fe=c,me=d,he=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ee){var e=this.options.fallbackOnBody?document.body:te,t=M(Z,!0,qe,!0,e),n=this.options;if(qe){for(Ee=e;"static"===A(Ee,"position")&&"none"===A(Ee,"transform")&&Ee!==document;)Ee=Ee.parentNode;Ee!==document.body&&Ee!==document.documentElement?(Ee===document&&(Ee=O()),t.top+=Ee.scrollTop,t.left+=Ee.scrollLeft):Ee=O(),Le=B(Ee)}D(ee=Z.cloneNode(!0),n.ghostClass,!1),D(ee,n.fallbackClass,!0),D(ee,n.dragClass,!0),A(ee,"transition",""),A(ee,"transform",""),A(ee,"box-sizing","border-box"),A(ee,"margin",0),A(ee,"top",t.top),A(ee,"left",t.left),A(ee,"width",t.width),A(ee,"height",t.height),A(ee,"opacity","0.8"),A(ee,"position",qe?"absolute":"fixed"),A(ee,"zIndex","100000"),A(ee,"pointerEvents","none"),Ye.ghost=ee,e.appendChild(ee),A(ee,"transform-origin",ge/parseInt(ee.style.width)*100+"% "+ve/parseInt(ee.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,i=e.dataTransfer,a=n.options;Q("dragStart",this,{evt:e}),Ye.eventCanceled?this._onDrop():(Q("setupClone",this),Ye.eventCanceled||((ae=F(Z)).removeAttribute("id"),ae.draggable=!1,ae.style["will-change"]="",this._hideClone(),D(ae,this.options.chosenClass,!1),Ye.clone=ae),n.cloneId=Ve((function(){Q("clone",n),Ye.eventCanceled||(n.options.removeCloneOnHide||te.insertBefore(ae,Z),n._hideClone(),J({sortable:n,name:"clone"}))})),!t&&D(Z,a.dragClass,!0),t?(Se=!0,n._loopId=setInterval(n._emulateDragOver,50)):($(document,"mouseup",n._onDrop),$(document,"touchend",n._onDrop),$(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",a.setData&&a.setData.call(n,i,Z)),E(document,"drop",n),A(Z,"transform","translateZ(0)")),$e=!0,n._dragStartId=Ve(n._dragStarted.bind(n,t,e)),E(document,"selectstart",n),be=!0,b&&A(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,i,a,o=this.el,s=e.target,r=this.options,l=r.group,d=Ye.active,u=de===l,p=r.sort,h=ue||d,f=this,m=!1;if(!De){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=T(s,r.draggable,o,!0),O("dragOver"),Ye.eventCanceled)return m;if(Z.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||f._ignoreWhileAnimating===s)return X(!1);if(Se=!1,d&&!r.disabled&&(u?p||(i=K!==te):ue===this||(this.lastPutMode=de.checkPull(this,d,Z,e))&&l.checkPut(this,d,Z,e))){if(a="vertical"===this._getDirection(e,s),t=M(Z),O("dragOverValid"),Ye.eventCanceled)return m;if(i)return K=te,B(),this._hideClone(),O("revert"),Ye.eventCanceled||(ne?te.insertBefore(Z,ne):te.appendChild(Z)),X(!0);var g=P(o,r.draggable);if(!g||function(e,t,n){var i=M(P(n.el,n.options.draggable));return t?e.clientX>i.right+10||e.clientX<=i.right&&e.clientY>i.bottom&&e.clientX>=i.left:e.clientX>i.right&&e.clientY>i.top||e.clientX<=i.right&&e.clientY>i.bottom+10}(e,a,this)&&!g.animated){if(g===Z)return X(!1);if(g&&o===e.target&&(s=g),s&&(n=M(s)),!1!==je(te,o,Z,t,s,n,e,!!s))return B(),g&&g.nextSibling?o.insertBefore(Z,g.nextSibling):o.appendChild(Z),K=o,H(),X(!0)}else if(g&&function(e,t,n){var i=M(N(n.el,0,n.options,!0));return t?e.clientX<i.left-10||e.clientY<i.top&&e.clientX<i.right:e.clientY<i.top-10||e.clientY<i.bottom&&e.clientX<i.left}(e,a,this)){var v=N(o,0,r,!0);if(v===Z)return X(!1);if(n=M(s=v),!1!==je(te,o,Z,t,s,n,e,!1))return B(),o.insertBefore(Z,v),K=o,H(),X(!0)}else if(s.parentNode===o){n=M(s);var b,w,y,_=Z.parentNode!==o,E=!function(e,t,n){var i=n?e.left:e.top,a=n?e.right:e.bottom,o=n?e.width:e.height,s=n?t.left:t.top,r=n?t.right:t.bottom,l=n?t.width:t.height;return i===s||a===r||i+o/2===s+l/2}(Z.animated&&Z.toRect||t,s.animated&&s.toRect||n,a),$=a?"top":"left",S=I(s,"top","top")||I(Z,"top","top"),x=S?S.scrollTop:void 0;if(we!==s&&(w=n[$],Te=!1,Ce=!E&&r.invertSwap||_),b=function(e,t,n,i,a,o,s,r){var l=i?e.clientY:e.clientX,c=i?n.height:n.width,d=i?n.top:n.left,u=i?n.bottom:n.right,p=!1;if(!s)if(r&&_e<c*a){if(!Te&&(1===ye?l>d+c*o/2:l<u-c*o/2)&&(Te=!0),Te)p=!0;else if(1===ye?l<d+_e:l>u-_e)return-ye}else if(l>d+c*(1-a)/2&&l<u-c*(1-a)/2)return function(e){return R(Z)<R(e)?1:-1}(t);return(p=p||s)&&(l<d+c*o/2||l>u-c*o/2)?l>d+c/2?1:-1:0}(e,s,n,a,E?1:r.swapThreshold,null==r.invertedSwapThreshold?r.swapThreshold:r.invertedSwapThreshold,Ce,we===s),0!==b){var C=R(Z);do{C-=b,y=K.children[C]}while(y&&("none"===A(y,"display")||y===ee))}if(0===b||y===s)return X(!1);we=s,ye=b;var L=s.nextElementSibling,k=!1,q=je(te,o,Z,t,s,n,e,k=1===b);if(!1!==q)return 1!==q&&-1!==q||(k=1===q),De=!0,setTimeout(We,30),B(),k&&!L?o.appendChild(Z):s.parentNode.insertBefore(Z,k?L:s),S&&j(S,0,x-S.scrollTop),K=Z.parentNode,void 0===w||Ce||(_e=Math.abs(w-M(s)[$])),H(),X(!0)}if(o.contains(Z))return X(!1)}return!1}function O(r,l){Q(r,f,c({evt:e,isOwner:u,axis:a?"vertical":"horizontal",revert:i,dragRect:t,targetRect:n,canSort:p,fromSortable:h,target:s,completed:X,onMove:function(n,i){return je(te,o,Z,t,n,M(n),e,i)},changed:H},l))}function B(){O("dragOverAnimationCapture"),f.captureAnimationState(),f!==h&&h.captureAnimationState()}function X(t){return O("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(f),f!==h&&(D(Z,ue?ue.options.ghostClass:d.options.ghostClass,!1),D(Z,r.ghostClass,!0)),ue!==f&&f!==Ye.active?ue=f:f===Ye.active&&ue&&(ue=null),h===f&&(f._ignoreWhileAnimating=s),f.animateAll((function(){O("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(s===Z&&!Z.animated||s===o&&!s.animated)&&(we=null),r.dragoverBubble||e.rootEl||s===document||(Z.parentNode[W]._isOutsideThisEl(e.target),!t&&Xe(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function H(){re=R(Z),ce=R(Z,r.draggable),J({sortable:f,name:"change",toEl:o,newIndex:re,newDraggableIndex:ce,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){$(document,"mousemove",this._onTouchMove),$(document,"touchmove",this._onTouchMove),$(document,"pointermove",this._onTouchMove),$(document,"dragover",Xe),$(document,"mousemove",Xe),$(document,"touchmove",Xe)},_offUpEvents:function(){var e=this.el.ownerDocument;$(e,"mouseup",this._onDrop),$(e,"touchend",this._onDrop),$(e,"pointerup",this._onDrop),$(e,"touchcancel",this._onDrop),$(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;re=R(Z),ce=R(Z,n.draggable),Q("drop",this,{evt:e}),K=Z&&Z.parentNode,re=R(Z),ce=R(Z,n.draggable),Ye.eventCanceled||($e=!1,Ce=!1,Te=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ue(this.cloneId),Ue(this._dragStartId),this.nativeDraggable&&($(document,"drop",this),$(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),b&&A(document.body,"user-select",""),A(Z,"transform",""),e&&(be&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),ee&&ee.parentNode&&ee.parentNode.removeChild(ee),(te===K||ue&&"clone"!==ue.lastPutMode)&&ae&&ae.parentNode&&ae.parentNode.removeChild(ae),Z&&(this.nativeDraggable&&$(Z,"dragend",this),Fe(Z),Z.style["will-change"]="",be&&!$e&&D(Z,ue?ue.options.ghostClass:this.options.ghostClass,!1),D(Z,this.options.chosenClass,!1),J({sortable:this,name:"unchoose",toEl:K,newIndex:null,newDraggableIndex:null,originalEvent:e}),te!==K?(re>=0&&(J({rootEl:K,name:"add",toEl:K,fromEl:te,originalEvent:e}),J({sortable:this,name:"remove",toEl:K,originalEvent:e}),J({rootEl:K,name:"sort",toEl:K,fromEl:te,originalEvent:e}),J({sortable:this,name:"sort",toEl:K,originalEvent:e})),ue&&ue.save()):re!==se&&re>=0&&(J({sortable:this,name:"update",toEl:K,originalEvent:e}),J({sortable:this,name:"sort",toEl:K,originalEvent:e})),Ye.active&&(null!=re&&-1!==re||(re=se,ce=le),J({sortable:this,name:"end",toEl:K,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){Q("nulling",this),te=Z=K=ee=ne=ae=ie=oe=pe=he=be=re=ce=se=le=we=ye=ue=de=Ye.dragged=Ye.ghost=Ye.clone=Ye.active=null,Ae.forEach((function(e){e.checked=!0})),Ae.length=fe=me=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Z&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,i=0,a=n.length,o=this.options;i<a;i++)T(e=n[i],o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||ze(e));return t},sort:function(e,t){var n={},i=this.el;this.toArray().forEach((function(e,t){var a=i.children[t];T(a,this.options.draggable,i,!1)&&(n[e]=a)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return T(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var i=U.modifyOption(this,e,t);n[e]=void 0!==i?i:t,"group"===e&&Pe(n)},destroy:function(){Q("destroy",this);var e=this.el;e[W]=null,$(e,"mousedown",this._onTapStart),$(e,"touchstart",this._onTapStart),$(e,"pointerdown",this._onTapStart),this.nativeDraggable&&($(e,"dragover",this),$(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),xe.splice(xe.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!oe){if(Q("hideClone",this),Ye.eventCanceled)return;A(ae,"display","none"),this.options.removeCloneOnHide&&ae.parentNode&&ae.parentNode.removeChild(ae),oe=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(oe){if(Q("showClone",this),Ye.eventCanceled)return;Z.parentNode!=te||this.options.group.revertClone?ne?te.insertBefore(ae,ne):te.appendChild(ae):te.insertBefore(ae,Z),this.options.group.revertClone&&this.animate(Z,ae),A(ae,"display",""),oe=!1}}else this._hideClone()}},ke&&E(document,"touchmove",(function(e){(Ye.active||$e)&&e.cancelable&&e.preventDefault()})),Ye.utils={on:E,off:$,css:A,find:q,is:function(e,t){return!!T(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:Y,closest:T,toggleClass:D,clone:F,index:R,nextTick:Ve,cancelNextTick:Ue,detectDirection:Ne,getChild:N},Ye.get=function(e){return e[W]},Ye.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ye.utils=c(c({},Ye.utils),e.utils)),U.mount(e)}))},Ye.create=function(e,t){return new Ye(e,t)},Ye.version="1.15.0";var Ge,Qe,Je,Ze,Ke,et,tt=[],nt=!1;function it(){tt.forEach((function(e){clearInterval(e.pid)})),tt=[]}function at(){clearInterval(et)}var ot=Y((function(e,t,n,i){if(t.scroll){var a,o=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,r=t.scrollSensitivity,l=t.scrollSpeed,c=O(),d=!1;Qe!==n&&(Qe=n,it(),Ge=t.scroll,a=t.scrollFn,!0===Ge&&(Ge=X(n,!0)));var u=0,p=Ge;do{var h=p,f=M(h),m=f.top,g=f.bottom,v=f.left,b=f.right,w=f.width,y=f.height,_=void 0,E=void 0,$=h.scrollWidth,S=h.scrollHeight,x=A(h),T=h.scrollLeft,C=h.scrollTop;h===c?(_=w<$&&("auto"===x.overflowX||"scroll"===x.overflowX||"visible"===x.overflowX),E=y<S&&("auto"===x.overflowY||"scroll"===x.overflowY||"visible"===x.overflowY)):(_=w<$&&("auto"===x.overflowX||"scroll"===x.overflowX),E=y<S&&("auto"===x.overflowY||"scroll"===x.overflowY));var L=_&&(Math.abs(b-o)<=r&&T+w<$)-(Math.abs(v-o)<=r&&!!T),D=E&&(Math.abs(g-s)<=r&&C+y<S)-(Math.abs(m-s)<=r&&!!C);if(!tt[u])for(var k=0;k<=u;k++)tt[k]||(tt[k]={});tt[u].vx==L&&tt[u].vy==D&&tt[u].el===h||(tt[u].el=h,tt[u].vx=L,tt[u].vy=D,clearInterval(tt[u].pid),0==L&&0==D||(d=!0,tt[u].pid=setInterval(function(){i&&0===this.layer&&Ye.active._onTouchMove(Ke);var t=tt[this.layer].vy?tt[this.layer].vy*l:0,n=tt[this.layer].vx?tt[this.layer].vx*l:0;"function"==typeof a&&"continue"!==a.call(Ye.dragged.parentNode[W],n,t,e,Ke,tt[this.layer].el)||j(tt[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&p!==c&&(p=X(p,!1)));nt=d}}),30),st=function(e){var t=e.originalEvent,n=e.putSortable,i=e.dragEl,a=e.activeSortable,o=e.dispatchSortableEvent,s=e.hideGhostForTarget,r=e.unhideGhostForTarget;if(t){var l=n||a;s();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);r(),l&&!l.el.contains(d)&&(o("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function rt(){}function lt(){}rt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=N(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:st},p(rt,{pluginName:"revertOnSpill"}),lt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:st},p(lt,{pluginName:"removeOnSpill"}),Ye.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?E(document,"dragover",this._handleAutoScroll):this.options.supportPointer?E(document,"pointermove",this._handleFallbackAutoScroll):t.touches?E(document,"touchmove",this._handleFallbackAutoScroll):E(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?$(document,"dragover",this._handleAutoScroll):($(document,"pointermove",this._handleFallbackAutoScroll),$(document,"touchmove",this._handleFallbackAutoScroll),$(document,"mousemove",this._handleFallbackAutoScroll)),at(),it(),clearTimeout(C),C=void 0},nulling:function(){Ke=Qe=Ge=nt=et=Je=Ze=null,tt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,i=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,o=document.elementFromPoint(i,a);if(Ke=e,t||this.options.forceAutoScrollFallback||g||m||b){ot(e,this.options,o,t);var s=X(o,!0);!nt||et&&i===Je&&a===Ze||(et&&at(),et=setInterval((function(){var o=X(document.elementFromPoint(i,a),!0);o!==s&&(s=o,it()),ot(e,n.options,o,t)}),10),Je=i,Ze=a)}else{if(!this.options.bubbleScroll||X(o,!0)===O())return void it();ot(e,this.options,X(o,!1),!1)}}},p(e,{pluginName:"scroll",initializeByDefault:!0})}),Ye.mount(lt,rt);var ct=Ye;function dt(t,n,i){let a=(0,e.$)(t)[0];a&&ct.create(a,{animation:150,onEnd:function(t){let a=t.oldIndex,o=t.newIndex;!async function(t){let a=(0,e.$)(n),o=[].map.call(a,(function(e,n){if(n-1<t)return e})),s=o.map((e=>e.dataset.id));await(0,e.v_)(`/adminsc/${i}/sort`,{toChange:s}),o.map(((t,n)=>{(0,e.$)(t).find(".sort").innerText=n+1}))}(a>o?a:o)}})}class ut{constructor(){this.model="opentest"}async create(){let t=ut.serverModel();t.id=0,t.isTest=1;let n=`/${this.model}/updateOrCreate`,i=await(0,e.v_)(n,t);i&&(window.location.href=`/adminsc/${model}/edit/${i.id}`)}id(){return id??(0,e.$)(".test-name")[0].dataset.testid}children(){return(0,e.$)(".children").length||!1}async path_create(){let t=ut.serverModel();t.id=0,t.isTest=0;let n=`/adminsc/${model}/create`,i=await(0,e.v_)(n,t);i&&(window.location.href=`/adminsc/${model}/edit/${i.id-1}`)}name(){return(0,e.$)(".test-name")[0].innerText}async update(){let t=ut.serverModel(),n=`/adminsc/${t}/update/${t.id}`;await(0,e.v_)(n,t)&&(window.location.href=`/adminsc/${t}/edit/${t.id}`)}async del(){if(ut.children())return e.gk.show("Сначала удалите все тесты из папки"),!1;let t=ut.id();(await(0,e.v_)("/adminsc/${model}/delete",{id:t})).notAdmin?(e.gk.show("Видимость теста скрыта. Чтобы удалить полностью - обратитесь к ГД"),setTimeout((()=>{window.location=`/adminsc/${model}/edit/400`}),4e3)):window.location=`/adminsc/${model}/edit/400`}}let pt={async create(t){let n=t.closest(".question-edit"),i=n.dataset.id,a=n.querySelectorAll(".answer").length+1,o=(await(0,e.v_)("/adminsc/openanswer/updateOrCreate",{openquestion_id:i,sort:a})).arr.html;o?t.insertAdjacentHTML("beforebegin",o):e.gk.show("Сохранено")},async del(t){let n=t.closest(".delete");if(!n)return!1;if(confirm("Удалить этот ответ?")){let t=n.closest(".answer"),i=+t.dataset.answerId;await(0,e.v_)("/adminsc/openanswer/delete",{id:i})&&t.remove()}}};class ht{constructor(e){return!!e&&!e.multiple&&(this.title=e.title??"",this.field=e.dataset.field,this.model=e.dataset.model,this.modelId=e.dataset.id,this.options=(t=e.querySelectorAll("option"),[...t].map((e=>({value:e.value,label:e.label,selected:e.selected,element:e})))),this.sel=document.createElement("div"),e.className&&this.sel.classList.add(e.className),this.label=document.createElement("span"),this.arrow=document.createElement("div"),this.space=document.createElement("div"),this.ul=document.createElement("ul"),function(e){let t;e.title&&(e.titleElement=document.createElement("div"),e.titleElement.classList.add("title"),e.titleElement.innerText=e.title,e.sel.append(e.titleElement)),e.sel.setAttribute("custom-select",""),e.sel.dataset.model=e.model,e.sel.dataset.modelId=e.modelId,e.field&&(e.sel.dataset.field=e.field),e.sel.dataset.value=e.selectedOption.value,e.sel.tabIndex=0,e.sel.append(e.label),e.space.classList.add("space"),e.space.innerText=e.selectedOption.label,e.label.append(e.space),e.arrow.classList.add("arrow"),e.label.append(e.arrow),e.ul.classList.add("options"),e.options.forEach((t=>{!function(t){const n=document.createElement("li");n.innerText=t.label,n.dataset.value=t.value,n.classList.toggle("selected",t.selected),n.addEventListener("click",(()=>{e.selectValue(t.value),e.ul.classList.remove("show")})),e.ul.append(n)}(t)})),e.sel.append(e.ul),e.label.addEventListener("click",(()=>{e.ul.classList.toggle("show")})),e.sel.addEventListener("blur",(()=>{e.ul.classList.remove("show")}));let n="";e.sel.addEventListener("keydown",(i=>{switch(i.code){case"Space":e.ul.classList.toggle("show");break;case"ArrowUp":{const t=e.options[e.selectedOptionIndex-1];t&&e.selectValue(t.value);break}case"ArrowDown":{const t=e.options[e.selectedOptionIndex+1];t&&e.selectValue(t.value);break}case"Enter":case"Escape":e.ul.classList.remove("show");break;default:{clearTimeout(t),n+=i.key,t=setTimeout((()=>{n=""}),500);const a=e.options.find((e=>e.label.toLowerCase().startsWith(n)));a&&e.selectValue(a.value)}}}))}(this),e.after(this.sel),void e.remove());var t}get selectedOption(){return this.options.find((e=>e.selected))}get selectedOptionIndex(){return this.options.indexOf(this.selectedOption)}selectValue(e){const t=this.options.find((t=>t.value===e)),n=this.selectedOption;n.selected=!1,t.selected=!0,this.space.innerText=t.label,this.label.closest("[custom-select]").dataset.value=t.value,this.ul.querySelector(`[data-value="${n.value}"]`).classList.remove("selected");const i=this.ul.querySelector(`[data-value="${t.value}"]`);i.classList.add("selected"),i.scrollIntoView({block:"nearest"})}}class ft{constructor(t){this.pClass=t.pClass??"",this.pActiveClass=t.pActiveClass??"",this.pageClass=t.pageClass??"",this.pageActiveClass=t.pageActiveClass??"",this.prevBttnEl=t.prevBttnEl??null,this.nextBttnEl=t.nextBttnEl??null,this.paginations=(0,e.$)(this.pClass),this.activePClass=this.pClass+"."+this.pActiveClass,this.activePageClass="."+this.pageClass+"."+this.pageActiveClass,this.paginations.length&&(this.navInit(),(0,e.$)(this.pClass).on("click",this.handleClick.bind(this)),this.prevBttnEl&&((0,e.$)(this.prevBttnEl).on("click",this.handleNextPrev.bind(this)),(0,e.$)(this.nextBttnEl).on("click",this.handleNextPrev.bind(this))))}navInit(){[].map.call(this.paginations,(e=>{e.classList.remove(this.pActiveClass)})),this.paginations[0].classList.add(this.pActiveClass)}handleNextPrev(t){let{target:n}=t,i=(0,e.$)(this.activePageClass)[0],a=(0,e.$)(this.activePClass)[0],o=this.paginations.indexOf(a);n===this.prevBttnEl?function(){if(o<1)return!1;let e=this.paginations[o-1];this.togglePage(e,i),this.toggleNav(e,a)}.call(this):n===this.nextBttnEl&&function(){if(o>this.paginations.length-2)return!1;let e=this.paginations[o+1];this.togglePage(e,i),this.toggleNav(e,a)}.call(this)}toggleNav(e,t){t.classList.toggle(this.pActiveClass),e.classList.toggle(this.pActiveClass)}togglePage(t,n){let i=t.dataset.pagination;(0,e.$)(`.question[data-id='${i}']`)[0].classList.toggle(this.pageActiveClass),n.classList.toggle(this.pageActiveClass)}handleClick(t){let{target:n}=t;if(!n.dataset.pagination)return;if(n.classList.contains(this.pActiveClass))return;let i=(0,e.$)(this.activePClass)[0];i.classList.remove(this.pActiveClass),n.classList.add(this.pActiveClass);let a=i.dataset.pagination;(0,e.$)(`.${this.pageClass}[data-id="${a}"]`).removeClass(this.pageActiveClass);let o=n.dataset.pagination;(0,e.$)(`.${this.pageClass}[data-id="${o}"]`).addClass(this.pageActiveClass)}}function mt(){return new ft({pClass:"[data-pagination]",pActiveClass:"active",pageClass:"question",pageActiveClass:"show",prevBttnEl:(0,e.$)("#prev")[0],nextBttnEl:(0,e.$)("#next")[0]})}let gt=(0,e.$)(".opentest-edit-wrapper")[0];if(gt){mt(),dt(".opentest-edit-wrapper .questions",".opentest-edit-wrapper .question-edit","openquestion"),(0,e.$)(gt).on("change",(async function(e){let{target:t}=e,n=t.closest(".answer"),i=t.closest(".question-edit__parent-select");n?vt(n):i&&r.changeParent(t)})),(0,e.$)(gt).on("click",(e=>{let{target:t}=e;const n=new ut;t.classList.contains("test-path__create")?n.path_create():t.classList.contains("test__create")?n.create():t.closest(".question__show-answers")?r.showAnswers(t):t.closest(".question__delete")?r.del(t):t.classList.contains("question__create-button")?r.create(t):t.closest(".delete")?pt.del(t):t.classList.contains("answer__create-button")?pt.create(t):t.classList.contains("led")&&t.classList.toggle("animated")}));let t=async function(t){let{target:n}=t;if(n.classList.contains("text")){let t=n.closest(".answer"),i=n.closest(".question-edit");if(t)vt(t);else if(i){let t=i.dataset.id,a=n.innerText;await(0,e.v_)("/adminsc/openquestion/updateOrCreate",{id:t,question:a})}}},n=(0,e.Ds)(t);(0,e.$)(gt).on("keyup",n)}async function vt(t){let n=t.dataset.answerId,i=+t.querySelector("input").checked,a=t.closest(".question-edit").dataset.id,o=t.querySelector(".text").innerText;await(0,e.v_)("/adminsc/openanswer/updateOrCreate",{id:n,answer:o,openquestion_id:a,is_correct:i})}let bt=new class{constructor(){}async saveAnswer(t){let n=t.closest(".question-edit").dataset.id,i=t.closest(".answer"),a=this.getAnswerModel(i,n);await(0,e.v_)("/adminsc/answer/updateOrCreate",a)}async del(t){let n=t.closest(".answer"),i=+t.dataset.id;confirm("Удалить?")&&await(0,e.v_)("/adminsc/answer/delete",{id:i})&&n.remove()}async answerCreate(t){let n=(0,e.$)(".answer__create .answer")[0],i=t.closest(".question-edit"),a=+i.dataset.id,o=n.cloneNode(!0),s=this.getAnswerModel(o,a),r=await(0,e.v_)("/adminsc/answer/updateOrCreate",s);if(r&&(r.arr.popup&&e.gk.show(r.arr.popup),r.arr.id)){let e=i.querySelectorAll(".answer").length+1;o.querySelector(".sort").innerText=e,o.querySelector(".delete").dataset.id=o.dataset.id=r.arr.id,t.before(o)}}getAnswerModel(t,n){return{id:+t.dataset.id,answer:(0,e.mN)((0,e.$)(t).find(".text").innerText),question_id:n,correct_answer:+(0,e.$)(t).find("input").checked,pica:""}}},wt=new class{constructor(e){this.sort=document.querySelectorAll(".questions>.question-edit").length+1??0}async questionCreate(t){let n=(0,e.$)(".question__create .question-edit")[0].cloneNode(!0),i=this.getQuestionModel(n),a=await(0,e.v_)("/adminsc/question/updateOrCreate",i);a&&(n.querySelector(".sort").innerText=(0,e.$)(".question-edit").length,n.querySelector(".question__delete").dataset.id=n.dataset.id=a.arr.id,t.before(n))}getQuestionModel(t){return{id:+t.dataset.id,qustion:(0,e.mN)(t.querySelector(".text").innerText),test_id:+window.location.href.split("/").pop(),sort:+(0,e.$)(".question-edit").length}}async changeParent(t){let n=t.closest(".question-edit"),i=n.dataset.id,a=t.options[t.selectedIndex].dataset.questionParentId;await(0,e.v_)("/adminsc/question/changeParent",{id:i,test_id:a})&&n.remove()}showAnswers(t){let n=t.closest(".question-edit"),i=(0,e.$)(n).find(".question__answers");i.classList.toggle("height"),i.classList.toggle("scale"),t.classList.toggle("rotate")}async del(t){let n=t.dataset.model,i=null;"answer"===n?i=t.closest(".answer"):"question"===n&&(i=t.closest(".question-edit"));let a=+t.dataset.id;confirm("Удалить?")&&await(0,e.v_)(`/adminsc/${n}/delete`,{id:a})&&i.remove()}async saveQuestion(t){let n=t.closest(".question-edit"),i=wt.getQuestionModel(n);await(0,e.v_)("/adminsc/question/UpdateOrCreate",i)}};const yt={viewModel:()=>({id:+window.location.href.split("/").pop(),name:(0,e.$)("#test_name").text(),enable:(0,e.$)("#enable")[0],parent:(0,e.$)("select").selectedIndexValue()}),children:()=>(0,e.$)(".children").length||!1,path_create:async()=>{let t=yt.serverModel();t.id=0,t.isTest=0;let n=await(0,e.v_)("/adminsc/test/updateOrCreate",t);n&&(window.location.href=`/adminsc/test/edit/${n.arr.id}`)},id:t=>t??(0,e.$)(".test-name")[0].dataset.testid,name:()=>(0,e.$)(".test-name")[0].innerText,create:async()=>{let t=yt.serverModel();t.id=0,t.isTest=1;let n=await(0,e.v_)("/test/updateOrCreate",t);n&&(window.location.href=`/adminsc/test/edit/${n.arr.id}`)},serverModel:()=>{let t=!!+window.location.href.split("/").pop();t=t||0;let n={id:t,name:(0,e.$)("#name.field")[0].value,isTest:+(0,e.$)("[isTest]")[0].getAttribute("isTest")},i=(0,e.$)("[custom-select]");return[].forEach.call(i,(function(e){n[e.dataset.field]=e.dataset.id})),n},update:async()=>{let t=yt.serverModel(),n=`/adminsc/test/update/${t.id}`;await(0,e.v_)(n,t)&&(window.location.href=`/adminsc/test/edit/${t.id}`)},delete:async function(){if(yt.children())return e.gk.show("Сначала удалите все тесты из папки"),!1;let t=yt.id();(await(0,e.v_)("/adminsc/test/delete",{id:t})).notAdmin?(e.gk.show("Видимость теста скрыта. Чтобы удалить полностью - обратитесь к ГД"),setTimeout((()=>{window.location="/adminsc/test/edit/400"}),4e3)):window.location="/adminsc/test/edit/400"}};function _t(e){let{target:t}=e;t.classList.contains("test-path__update")||t.classList.contains("test__update")||t.classList.contains("test__save")?yt.update():t.classList.contains("test__delete")?yt.delete():t.classList.contains("test-path__create")?yt.path_create():t.classList.contains("test__create")?yt.create():t.closest(".question__show-answers")?wt.showAnswers(t):t.classList.contains("question__create-button")?wt.questionCreate(t):t.closest(".question__delete")?wt.del(t):t.closest(".delete")?bt.del(t):t.classList.contains("answer__create-button")?bt.answerCreate(t):t.classList.contains("correct")&&bt.saveAnswer(t)}let Et=(0,e.Ds)((async function(e){let{target:t}=e;t.classList.contains("text")&&(t.closest(".answer")?bt.saveAnswer(t):wt.saveQuestion(t))}));async function $t(e){let{target:t}=e;t.closest(".question-edit__parent-select")&&wt.changeParent(t)}mt();let St=(0,e.$)(".test-do .content")[0];function xt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=(0,e.$)(t);[].forEach.call(i,(function(e){e.ondragenter=function(e){return e.preventDefault(),this.classList.toggle("hover"),!1},e.ondragleave=function(e){return e.preventDefault(),this.classList.toggle("hover"),!1},e.ondragover=function(e){return e.preventDefault(),!1},e.ondrop=function(e){e.preventDefault(),n(e.dataTransfer.files)}}))}St&&((0,e.$)(".question").removeClass("show"),(0,e.$)(".question:first-child").addClass("show"),function(){let t=(0,e.$)(".test-do__finish-btn")[0];t&&window.location.pathname.match("^/test/result/.?")&&t.classList.add("inactive")}(),St.addEventListener("click",(function(t){let{target:n}=t,i=(0,e.$)(".question.show")[0]??"";if(!i)return;let a=+(null==i?void 0:i.dataset.id)??"",o=(0,e.$)("[data-pagination]")??"",s=o.findIndex((e=>e.classList.contains("active")))??"";function r(t,n){(0,e.$)(`[data-pagination="${t}"]`)[0].classList.toggle("active"),(0,e.$)(`[data-pagination="${n}"]`)[0].classList.toggle("active")}function l(t){i.classList.toggle("show"),(0,e.$)(`.question[data-id="${t}"]`)[0].classList.toggle("show")}"checkbox"===n.type?n.labels[0].classList.toggle("pushed"):"prev"===n.id?function(){if(s<1)return!1;let e=+o[s-1].dataset.pagination;r(a,e),l(e)}():"next"===n.id?function(){if(s===o.length-1)return!1;let e=+o[s+1].dataset.pagination;r(a,e),l(e)}():n.classList.contains("test-do__finish-btn")&&async function(t){if("ПРОЙТИ ТЕСТ ЗАНОВО"===t.innerText)return void location.reload();t.innerText="ПРОЙТИ ТЕСТ ЗАНОВО",t.classList.add("inactive"),function(t){let n=(0,e.$)(".question");[].map.call(n,(n=>{let i=function(t,n){let i=t.querySelectorAll(".a"),a=[];return[].map.call(i,(t=>{let i=(0,e.$)(t).find("input"),o=function(e,t,n,i){let a=-1!==t.indexOf(+e),o=n.checked,s=!1;return o&&a?i.classList.add("done"):o&&!a?s=!0:!o&&a&&(i.classList.add("done"),s=!0),s}(t.dataset.id,n,i,t);o&&a.push(!0)})),a}(n,t);!function(t,n){let i=t.dataset.id,a=(0,e.$)(`.pagination [data-pagination='${+i}']`)[0];n.length?(0,e.$)(a).addClass("redShadow"):(0,e.$)(a).addClass("greenShadow")}(n,i)}))}((await(0,e.v_)("/adminsc/test/getCorrectAnswers",{})).arr);let n=(i=(0,e.$)(".redShadow").length,{questionCnt:(0,e.$)(".question").length,errorCnt:i,html:(0,e.$k)(".test-do .content"),testid:(0,e.$)("[data-test-id]")[0].dataset.testId,testname:(0,e.$)(".test-name")[0].innerText,user:(0,e.$)(".user-menu .fio")[0].innerText});var i;await(0,e.v_)("/adminsc/testresult/create",n)&&(t.href=location.href,t.innerText="ПРОЙТИ ТЕСТ ЗАНОВО")}(n)}))),mt();let Tt=(0,e.$)(".opentest-do")[0];Tt&&(function(){let t=(0,e.$)(".question")[0];t&&t.classList.add("show")}(),(0,e.$)(Tt).on("click",(async function(t){let{target:n}=t,i=n.dataset.id;(0,e.$)(".question.show")[0],"finish"===n.id&&async function(t){if("ПРОЙТИ ТЕСТ ЗАНОВО"===t.innerText)return void location.reload();let n=function(t){let n=0;return[].forEach.call(t,(t=>{let i=t.id,a=(0,e.$)(`.question[data-id='${i}']`)[0],o=(0,e.$)(a).find(".textarea");if(!t.Openanswer)return;let s="";t.Openanswer.forEach((e=>{s+=`(${e.answer})?`})),n+=function(t,n,i){let a=n.innerHTML,o=new RegExp(t,"g"),s=a.match(o),r=0;return s.forEach((t=>{if(!t)return;r=1;let a=new RegExp(t,"g"),o="<span style='color:limegreen;'>"+t+"</span>";n.innerHTML=n.innerHTML.replace(a,o),function(t){let n=(0,e.$)(`[data-pagination="${t}"]`);n&&n.css("backgroundColor","green")}(i)})),r}(`${s}`,o,i)})),n}((await(0,e.v_)("/adminsc/opentestresult/getanswers",{id:i})).arr),a=(o=n,(0,e.$)(".buttons")[0].remove(),{id:i,questionCnt:(0,e.$)("[data-pagination]").length,html:(0,e.$k)(".test"),testname:(0,e.$)(".test-name")[0].innerText,username:(0,e.$)(".user-menu .fio")[0].innerText,rightAnswers:o});var o;await(0,e.v_)("/adminsc/opentestresult/finish",a)&&(t.innerText="ПРОЙТИ ТЕСТ ЗАНОВО",t.classList.add("inactive"))}(n)})),(0,e.$)(Tt).on("keyup",(function(t){let{target:n}=t;if(n.classList.contains("textarea")){let t=(0,e.$)("[data-pagination].active")[0];n.innerText?t.classList.add("filled"):t.classList.remove("filled")}}))),(0,e.$)(document).ready((function(){var t;t=window.location.pathname,/\/adminsc\/settings/.test(t)||/\/adminsc\/right\/list/.test(t)||/\/adminsc\/post\/list/.test(t)||/\/adminsc\/todo\/list/.test(t)?((0,e.$)(".rights-table").on("click",(function(t){let{target:n}=t;function i(t){let n=t.dataset.id??"new",i=(0,e.$)(`[data-id='${n}']`),a={toServ:{},empty:{}};return i.map((e=>{e.classList.contains("id")?(a.id=e,a.toServ.id=e.dataset.id):e.classList.contains("name")?(a.name=e,a.toServ.name=e.innerText.trim()):e.classList.contains("description")?(a.description=e,a.toServ.description=e.innerText.trim()):e.classList.contains("save.svg")?a.save=e:e.classList.contains("del")&&(a.del=e)})),a.empty.del=a.id.previousElementSibling.cloneNode(!0),a.empty.save=a.id.previousElementSibling.previousElementSibling.cloneNode(!0),a.empty.description=a.id.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),a.empty.name=a.id.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),a.empty.id=a.id.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),a}n.closest(".del")&&function(t){let n=i(t);"new"!==n.toServ.id&&confirm("Удалить право?")&&(function(e){e.id.remove(),e.name.remove(),e.description.remove(),e.save.remove(),e.del.remove()}(n),async function(t){await(0,e.v_)("/right/delete",{id:t.toServ.id})}(n))}(n.closest(".del")),n.closest(".save")&&function(t){let n=i(t);if("new"!==n.toServ.id)!async function(t){await(0,e.v_)("/right/update",t)}(n.toServ);else{if(!n.toServ.name||!n.toServ.description)return!1;!async function(t){let n=await(0,e.v_)("/right/create",t.toServ);n.arr.id&&(function(e,t){e.empty.id.dataset.id=t,e.empty.id.innerText=t,e.empty.name.dataset.id=t,e.empty.name.innerText=e.name.innerText.trim(),e.empty.description.dataset.id=t,e.empty.description.innerText=e.description.innerText.trim(),e.empty.save.dataset.id=t,e.empty.del.dataset.id=t}(t,n.id-1),function(t){let n=(0,e.$)(".id[data-id='new']")[0];n.before(t.empty.id),n.before(t.empty.name),n.before(t.empty.description),n.before(t.empty.save),n.before(t.empty.del)}(t),function(e){e.name.innerText="",e.description.innerText=""}(t),e.gk.show("Сохранено"))}(n)}}(n.closest(".save"))})),(0,e.$)("[settings]").addClass("current")):/\/auth\/profile/.test(t)?function(){let t=(0,e.$)('[data-model="user"]')[0];if(t){(0,e.$)(t).on("click",(async function(t){let{target:n}=t;if(n.closest("#save")){let t=o((0,e.$)(".user-item")[0]);await(0,e.v_)("/adminsc/user/update",t)}else if(n.classList.contains("right")){let t=(0,e.$)("input.right:checked"),i="";[].map.call(t,(function(e){let t=e.previousElementSibling.innerText;i+=t+","})),n.closest("[data-tab]").dataset.value=i}})),n();let i=(0,e.$)("[data-field='rights']")[0];(0,e.$)(i).on("click",n)}function n(){let t=i().replace(/,$/,"");(0,e.$)("[data-field='rights']")[0].dataset.value=t}function i(){let t=(0,e.$)(".right:checked"),n="";return[].map.call(t,(e=>{let t=e.previousElementSibling.innerText+",";n+=t}),n),n}function a(){const t=(0,e.$)("#conf option");for(let e of t)if(e.selected)return e.value;return"0"}function o(t){return{id:(0,e.$)(t).find("#id").innerText,name:(0,e.$)(t).find("#name").innerText,surName:(0,e.$)(t).find("#s-name").innerText,middleName:(0,e.$)(t).find("#m-name").innerText,birthDate:(0,e.$)(t).find("#bday").innerText,phone:(0,e.$)(t).find("#phone").innerText,email:(0,e.$)(t).find("#email").innerText,hired:(0,e.$)(t).find("#hired").innerText,fired:(0,e.$)(t).find("#fired").innerText,confirm:a(),sex:void 0,rights:i()}}}():/\/adminsc\/crm/.test(t)?(0,e.$)("[crm]").addClass("current"):/\/adminsc\/planning/.test(t)?(0,e.$)("[plan]").addClass("current"):/\/test/.test(t)||/\/opentest/.test(t)||/\/adminsc\/opentest/.test(t)||/\/adminsc\/test/.test(t)?(0,e.$)("[test]").addClass("current"):(0,e.$)("[href='/adminsc']").addClass("current"),function(){let t=(0,e.$)("[custom-radio]");[].map.call(t,(function(t){(0,e.$)(t).on("click",(function(e){let{target:n}=e,i=n.closest("label");t.dataset.value=i.dataset.value}))}))}(),function(){let t=(0,e.$)("[multi-select] ");t&&[].forEach.call(t,(function(t){t.addEventListener("click",(function(t){let{target:n}=t,i=n.closest("[multi-select]");if(n.closest(".arrow")||["chip-wrap"].includes(n.className))i.querySelector("ul").classList.toggle("show");else if(["view.components.Builders.ListBuilder.del"].includes(n.className))!function(t){(0,e.$)(i).find(`label[data-id='${t}']`).classList.remove("selected")}(n.closest(".chip").dataset.id),n.closest(".chip").remove();else if("label"===n.tagName.toLowerCase()){let t=n.dataset.id,a=i.querySelectorAll(".chip"),o=[].some.call(a,(e=>e.dataset.id===t)),s=(0,e.$)(i).find(".chip-wrap");if(o)n.classList.toggle("selected"),s.querySelector(`[data-id='${t}']`).remove();else{n.classList.toggle("selected");let e=function(e){let t=document.createElement("div");t.classList.add("chip"),t.innerText=n.innerText,t.dataset.id=e;let i=document.createElement("div");return i.classList.add("view.components.Builders.ListBuilder.del"),i.innerText="X",t.append(i),t}(t);s.append(e)}}}),!1),t.addEventListener("blur",(function(t){let{target:n}=t,i=(0,e.$)(this).find(".show");i&&i.classList.remove("show")}),!1)}))}(),function(){let t=(0,e.$)(".item_wrap")[0];if(t){(0,e.$)(t).on("click",(async function(n){let{target:i}=n,a=t,o=a.dataset.model;i.closest(".save")?async function(t){if(function(){let t=(0,e.$)("[required]"),n=0;return[].forEach.call(t,(function(t){if(!t.innerText){if(t.style.borderColor="red",(0,e.$)(t).find(".error"))return;let i=document.createElement("div");i.innerText="Заполните поле",i.classList.add("error"),t.closest(".value").appendChild(i),n++}})),n}())return!1;let n=function(t){let n=(0,e.$)(`[data-field][data-model='${t}']`),i={};return[].map.call(n,(t=>{if(t.closest("[data-parent]"))return i;if(t.hasAttribute("data-value")||t.hasAttribute("custom-select")||t.hasAttribute("custom-radio")||t.hasAttribute("tab"))i[t.dataset.field]=t.dataset.value;else if(t.hasAttribute("multi-select")){let e=t.querySelectorAll(".chip"),n=[].map.call(e,(e=>e.dataset.id));i[t.dataset.field]=n.toString()}else"inputs"===t.dataset.type?i[t.dataset.field]=function(e){let t=e.querySelectorAll("input"),n=[];return t.forEach((e=>{if(!e.checked)return;let t=e.parentNode.querySelector(".name").innerText;t&&n.push(t)})),n.join(",")}(t):"date"===t.type?i[t.dataset.field]=t.value:i[t.dataset.field]=(0,e.mN)(t.innerText)}),i),i}(t);await(0,e.v_)(`/adminsc/${t}/updateorcreate`,n)}(o):i.closest(".del")&&i.closest(".del").dataset.model?async function(t,n){let i=t.dataset.id;await(0,e.v_)(`/adminsc/${n}/delete`,{id:i})&&(window.location.href=`/adminsc/${n}/edit`)}(a,i.closest(".del").dataset.model):i.classList.contains("tab")&&async function(t){(0,e.$)("[data-tab].show")[0].classList.toggle("show"),(0,e.$)(`[data-tab='${t.dataset.tabId}']`)[0].classList.toggle("show"),(0,e.$)(".tab.active")[0].classList.toggle("active"),t.classList.toggle("active")}(i)}));let n=(0,e.$)("[custom-select]");n&&[].map.call(n,(function(e){new ht(e)}))}}(),document.addEventListener("mouseenter",(function(e){let{target:t}=e;if(!t.dataset||!t.dataset.tooltip)return;let n=t.dataset.tooltip,i=document.createElement("div");i.className="tooltip",i.innerHTML=n,document.body.append(i);let a=t.getBoundingClientRect(),o=a.left+(t.offsetWidth-i.offsetWidth)/2;o<0&&(o=0);let s=a.top-i.offsetHeight-5;s<0&&(s=a.top+t.offsetHeight+5),i.style.left=o+"px",i.style.top=s+"px"}),!0),document.addEventListener("mouseleave",(function(){let e=document.querySelectorAll(".tooltip");e&&[].forEach.call(e,(e=>{e.remove()}))}),!0),function(){if((0,e.$)("[tiny]")){let t=document.createElement("script");t.src="https://cdn.tiny.cloud/1/vmwh6wx8yqbbpeqrkm691ltxy7bx3x90ez9iqlop0mt9uqwl/tinymce/6/tinymce.min.js",t.onload=function(){tinymce.init({skin_url:"/public/src/components/tiny",selector:"#mytextarea",toolbar_mode:"floating",preview_styles:"font-size color",statusbar:!1,menubar:!1,init_instance_callback:function(e){},height:100,content_style:"p{margin:2px 0} body { font-family:Helvetica,Arial,sans-serif; font-size:12px }",plugins:["autoresize","a11ychecker","advlist","advcode","advtable","autolink","checklist","export","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","powerpaste","fullscreen","formatpainter","insertdatetime","media","table","help","wordcount"],toolbar:"save |undo redo | formatpainter casechange blocks | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist checklist outdent indent | removeformat | a11ycheck code table help"})},t.setAttribute("referrerpolicy","origin"),(0,e.$)("head")[0].appendChild(t)}}(),function(){let t=(0,e.$)("[data-testid]")[0];if(t){t=+t.dataset.testid;let n=(0,e.$)(".test-edit.accordion a");Array.from(n).filter((e=>{+e.dataset.id===t&&e.classList.add("current")}))}let n=(0,e.$)(".accordion-open")[0];n&&(0,e.$)(n).on("click",(function(){(0,e.$)(".accordion_wrap")[0].classList.toggle("open")}));let i=(0,e.$)("#burger")[0];i&&(0,e.$)(i).on("click",(function(){(0,e.$)(".admin_sidebar")[0].classList.toggle("open")}))}(),function(){mt();let t=(0,e.$)(".test-edit-wrapper")[0];t&&(dt(".test-edit-wrapper .questions",".questions>.question-edit","question"),(0,e.$)(t).on("keyup",Et),(0,e.$)(t).on("change",$t),(0,e.$)(t).on("click",_t))}(),function(){if(!(0,e.$)(".item_wrap[data-model='product']")[0])return!1;let t=(0,e.$)(".item_wrap")[0].dataset.id;(0,e.$)("#producttiny")[0].onsubmit=function(){tinymce.activeEditor.setProgressState(!0),tinymce.triggerSave(),setTimeout((async()=>{let n=tinymce.activeEditor.getContent();await(0,e.v_)("/adminsc/product/adddescription",{description:n,id:t})&&tinymce.activeEditor.setProgressState(!1,1e3)}),1e3)};let n=(0,e.$)("[data-model='product'] [custom-select][data-model=\"property\"]");n&&[].map.call(n,(function(t){new MutationObserver((function(t){t.forEach((function(t){let n=(0,e.$)(".item_wrap")[0].dataset.id,i=t.target.dataset.modelId,a=t.target.dataset.value;(0,e.v_)("/adminsc/product/setProperty",{propertable_id:n,property_id:i,val_id:a})}))})).observe(t,{attributes:!0})}));let i=(0,e.$)(".images");async function a(n,i,a){let o=new FormData;o.append(n,i,i.name),o.append("imageable_id",t);let s=await fetch(a,{method:"POST",body:o}),r=await s.json(),l=await r.arr.id;return r.arr.popup&&e.gk.show(r.arr.popup),l}function o(e,t,n,i){let a=new FileReader;a.readAsDataURL(e),a.onload=function(e){let{target:a}=e,o=new Image;o.src=a.result;let s=document.createElement("div"),r=document.createElement("div");r.classList.add("del"),r.dataset.id=n,r.dataset.tag=i,r.innerText="x",s.classList.add("image"),s.appendChild(o),s.appendChild(r),t.appendChild(s)}.bind()}async function s(t,n,i,s){for(let l=0;l<=s.length-1;l++){if(r=s[l],!["image/png","image/jpeg","image/jpg","image/webp","image/gif"].includes(r.type)&&(e.gk.show(`Тип файлa ${r.name} должен быть jpg, jpeg, png, webp, gif`),1))continue;let c=await a(l,s[l],n);c&&o(s[l],t,c,i)}var r}[].forEach.call(i,(function(n){(0,e.$)(n).on("click",(async function(n){let{target:i}=n;if(i.classList.contains("del")){let n=i.closest(".image").querySelector("img"),a=i.closest(".image").querySelector(".del"),o=i.dataset.id,s=i.dataset.tag;"ok"===(await(0,e.v_)("/adminsc/product/"+s,{productId:t,id:o})).popup&&(n.remove(),a.remove())}}))}));let r=(0,e.$)(".image_main .images")[0],l="/adminsc/product/addMainImage",c="delMainImage";xt(".add_main_image",async function(e,t,n,i){let s=await a(0,i[0],t);s&&(e.querySelector(".image").remove(),o(i[0],e,s,n))}.bind(null,r,l,c)),r=(0,e.$)(".detail_images .images")[0],l="/adminsc/product/addDetailImages",c="delDetailImage",xt(".add_detail_image",s.bind(null,r,l,c)),r=(0,e.$)(".small_pack_images .images")[0],l="/adminsc/product/addSmallPackImage",c="delSmallPackImages",xt(".add_small_pack_images",s.bind(null,r,l,c)),r=(0,e.$)(".big_pack_images .images")[0],l="/adminsc/product/addBigPackImage",c="delBigPackImages",xt(".add_big_pack_image",s.bind(null,r,l,c))}()}))}()}();
//# sourceMappingURL=admin.js.map