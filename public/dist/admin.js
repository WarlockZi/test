/*! For license information please see admin.js.LICENSE.txt */
!function(){"use strict";var t={317:function(e,t,n){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{$:function(){return d},$k:function(){return a},Ds:function(){return o},gk:function(){return r},mN:function(){return s},v_:function(){return l}});const o=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700;return function(){const i=()=>e.apply(this,arguments);clearTimeout(t),t=setTimeout(i,n)}};function a(e){return s(d(e)[0].outerHTML)}function s(e){return function(e){var t=new RegExp("\\t?","g");return e.replace(t,"")}(e=function(e){var t=new RegExp("\\n?","g");return e.replace(t,"")}(e=function(e){var t=new RegExp("&nbsp;?","g");return e.replace(t," ")}(e)))}let r={show:function(e,t){let n=this.el("div","popup__close");n.innerText="X";let i=this.el("div","popup__item");i.innerText=e,i.append(n);let o=d(".popup")[0];o||(o=this.el("div","popup")),o.append(i),o.addEventListener("click",this.close,!0),document.body.append(o),setTimeout((()=>{i.classList.remove("popup__item"),i.classList.add("popup-hide")}),5e3),setTimeout((()=>{i.remove(),t&&t()}),5950)},close:function(e){e.target.classList.contains("popup__close")&&this.closest(".popup").remove()},el:function(e,t){let n=document.createElement(e);return n.classList.add(t),n}};async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((async function(n,i){t.token=document.querySelector('meta[name="token"]').getAttribute("content");let o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),t instanceof FormData?o.send(t):(o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send("param="+JSON.stringify(t))),o.onerror=function(e){i(Error("Network Error"+e))},o.onload=function(){let e=JSON.parse(o.response),t=d(".message")[0];e.popup||e.arr.popup?r.show(e.popup??(null==e?void 0:e.arr.popup)):e.msg?t&&(t.innerHTML=e.msg,t.innerHTML=e.msg,d(t).removeClass("success"),d(t).removeClass("error")):e.success?t&&(t.innerHTML=e.success,d(t).addClass("success"),d(t).removeClass("error")):e.error&&t&&(t.innerHTML="",t.innerHTML=e.error,d(t).removeClass("success"),d(t).addClass("error")),n(e)}}))}class c extends Array{constructor(){super(...arguments),i(this,"value",(function(){return this[0].getAttribute("value")})),i(this,"attr",(function(e,t){return t&&this[0].setAttribute(e,t),this[0].getAttribute(e)})),i(this,"selectedIndexValue",(function(){if(this.length)return this[0].selectedOptions[0].value})),i(this,"options",(function(){if(this.length)return this[0].options})),i(this,"count",(function(){return this.length})),i(this,"text",(function(){if(this.length)return this[0].innerText})),i(this,"checked",(function(){if(this.length)return this[0].checked})),i(this,"getWithStyle",(function(e,t){let n=[];return this.forEach((i=>{i.style[e]===t&&n.push(i)})),n})),i(this,"addClass",(function(e){this.forEach((t=>{t.classList.add(e)}))})),i(this,"removeClass",(function(e){this.forEach((t=>{t.classList.remove(e)}))})),i(this,"hasClass",(function(e){if(this.classList.contains(e))return!0})),i(this,"append",(function(e){this[0].appendChild(e)})),i(this,"find",(function(e){return"string"==typeof e?this[0].querySelector(e):this[0].filter((t=>t===e))[0]})),i(this,"findAll",(function(e){if("string"==typeof e)return this[0].querySelectorAll(e)})),i(this,"css",(function(e,t){if(!t)return this[0].style[e];this.forEach((n=>{n.style[e]=t}))}))}on(e,t,n){"function"==typeof t?this.forEach((n=>n.addEventListener(e,t))):this.forEach((i=>{i.addEventListener(e,(e=>{e.target===t&&n(e)}))}))}ready(e){this.some((e=>null!=e.readyState&&"loading"!=e.readyState))?e():document.addEventListener("DOMContentLoaded",e)}}function d(e){return"string"==typeof e||e instanceof String?new c(...document.querySelectorAll(e)):new c(e)}}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var t=i(317);if((0,t.$)("[accordion]")){let e=(0,t.$)("[accordion] [type='checkbox']");e&&[...e].filter((e=>{e.checked=!1})),(0,t.$)("[accordion]").on("click",(function(e){let{target:i}=e,o=i.closest("li");if(!o)return;let a=(0,t.$)(o).find("ul");if(a)if(a.classList.contains("open"))n(a,o);else{if(!a)return;let e=o.closest("ul");!function(e){if(!e)return;let i=(0,t.$)(e).find("li>ul.open");if(i){let e=i.closest("li");n(i,e)}}(e),function(e,t,n){n&&(n.style.maxHeight=e.scrollHeight+n.scrollHeight+"px"),e.style.maxHeight=e.scrollHeight+"px",e.classList.toggle("open"),t.classList.toggle("rotate")}(a,o,e)}else!function(e){e.classList.toggle("rotate")}(o)}))}function n(e,t){e.style.maxHeight="0px",e.classList.toggle("open"),t.classList.toggle("rotate")}(0,t.$)(".admin_sidebar")[0]&&(0,t.$)("svg#burger").on("click",(function(){(0,t.$)(".admin_sidebar [accordion]")[0].classList.toggle("show")}));const o={delServer:async e=>{(0,t.$)(".opentest")?await(0,t.v_)("/adminsc/opentestresult/delete",{id:e}):await(0,t.v_)("/adminsc/testresult/delete",{id:e})},delDom:e=>{[].map.call((0,t.$)(`[data-row = "${e}"]`),(function(e){e.remove()}))},delete:e=>{confirm("Удалить результат теста?")&&(o.delDom(e),o.delServer(e))}};let a=(0,t.$)(".test-results__table")[0];function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}a&&(0,t.$)(a).on("click",(function(e){let{target:t}=e;if(t.closest(".del-btn")){let e=t.closest(".del-btn").dataset.row;o.delete(e)}})),(0,t.$)(".testresult")[0]&&((0,t.$)(".accordion_wrap")[0].remove(),(0,t.$)(".page-name")[0].remove(),(0,t.$)(".test-name")[0].remove(),(0,t.$)(".test-do__finish-btn")[0].remove());const r=new class{constructor(){var e;s(this,"model","openquestion"),s(this,"questions",(0,t.$)(".questions>.question-edit")),s(this,"testId",+(null===(e=(0,t.$)(".questions")[0])||void 0===e?void 0:e.dataset.testId)??null),s(this,"questionCnt",(0,t.$)(".questions>.question-edit").length??null)}async create(e){let n=this.testId,i=this.questionCnt+1,o=await(0,t.v_)(`/adminsc/${this.model}/updateOrCreate`,{id:0,opentest_id:n,sort:i});if(o.arr.id){let t=this.cloneEmptyModel();t.querySelector(".sort").innerText=this.questionCnt+1,t.querySelector(".text").innerText="",t.id=o.arr.id,e.before(t)}}cloneEmptyModel(){let e=(0,t.$)(".questions .question-edit")[0];if(e){let t=e.cloneNode(!0),n=t.querySelectorAll(".row .answer");return[].forEach.call(n,(function(e){e.remove()})),t}}async sort(e){let n=this.questions.filter((function(t,n){if(n+1<e)return t})),i=n.map((e=>e.id));await(0,t.v_)(`/${this.model}/sort`,{toChange:i}),n.map(((e,n)=>{(0,t.$)(e).find(".sort").innerText=n+1}))}async changeParent(n){if("li"!==n.tagName.toLowerCase())return;let i=n.closest(".question-edit").id,o=n.dataset.value,a=n.innerText;if(+i&&+o&&a){if("ok"!==(await(0,t.v_)(`/adminsc/${this.model}/changeParent`,{id:i,test_id:o})).msg)throw e;n.closest(".question-edit").remove(),t.gk.show("Перемещен в "+a)}}showAnswers(e){let n=e.closest(".question-edit"),i=(0,t.$)(n).find(".question__answers");i.classList.toggle("height"),i.classList.toggle("scale"),e.classList.toggle("rotate")}async del(e){if(confirm("Удалить вопрос со всеми его ответами?")){let n=e.closest(".question-edit"),i=n.id;await(0,t.v_)(`/adminsc/${this.model}/delete`,{id:i})&&n.remove()}}};function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},h.apply(this,arguments)}function p(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function f(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var m=f(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),g=f(/Edge/i),v=f(/firefox/i),b=f(/safari/i)&&!f(/chrome/i)&&!f(/android/i),w=f(/iP(ad|od|hone)/i),y=f(/chrome/i)&&f(/android/i),_={capture:!1,passive:!1};function E(e,t,n){e.addEventListener(t,n,!m&&_)}function $(e,t,n){e.removeEventListener(t,n,!m&&_)}function S(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function T(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function x(e,t,n,i){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&S(e,t):S(e,t))||i&&e===n)return e;if(e===n)break}while(e=T(e))}return null}var C,L=/\s+/g;function D(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(L," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(L," ")}}function A(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function q(e,t){var n="";if("string"==typeof e)n=e;else do{var i=A(e,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function O(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function N(){return document.scrollingElement||document.documentElement}function k(e,t,n,i,o){if(e.getBoundingClientRect||e===window){var a,s,r,l,c,d,u;if(e!==window&&e.parentNode&&e!==N()?(s=(a=e.getBoundingClientRect()).top,r=a.left,l=a.bottom,c=a.right,d=a.height,u=a.width):(s=0,r=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!m))do{if(o&&o.getBoundingClientRect&&("none"!==A(o,"transform")||n&&"static"!==A(o,"position"))){var h=o.getBoundingClientRect();s-=h.top+parseInt(A(o,"border-top-width")),r-=h.left+parseInt(A(o,"border-left-width")),l=s+a.height,c=r+a.width;break}}while(o=o.parentNode);if(i&&e!==window){var p=q(o||e),f=p&&p.a,g=p&&p.d;p&&(l=(s/=g)+(d/=g),c=(r/=f)+(u/=f))}return{top:s,left:r,bottom:l,right:c,width:u,height:d}}}function M(e,t,n){for(var i=X(e,!0),o=k(e)[t];i;){var a=k(i)[n];if(!("top"===n||"left"===n?o>=a:o<=a))return i;if(i===N())break;i=X(i,!1)}return!1}function P(e,t,n,i){for(var o=0,a=0,s=e.children;a<s.length;){if("none"!==s[a].style.display&&s[a]!==Ye.ghost&&(i||s[a]!==Ye.dragged)&&x(s[a],n.draggable,e,!1)){if(o===t)return s[a];o++}a++}return null}function I(e,t){for(var n=e.lastElementChild;n&&(n===Ye.ghost||"none"===A(n,"display")||t&&!S(n,t));)n=n.previousElementSibling;return n||null}function R(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ye.clone||t&&!S(e,t)||n++;return n}function H(e){var t=0,n=0,i=N();if(e)do{var o=q(e),a=o.a,s=o.d;t+=e.scrollLeft*a,n+=e.scrollTop*s}while(e!==i&&(e=e.parentNode));return[t,n]}function X(e,t){if(!e||!e.getBoundingClientRect)return N();var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=A(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return N();if(i||t)return n;i=!0}}}while(n=n.parentNode);return N()}function B(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function Y(e,t){return function(){if(!C){var n=arguments,i=this;1===n.length?e.call(i,n[0]):e.apply(i,n),C=setTimeout((function(){C=void 0}),t)}}}function F(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function j(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var W="Sortable"+(new Date).getTime();var z=[],V={initializeByDefault:!0},G={mount:function(e){for(var t in V)V.hasOwnProperty(t)&&!(t in e)&&(e[t]=V[t]);z.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),z.push(e)},pluginEvent:function(e,t,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var o=e+"Global";z.forEach((function(i){t[i.pluginName]&&(t[i.pluginName][o]&&t[i.pluginName][o](c({sortable:t},n)),t.options[i.pluginName]&&t[i.pluginName][e]&&t[i.pluginName][e](c({sortable:t},n)))}))},initializePlugins:function(e,t,n,i){for(var o in z.forEach((function(i){var o=i.pluginName;if(e.options[o]||i.initializeByDefault){var a=new i(e,t,e.options);a.sortable=e,a.options=e.options,e[o]=a,h(n,a.defaults)}})),e.options)if(e.options.hasOwnProperty(o)){var a=this.modifyOption(e,o,e.options[o]);void 0!==a&&(e.options[o]=a)}},getEventProperties:function(e,t){var n={};return z.forEach((function(i){"function"==typeof i.eventProperties&&h(n,i.eventProperties.call(t[i.pluginName],e))})),n},modifyOption:function(e,t,n){var i;return z.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(i=o.optionListeners[t].call(e[o.pluginName],n))})),i}};var U=["evt"],Q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.evt,o=p(n,U);G.pluginEvent.bind(Ye)(e,t,c({dragEl:Z,parentEl:K,ghostEl:ee,rootEl:te,nextEl:ne,lastDownEl:ie,cloneEl:oe,cloneHidden:ae,dragStarted:be,putSortable:ue,activeSortable:Ye.active,originalEvent:i,oldIndex:se,oldDraggableIndex:le,newIndex:re,newDraggableIndex:ce,hideGhostForTarget:Re,unhideGhostForTarget:He,cloneNowHidden:function(){ae=!0},cloneNowShown:function(){ae=!1},dispatchSortableEvent:function(e){J({sortable:t,name:e,originalEvent:i})}},o))};function J(e){!function(e){var t=e.sortable,n=e.rootEl,i=e.name,o=e.targetEl,a=e.cloneEl,s=e.toEl,r=e.fromEl,l=e.oldIndex,d=e.newIndex,u=e.oldDraggableIndex,h=e.newDraggableIndex,p=e.originalEvent,f=e.putSortable,v=e.extraEventProperties;if(t=t||n&&n[W]){var b,w=t.options,y="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||m||g?(b=document.createEvent("Event")).initEvent(i,!0,!0):b=new CustomEvent(i,{bubbles:!0,cancelable:!0}),b.to=s||n,b.from=r||n,b.item=o||n,b.clone=a,b.oldIndex=l,b.newIndex=d,b.oldDraggableIndex=u,b.newDraggableIndex=h,b.originalEvent=p,b.pullMode=f?f.lastPutMode:void 0;var _=c(c({},v),G.getEventProperties(i,t));for(var E in _)b[E]=_[E];n&&n.dispatchEvent(b),w[y]&&w[y].call(t,b)}}(c({putSortable:ue,cloneEl:oe,targetEl:Z,rootEl:te,oldIndex:se,oldDraggableIndex:le,newIndex:re,newDraggableIndex:ce},e))}var Z,K,ee,te,ne,ie,oe,ae,se,re,le,ce,de,ue,he,pe,fe,me,ge,ve,be,we,ye,_e,Ee,$e=!1,Se=!1,Te=[],xe=!1,Ce=!1,Le=[],De=!1,Ae=[],qe="undefined"!=typeof document,Oe=w,Ne=g||m?"cssFloat":"float",ke=qe&&!y&&!w&&"draggable"in document.createElement("div"),Me=function(){if(qe){if(m)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Pe=function(e,t){var n=A(e),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=P(e,0,t),a=P(e,1,t),s=o&&A(o),r=a&&A(a),l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+k(o).width,c=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+k(a).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&s.float&&"none"!==s.float){var d="left"===s.float?"left":"right";return!a||"both"!==r.clear&&r.clear!==d?"horizontal":"vertical"}return o&&("block"===s.display||"flex"===s.display||"table"===s.display||"grid"===s.display||l>=i&&"none"===n[Ne]||a&&"none"===n[Ne]&&l+c>i)?"vertical":"horizontal"},Ie=function(e){function t(e,n){return function(i,o,a,s){var r=i.options.group.name&&o.options.group.name&&i.options.group.name===o.options.group.name;if(null==e&&(n||r))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(i,o,a,s),n)(i,o,a,s);var l=(n?i:o).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},i=e.group;i&&"object"==d(i)||(i={name:i}),n.name=i.name,n.checkPull=t(i.pull,!0),n.checkPut=t(i.put),n.revertClone=i.revertClone,e.group=n},Re=function(){!Me&&ee&&A(ee,"display","none")},He=function(){!Me&&ee&&A(ee,"display","")};qe&&!y&&document.addEventListener("click",(function(e){if(Se)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Se=!1,!1}),!0);var Xe=function(e){if(Z){e=e.touches?e.touches[0]:e;var t=(o=e.clientX,a=e.clientY,Te.some((function(e){var t=e[W].options.emptyInsertThreshold;if(t&&!I(e)){var n=k(e),i=o>=n.left-t&&o<=n.right+t,r=a>=n.top-t&&a<=n.bottom+t;return i&&r?s=e:void 0}})),s);if(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[W]._onDragOver(n)}}var o,a,s},Be=function(e){Z&&Z.parentNode[W]._isOutsideThisEl(e.target)};function Ye(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=h({},t),e[W]=this;var n,i,o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Pe(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ye.supportPointer&&"PointerEvent"in window&&!b,emptyInsertThreshold:5};for(var a in G.initializePlugins(this,e,o),o)!(a in t)&&(t[a]=o[a]);for(var s in Ie(t),this)"_"===s.charAt(0)&&"function"==typeof this[s]&&(this[s]=this[s].bind(this));this.nativeDraggable=!t.forceFallback&&ke,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?E(e,"pointerdown",this._onTapStart):(E(e,"mousedown",this._onTapStart),E(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(E(e,"dragover",this),E(e,"dragenter",this)),Te.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),h(this,(i=[],{captureAnimationState:function(){i=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(e){if("none"!==A(e,"display")&&e!==Ye.ghost){i.push({target:e,rect:k(e)});var t=c({},i[i.length-1].rect);if(e.thisAnimationDuration){var n=q(e,!0);n&&(t.top-=n.f,t.left-=n.e)}e.fromRect=t}}))},addAnimationState:function(e){i.push(e)},removeAnimationState:function(e){i.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n);return-1}(i,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(n),void("function"==typeof e&&e());var o=!1,a=0;i.forEach((function(e){var n=0,i=e.target,s=i.fromRect,r=k(i),l=i.prevFromRect,c=i.prevToRect,d=e.rect,u=q(i,!0);u&&(r.top-=u.f,r.left-=u.e),i.toRect=r,i.thisAnimationDuration&&B(l,r)&&!B(s,r)&&(d.top-r.top)/(d.left-r.left)==(s.top-r.top)/(s.left-r.left)&&(n=function(e,t,n,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*i.animation}(d,l,c,t.options)),B(r,s)||(i.prevFromRect=s,i.prevToRect=r,n||(n=t.options.animation),t.animate(i,d,r,n)),n&&(o=!0,a=Math.max(a,n),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),n),i.thisAnimationDuration=n)})),clearTimeout(n),o?n=setTimeout((function(){"function"==typeof e&&e()}),a):"function"==typeof e&&e(),i=[]},animate:function(e,t,n,i){if(i){A(e,"transition",""),A(e,"transform","");var o=q(this.el),a=o&&o.a,s=o&&o.d,r=(t.left-n.left)/(a||1),l=(t.top-n.top)/(s||1);e.animatingX=!!r,e.animatingY=!!l,A(e,"transform","translate3d("+r+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),A(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),A(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){A(e,"transition",""),A(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),i)}}}))}function Fe(e,t,n,i,o,a,s,r){var l,c,d=e[W],u=d.options.onMove;return!window.CustomEvent||m||g?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=i,l.related=o||t,l.relatedRect=a||k(t),l.willInsertAfter=r,l.originalEvent=s,e.dispatchEvent(l),u&&(c=u.call(d,l,s)),c}function je(e){e.draggable=!1}function We(){De=!1}function ze(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function Ve(e){return setTimeout(e,0)}function Ge(e){return clearTimeout(e)}Ye.prototype={constructor:Ye,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(we=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Z):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,i=this.options,o=i.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,r=(s||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||r,c=i.filter;if(function(e){Ae.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&Ae.push(i)}}(n),!Z&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||i.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!b||!r||"SELECT"!==r.tagName.toUpperCase())&&!((r=x(r,i.draggable,n,!1))&&r.animated||ie===r)){if(se=R(r),le=R(r,i.draggable),"function"==typeof c){if(c.call(this,e,r,this))return J({sortable:t,rootEl:l,name:"filter",targetEl:r,toEl:n,fromEl:n}),Q("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(i){if(i=x(l,i.trim(),n,!1))return J({sortable:t,rootEl:i,name:"filter",targetEl:r,fromEl:n,toEl:n}),Q("filter",t,{evt:e}),!0}))))return void(o&&e.cancelable&&e.preventDefault());i.handle&&!x(l,i.handle,n,!1)||this._prepareDragStart(e,s,r)}}},_prepareDragStart:function(e,t,n){var i,o=this,a=o.el,s=o.options,r=a.ownerDocument;if(n&&!Z&&n.parentNode===a){var l=k(n);if(te=a,K=(Z=n).parentNode,ne=Z.nextSibling,ie=n,de=s.group,Ye.dragged=Z,he={target:Z,clientX:(t||e).clientX,clientY:(t||e).clientY},ge=he.clientX-l.left,ve=he.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Z.style["will-change"]="all",i=function(){Q("delayEnded",o,{evt:e}),Ye.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!v&&o.nativeDraggable&&(Z.draggable=!0),o._triggerDragStart(e,t),J({sortable:o,name:"choose",originalEvent:e}),D(Z,s.chosenClass,!0))},s.ignore.split(",").forEach((function(e){O(Z,e.trim(),je)})),E(r,"dragover",Xe),E(r,"mousemove",Xe),E(r,"touchmove",Xe),E(r,"mouseup",o._onDrop),E(r,"touchend",o._onDrop),E(r,"touchcancel",o._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Z.draggable=!0),Q("delayStart",this,{evt:e}),!s.delay||s.delayOnTouchOnly&&!t||this.nativeDraggable&&(g||m))i();else{if(Ye.eventCanceled)return void this._onDrop();E(r,"mouseup",o._disableDelayedDrag),E(r,"touchend",o._disableDelayedDrag),E(r,"touchcancel",o._disableDelayedDrag),E(r,"mousemove",o._delayedDragTouchMoveHandler),E(r,"touchmove",o._delayedDragTouchMoveHandler),s.supportPointer&&E(r,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(i,s.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Z&&je(Z),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;$(e,"mouseup",this._disableDelayedDrag),$(e,"touchend",this._disableDelayedDrag),$(e,"touchcancel",this._disableDelayedDrag),$(e,"mousemove",this._delayedDragTouchMoveHandler),$(e,"touchmove",this._delayedDragTouchMoveHandler),$(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?E(document,"pointermove",this._onTouchMove):E(document,t?"touchmove":"mousemove",this._onTouchMove):(E(Z,"dragend",this),E(te,"dragstart",this._onDragStart));try{document.selection?Ve((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if($e=!1,te&&Z){Q("dragStarted",this,{evt:t}),this.nativeDraggable&&E(document,"dragover",Be);var n=this.options;!e&&D(Z,n.dragClass,!1),D(Z,n.ghostClass,!0),Ye.active=this,e&&this._appendGhost(),J({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(pe){this._lastX=pe.clientX,this._lastY=pe.clientY,Re();for(var e=document.elementFromPoint(pe.clientX,pe.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(pe.clientX,pe.clientY))!==t;)t=e;if(Z.parentNode[W]._isOutsideThisEl(e),t)do{if(t[W]&&t[W]._onDragOver({clientX:pe.clientX,clientY:pe.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);He()}},_onTouchMove:function(e){if(he){var t=this.options,n=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,a=ee&&q(ee,!0),s=ee&&a&&a.a,r=ee&&a&&a.d,l=Oe&&Ee&&H(Ee),c=(o.clientX-he.clientX+i.x)/(s||1)+(l?l[0]-Le[0]:0)/(s||1),d=(o.clientY-he.clientY+i.y)/(r||1)+(l?l[1]-Le[1]:0)/(r||1);if(!Ye.active&&!$e){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(ee){a?(a.e+=c-(fe||0),a.f+=d-(me||0)):a={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");A(ee,"webkitTransform",u),A(ee,"mozTransform",u),A(ee,"msTransform",u),A(ee,"transform",u),fe=c,me=d,pe=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ee){var e=this.options.fallbackOnBody?document.body:te,t=k(Z,!0,Oe,!0,e),n=this.options;if(Oe){for(Ee=e;"static"===A(Ee,"position")&&"none"===A(Ee,"transform")&&Ee!==document;)Ee=Ee.parentNode;Ee!==document.body&&Ee!==document.documentElement?(Ee===document&&(Ee=N()),t.top+=Ee.scrollTop,t.left+=Ee.scrollLeft):Ee=N(),Le=H(Ee)}D(ee=Z.cloneNode(!0),n.ghostClass,!1),D(ee,n.fallbackClass,!0),D(ee,n.dragClass,!0),A(ee,"transition",""),A(ee,"transform",""),A(ee,"box-sizing","border-box"),A(ee,"margin",0),A(ee,"top",t.top),A(ee,"left",t.left),A(ee,"width",t.width),A(ee,"height",t.height),A(ee,"opacity","0.8"),A(ee,"position",Oe?"absolute":"fixed"),A(ee,"zIndex","100000"),A(ee,"pointerEvents","none"),Ye.ghost=ee,e.appendChild(ee),A(ee,"transform-origin",ge/parseInt(ee.style.width)*100+"% "+ve/parseInt(ee.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,i=e.dataTransfer,o=n.options;Q("dragStart",this,{evt:e}),Ye.eventCanceled?this._onDrop():(Q("setupClone",this),Ye.eventCanceled||((oe=j(Z)).removeAttribute("id"),oe.draggable=!1,oe.style["will-change"]="",this._hideClone(),D(oe,this.options.chosenClass,!1),Ye.clone=oe),n.cloneId=Ve((function(){Q("clone",n),Ye.eventCanceled||(n.options.removeCloneOnHide||te.insertBefore(oe,Z),n._hideClone(),J({sortable:n,name:"clone"}))})),!t&&D(Z,o.dragClass,!0),t?(Se=!0,n._loopId=setInterval(n._emulateDragOver,50)):($(document,"mouseup",n._onDrop),$(document,"touchend",n._onDrop),$(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(n,i,Z)),E(document,"drop",n),A(Z,"transform","translateZ(0)")),$e=!0,n._dragStartId=Ve(n._dragStarted.bind(n,t,e)),E(document,"selectstart",n),be=!0,b&&A(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,i,o,a=this.el,s=e.target,r=this.options,l=r.group,d=Ye.active,u=de===l,h=r.sort,p=ue||d,f=this,m=!1;if(!De){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=x(s,r.draggable,a,!0),N("dragOver"),Ye.eventCanceled)return m;if(Z.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||f._ignoreWhileAnimating===s)return X(!1);if(Se=!1,d&&!r.disabled&&(u?h||(i=K!==te):ue===this||(this.lastPutMode=de.checkPull(this,d,Z,e))&&l.checkPut(this,d,Z,e))){if(o="vertical"===this._getDirection(e,s),t=k(Z),N("dragOverValid"),Ye.eventCanceled)return m;if(i)return K=te,H(),this._hideClone(),N("revert"),Ye.eventCanceled||(ne?te.insertBefore(Z,ne):te.appendChild(Z)),X(!0);var g=I(a,r.draggable);if(!g||function(e,t,n){var i=k(I(n.el,n.options.draggable));return t?e.clientX>i.right+10||e.clientX<=i.right&&e.clientY>i.bottom&&e.clientX>=i.left:e.clientX>i.right&&e.clientY>i.top||e.clientX<=i.right&&e.clientY>i.bottom+10}(e,o,this)&&!g.animated){if(g===Z)return X(!1);if(g&&a===e.target&&(s=g),s&&(n=k(s)),!1!==Fe(te,a,Z,t,s,n,e,!!s))return H(),g&&g.nextSibling?a.insertBefore(Z,g.nextSibling):a.appendChild(Z),K=a,B(),X(!0)}else if(g&&function(e,t,n){var i=k(P(n.el,0,n.options,!0));return t?e.clientX<i.left-10||e.clientY<i.top&&e.clientX<i.right:e.clientY<i.top-10||e.clientY<i.bottom&&e.clientX<i.left}(e,o,this)){var v=P(a,0,r,!0);if(v===Z)return X(!1);if(n=k(s=v),!1!==Fe(te,a,Z,t,s,n,e,!1))return H(),a.insertBefore(Z,v),K=a,B(),X(!0)}else if(s.parentNode===a){n=k(s);var b,w,y,_=Z.parentNode!==a,E=!function(e,t,n){var i=n?e.left:e.top,o=n?e.right:e.bottom,a=n?e.width:e.height,s=n?t.left:t.top,r=n?t.right:t.bottom,l=n?t.width:t.height;return i===s||o===r||i+a/2===s+l/2}(Z.animated&&Z.toRect||t,s.animated&&s.toRect||n,o),$=o?"top":"left",S=M(s,"top","top")||M(Z,"top","top"),T=S?S.scrollTop:void 0;if(we!==s&&(w=n[$],xe=!1,Ce=!E&&r.invertSwap||_),b=function(e,t,n,i,o,a,s,r){var l=i?e.clientY:e.clientX,c=i?n.height:n.width,d=i?n.top:n.left,u=i?n.bottom:n.right,h=!1;if(!s)if(r&&_e<c*o){if(!xe&&(1===ye?l>d+c*a/2:l<u-c*a/2)&&(xe=!0),xe)h=!0;else if(1===ye?l<d+_e:l>u-_e)return-ye}else if(l>d+c*(1-o)/2&&l<u-c*(1-o)/2)return function(e){return R(Z)<R(e)?1:-1}(t);return(h=h||s)&&(l<d+c*a/2||l>u-c*a/2)?l>d+c/2?1:-1:0}(e,s,n,o,E?1:r.swapThreshold,null==r.invertedSwapThreshold?r.swapThreshold:r.invertedSwapThreshold,Ce,we===s),0!==b){var C=R(Z);do{C-=b,y=K.children[C]}while(y&&("none"===A(y,"display")||y===ee))}if(0===b||y===s)return X(!1);we=s,ye=b;var L=s.nextElementSibling,q=!1,O=Fe(te,a,Z,t,s,n,e,q=1===b);if(!1!==O)return 1!==O&&-1!==O||(q=1===O),De=!0,setTimeout(We,30),H(),q&&!L?a.appendChild(Z):s.parentNode.insertBefore(Z,q?L:s),S&&F(S,0,T-S.scrollTop),K=Z.parentNode,void 0===w||Ce||(_e=Math.abs(w-k(s)[$])),B(),X(!0)}if(a.contains(Z))return X(!1)}return!1}function N(r,l){Q(r,f,c({evt:e,isOwner:u,axis:o?"vertical":"horizontal",revert:i,dragRect:t,targetRect:n,canSort:h,fromSortable:p,target:s,completed:X,onMove:function(n,i){return Fe(te,a,Z,t,n,k(n),e,i)},changed:B},l))}function H(){N("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function X(t){return N("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(f),f!==p&&(D(Z,ue?ue.options.ghostClass:d.options.ghostClass,!1),D(Z,r.ghostClass,!0)),ue!==f&&f!==Ye.active?ue=f:f===Ye.active&&ue&&(ue=null),p===f&&(f._ignoreWhileAnimating=s),f.animateAll((function(){N("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(s===Z&&!Z.animated||s===a&&!s.animated)&&(we=null),r.dragoverBubble||e.rootEl||s===document||(Z.parentNode[W]._isOutsideThisEl(e.target),!t&&Xe(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function B(){re=R(Z),ce=R(Z,r.draggable),J({sortable:f,name:"change",toEl:a,newIndex:re,newDraggableIndex:ce,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){$(document,"mousemove",this._onTouchMove),$(document,"touchmove",this._onTouchMove),$(document,"pointermove",this._onTouchMove),$(document,"dragover",Xe),$(document,"mousemove",Xe),$(document,"touchmove",Xe)},_offUpEvents:function(){var e=this.el.ownerDocument;$(e,"mouseup",this._onDrop),$(e,"touchend",this._onDrop),$(e,"pointerup",this._onDrop),$(e,"touchcancel",this._onDrop),$(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;re=R(Z),ce=R(Z,n.draggable),Q("drop",this,{evt:e}),K=Z&&Z.parentNode,re=R(Z),ce=R(Z,n.draggable),Ye.eventCanceled||($e=!1,Ce=!1,xe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ge(this.cloneId),Ge(this._dragStartId),this.nativeDraggable&&($(document,"drop",this),$(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),b&&A(document.body,"user-select",""),A(Z,"transform",""),e&&(be&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),ee&&ee.parentNode&&ee.parentNode.removeChild(ee),(te===K||ue&&"clone"!==ue.lastPutMode)&&oe&&oe.parentNode&&oe.parentNode.removeChild(oe),Z&&(this.nativeDraggable&&$(Z,"dragend",this),je(Z),Z.style["will-change"]="",be&&!$e&&D(Z,ue?ue.options.ghostClass:this.options.ghostClass,!1),D(Z,this.options.chosenClass,!1),J({sortable:this,name:"unchoose",toEl:K,newIndex:null,newDraggableIndex:null,originalEvent:e}),te!==K?(re>=0&&(J({rootEl:K,name:"add",toEl:K,fromEl:te,originalEvent:e}),J({sortable:this,name:"remove",toEl:K,originalEvent:e}),J({rootEl:K,name:"sort",toEl:K,fromEl:te,originalEvent:e}),J({sortable:this,name:"sort",toEl:K,originalEvent:e})),ue&&ue.save()):re!==se&&re>=0&&(J({sortable:this,name:"update",toEl:K,originalEvent:e}),J({sortable:this,name:"sort",toEl:K,originalEvent:e})),Ye.active&&(null!=re&&-1!==re||(re=se,ce=le),J({sortable:this,name:"end",toEl:K,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){Q("nulling",this),te=Z=K=ee=ne=oe=ie=ae=he=pe=be=re=ce=se=le=we=ye=ue=de=Ye.dragged=Ye.ghost=Ye.clone=Ye.active=null,Ae.forEach((function(e){e.checked=!0})),Ae.length=fe=me=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Z&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,i=0,o=n.length,a=this.options;i<o;i++)x(e=n[i],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||ze(e));return t},sort:function(e,t){var n={},i=this.el;this.toArray().forEach((function(e,t){var o=i.children[t];x(o,this.options.draggable,i,!1)&&(n[e]=o)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return x(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var i=G.modifyOption(this,e,t);n[e]=void 0!==i?i:t,"group"===e&&Ie(n)},destroy:function(){Q("destroy",this);var e=this.el;e[W]=null,$(e,"mousedown",this._onTapStart),$(e,"touchstart",this._onTapStart),$(e,"pointerdown",this._onTapStart),this.nativeDraggable&&($(e,"dragover",this),$(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Te.splice(Te.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ae){if(Q("hideClone",this),Ye.eventCanceled)return;A(oe,"display","none"),this.options.removeCloneOnHide&&oe.parentNode&&oe.parentNode.removeChild(oe),ae=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ae){if(Q("showClone",this),Ye.eventCanceled)return;Z.parentNode!=te||this.options.group.revertClone?ne?te.insertBefore(oe,ne):te.appendChild(oe):te.insertBefore(oe,Z),this.options.group.revertClone&&this.animate(Z,oe),A(oe,"display",""),ae=!1}}else this._hideClone()}},qe&&E(document,"touchmove",(function(e){(Ye.active||$e)&&e.cancelable&&e.preventDefault()})),Ye.utils={on:E,off:$,css:A,find:O,is:function(e,t){return!!x(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:Y,closest:x,toggleClass:D,clone:j,index:R,nextTick:Ve,cancelNextTick:Ge,detectDirection:Pe,getChild:P},Ye.get=function(e){return e[W]},Ye.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ye.utils=c(c({},Ye.utils),e.utils)),G.mount(e)}))},Ye.create=function(e,t){return new Ye(e,t)},Ye.version="1.15.0";var Ue,Qe,Je,Ze,Ke,et,tt=[],nt=!1;function it(){tt.forEach((function(e){clearInterval(e.pid)})),tt=[]}function ot(){clearInterval(et)}var at=Y((function(e,t,n,i){if(t.scroll){var o,a=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,r=t.scrollSensitivity,l=t.scrollSpeed,c=N(),d=!1;Qe!==n&&(Qe=n,it(),Ue=t.scroll,o=t.scrollFn,!0===Ue&&(Ue=X(n,!0)));var u=0,h=Ue;do{var p=h,f=k(p),m=f.top,g=f.bottom,v=f.left,b=f.right,w=f.width,y=f.height,_=void 0,E=void 0,$=p.scrollWidth,S=p.scrollHeight,T=A(p),x=p.scrollLeft,C=p.scrollTop;p===c?(_=w<$&&("auto"===T.overflowX||"scroll"===T.overflowX||"visible"===T.overflowX),E=y<S&&("auto"===T.overflowY||"scroll"===T.overflowY||"visible"===T.overflowY)):(_=w<$&&("auto"===T.overflowX||"scroll"===T.overflowX),E=y<S&&("auto"===T.overflowY||"scroll"===T.overflowY));var L=_&&(Math.abs(b-a)<=r&&x+w<$)-(Math.abs(v-a)<=r&&!!x),D=E&&(Math.abs(g-s)<=r&&C+y<S)-(Math.abs(m-s)<=r&&!!C);if(!tt[u])for(var q=0;q<=u;q++)tt[q]||(tt[q]={});tt[u].vx==L&&tt[u].vy==D&&tt[u].el===p||(tt[u].el=p,tt[u].vx=L,tt[u].vy=D,clearInterval(tt[u].pid),0==L&&0==D||(d=!0,tt[u].pid=setInterval(function(){i&&0===this.layer&&Ye.active._onTouchMove(Ke);var t=tt[this.layer].vy?tt[this.layer].vy*l:0,n=tt[this.layer].vx?tt[this.layer].vx*l:0;"function"==typeof o&&"continue"!==o.call(Ye.dragged.parentNode[W],n,t,e,Ke,tt[this.layer].el)||F(tt[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=X(h,!1)));nt=d}}),30),st=function(e){var t=e.originalEvent,n=e.putSortable,i=e.dragEl,o=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,r=e.unhideGhostForTarget;if(t){var l=n||o;s();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);r(),l&&!l.el.contains(d)&&(a("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function rt(){}function lt(){}rt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=P(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:st},h(rt,{pluginName:"revertOnSpill"}),lt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:st},h(lt,{pluginName:"removeOnSpill"}),Ye.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?E(document,"dragover",this._handleAutoScroll):this.options.supportPointer?E(document,"pointermove",this._handleFallbackAutoScroll):t.touches?E(document,"touchmove",this._handleFallbackAutoScroll):E(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?$(document,"dragover",this._handleAutoScroll):($(document,"pointermove",this._handleFallbackAutoScroll),$(document,"touchmove",this._handleFallbackAutoScroll),$(document,"mousemove",this._handleFallbackAutoScroll)),ot(),it(),clearTimeout(C),C=void 0},nulling:function(){Ke=Qe=Ue=nt=et=Je=Ze=null,tt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,i=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(i,o);if(Ke=e,t||this.options.forceAutoScrollFallback||g||m||b){at(e,this.options,a,t);var s=X(a,!0);!nt||et&&i===Je&&o===Ze||(et&&ot(),et=setInterval((function(){var a=X(document.elementFromPoint(i,o),!0);a!==s&&(s=a,it()),at(e,n.options,a,t)}),10),Je=i,Ze=o)}else{if(!this.options.bubbleScroll||X(a,!0)===N())return void it();at(e,this.options,X(a,!1),!1)}}},h(e,{pluginName:"scroll",initializeByDefault:!0})}),Ye.mount(lt,rt);var ct=Ye;function dt(e,n,i){let o=(0,t.$)(e)[0];o&&ct.create(o,{animation:150,onEnd:function(e){let o=e.oldIndex,a=e.newIndex;!async function(e){let o=(0,t.$)(n),a=[].map.call(o,(function(t,n){if(n-1<e)return t})),s=a.map((e=>e.id));await(0,t.v_)(`/adminsc/${i}/sort`,{toChange:s}),a.map(((e,n)=>{(0,t.$)(e).find(".sort").innerText=n+1}))}(o>a?o:a)}})}class ut{constructor(){this.model="opentest"}async create(){let e=ut.serverModel();e.id=0,e.isTest=1;let n=`/${this.model}/updateOrCreate`,i=await(0,t.v_)(n,e);i&&(window.location.href=`/adminsc/${model}/edit/${i.id}`)}id(){return id??(0,t.$)(".test-name")[0].dataset.testid}children(){return(0,t.$)(".children").length||!1}async path_create(){let e=ut.serverModel();e.id=0,e.isTest=0;let n=`/adminsc/${model}/create`,i=await(0,t.v_)(n,e);i&&(window.location.href=`/adminsc/${model}/edit/${i.id-1}`)}name(){return(0,t.$)(".test-name")[0].innerText}async update(){let e=ut.serverModel(),n=`/adminsc/${e}/update/${e.id}`;await(0,t.v_)(n,e)&&(window.location.href=`/adminsc/${e}/edit/${e.id}`)}async del(){if(ut.children())return t.gk.show("Сначала удалите все тесты из папки"),!1;let e=ut.id();(await(0,t.v_)("/adminsc/${model}/delete",{id:e})).notAdmin?(t.gk.show("Видимость теста скрыта. Чтобы удалить полностью - обратитесь к ГД"),setTimeout((()=>{window.location=`/adminsc/${model}/edit/400`}),4e3)):window.location=`/adminsc/${model}/edit/400`}}let ht={async create(e){let n=e.closest(".question-edit"),i=n.id,o=n.querySelectorAll(".answer").length+1,a=await(0,t.v_)("/adminsc/openanswer/updateOrCreate",{openquestion_id:i,sort:o});if(a.arr.id){let t=a.arr.html;e.insertAdjacentHTML("beforebegin",t)}else t.gk.show("Сохранено")},async del(e){let n=e.closest(".delete");if(!n)return!1;if(confirm("Удалить этот ответ?")){let e=n.closest(".answer"),i=+e.dataset.answerId;await(0,t.v_)("/adminsc/openanswer/delete",{id:i})&&e.remove()}}};class pt{constructor(e){return!!e&&!e.multiple&&(this.title=e.title??"",this.field=e.dataset.field,this.options=(t=e.querySelectorAll("option"),[...t].map((e=>({value:e.value,label:e.label,selected:e.selected,element:e})))),this.sel=document.createElement("div"),e.className&&this.sel.classList.add(e.className),this.label=document.createElement("span"),this.arrow=document.createElement("div"),this.space=document.createElement("div"),this.ul=document.createElement("ul"),function(e){let t;e.title&&(e.titleElement=document.createElement("div"),e.titleElement.classList.add("title"),e.titleElement.innerText=e.title,e.sel.append(e.titleElement)),e.sel.setAttribute("custom-select",""),e.field&&(e.sel.dataset.field=e.field),e.sel.dataset.id=e.selectedOption.value,e.sel.dataset.value=e.selectedOption.value,e.sel.tabIndex=0,e.sel.append(e.label),e.space.classList.add("space"),e.space.innerText=e.selectedOption.label,e.label.append(e.space),e.arrow.classList.add("arrow"),e.label.append(e.arrow),e.ul.classList.add("options"),e.options.forEach((t=>{!function(t){const n=document.createElement("li");n.innerText=t.label,n.dataset.value=t.value,n.classList.toggle("selected",t.selected),n.addEventListener("click",(()=>{e.selectValue(t.value),e.ul.classList.remove("show")})),e.ul.append(n)}(t)})),e.sel.append(e.ul),e.label.addEventListener("click",(()=>{e.ul.classList.toggle("show")})),e.sel.addEventListener("blur",(()=>{e.ul.classList.remove("show")}));let n="";e.sel.addEventListener("keydown",(i=>{switch(i.code){case"Space":e.ul.classList.toggle("show");break;case"ArrowUp":{const t=e.options[e.selectedOptionIndex-1];t&&e.selectValue(t.value);break}case"ArrowDown":{const t=e.options[e.selectedOptionIndex+1];t&&e.selectValue(t.value);break}case"Enter":case"Escape":e.ul.classList.remove("show");break;default:{clearTimeout(t),n+=i.key,t=setTimeout((()=>{n=""}),500);const o=e.options.find((e=>e.label.toLowerCase().startsWith(n)));o&&e.selectValue(o.value)}}}))}(this),e.after(this.sel),void e.remove());var t}get selectedOption(){return this.options.find((e=>e.selected))}get selectedOptionIndex(){return this.options.indexOf(this.selectedOption)}selectValue(e){const t=this.options.find((t=>t.value===e)),n=this.selectedOption;n.selected=!1,t.selected=!0,this.space.innerText=t.label,this.label.closest("[custom-select]").dataset.id=t.value,this.label.closest("[custom-select]").dataset.value=t.value,this.ul.querySelector(`[data-value="${n.value}"]`).classList.remove("selected");const i=this.ul.querySelector(`[data-value="${t.value}"]`);i.classList.add("selected"),i.scrollIntoView({block:"nearest"})}}let ft=(0,t.$)(".opentest-edit-wrapper")[0];if(ft){dt(".opentest-edit-wrapper .questions",".opentest-edit-wrapper .question-edit","openquestion"),new pt((0,t.$)('[data-field="enable"]')[0]),new pt((0,t.$)('[data-field="opentest_id"]')[0]),(0,t.$)(ft).on("change",(async function(e){let{target:t}=e,n=t.closest(".answer");n&&mt(n)})),(0,t.$)(ft).on("click",(e=>{let{target:t}=e;const n=new ut;t.classList.contains("test-path__create")?n.path_create():t.classList.contains("test__create")?n.create():t.closest(".question__show-answers")?r.showAnswers(t):t.closest(".question__delete")?r.del(t):t.classList.contains("question__create-button")?r.create(t):t.closest(".delete")?ht.del(t):t.classList.contains("answer__create-button")?ht.create(t):t.closest(".question-edit__parent-select")?r.changeParent(t):t.classList.contains("led")&&t.classList.toggle("animated")}));let e=async function(e){let{target:n}=e;if(n.classList.contains("text")){let e=n.closest(".answer"),i=n.closest(".question-edit");if(e)mt(e);else if(i){let e=i.id,o=n.innerText;await(0,t.v_)("/adminsc/openquestion/updateOrCreate",{id:e,question:o})}}},n=(0,t.Ds)(e);(0,t.$)(ft).on("keyup",n)}async function mt(e){let n=e.dataset.answerId,i=+e.querySelector("input").checked,o=e.closest(".question-edit").id,a=e.querySelector(".text").innerText;await(0,t.v_)("/adminsc/openanswer/updateOrCreate",{id:n,answer:a,openquestion_id:o,is_correct:i})}let gt=new class{constructor(){}async saveAnswer(e){let n=e.closest(".question-edit").dataset.id,i=e.closest(".answer"),o=this.getAnswerModel(i,n);await(0,t.v_)("/adminsc/answer/updateOrCreate",o)}async del(e){let n=e.closest(".answer"),i=+e.dataset.id;confirm("Удалить?")&&await(0,t.v_)("/adminsc/answer/delete",{id:i})&&n.remove()}async answerCreate(e){let n=(0,t.$)(".answer__create .answer")[0],i=e.closest(".question-edit"),o=+i.id,a=n.cloneNode(!0),s=this.getAnswerModel(a,o),r=await(0,t.v_)("/adminsc/answer/updateOrCreate",s);if(r&&(r.arr.popup&&t.gk.show(r.arr.popup),r.arr.id)){let t=i.querySelectorAll(".answer").length+1;a.querySelector(".sort").innerText=t,a.querySelector(".delete").dataset.id=a.dataset.id=r.arr.id,e.before(a)}}getAnswerModel(e,n){return{id:+e.dataset.id,answer:(0,t.mN)((0,t.$)(e).find(".text").innerText),question_id:n,correct_answer:+(0,t.$)(e).find("input").checked,pica:""}}},vt=new class{constructor(e){this.sort=document.querySelectorAll(".questions>.question-edit").length+1??0}async questionCreate(e){let n=(0,t.$)(".question__create .question-edit")[0].cloneNode(!0),i=this.getQuestionModel(n),o=await(0,t.v_)("/adminsc/question/updateOrCreate",i);o&&(n.querySelector(".sort").innerText=this.sort,n.querySelector(".question__delete").dataset.id=n.dataset.id=o.arr.id,e.before(n))}getQuestionModel(e){return{id:e.dataset.id,qustion:(0,t.mN)(e.querySelector(".text").innerText),parent:+window.location.href.split("/").pop(),sort:e.querySelector(".sort").innerText}}async changeParent(e){let n=e.options[e.selectedIndex],i=e.closest(".question-edit").id,o=n.dataset.questionParentId;n.value,await(0,t.v_)("/adminsc/question/changeParent",{id:i,test_id:o}),e.closest(".question-edit").remove()}showAnswers(e){let n=e.closest(".question-edit"),i=(0,t.$)(n).find(".question__answers");i.classList.toggle("height"),i.classList.toggle("scale"),e.classList.toggle("rotate")}async del(e){let n=e.dataset.model,i=null;"answer"===n?i=e.closest(".answer"):"question"===n&&(i=e.closest(".question-edit"));let o=+e.dataset.id;confirm("Удалить?")&&await(0,t.v_)(`/adminsc/${n}/delete`,{id:o})&&i.remove()}async saveQuestion(e){let n=e.closest(".question-edit"),i=vt.getQuestionModel(n);await(0,t.v_)("/adminsc/question/UpdateOrCreate",i)}};const bt={viewModel:()=>({id:+window.location.href.split("/").pop(),name:(0,t.$)("#test_name").text(),enable:(0,t.$)("#enable")[0],parent:(0,t.$)("select").selectedIndexValue()}),children:()=>(0,t.$)(".children").length||!1,path_create:async()=>{let e=bt.serverModel();e.id=0,e.isTest=0;let n=await(0,t.v_)("/adminsc/test/updateOrCreate",e);n&&(window.location.href=`/adminsc/test/edit/${n.arr.id}`)},id:e=>e??(0,t.$)(".test-name")[0].dataset.testid,name:()=>(0,t.$)(".test-name")[0].innerText,create:async()=>{let e=bt.serverModel();e.id=0,e.isTest=1;let n=await(0,t.v_)("/test/updateOrCreate",e);n&&(window.location.href=`/adminsc/test/edit/${n.arr.id}`)},serverModel:()=>{let e=!!+window.location.href.split("/").pop();e=e||0;let n={id:e,name:(0,t.$)("#name.field")[0].value,isTest:+(0,t.$)("[isTest]")[0].getAttribute("isTest")},i=(0,t.$)("[custom-select]");return[].forEach.call(i,(function(e){n[e.dataset.field]=e.dataset.id})),n},update:async()=>{let e=bt.serverModel(),n=`/adminsc/test/update/${e.id}`;await(0,t.v_)(n,e)&&(window.location.href=`/adminsc/test/edit/${e.id}`)},delete:async function(){if(bt.children())return t.gk.show("Сначала удалите все тесты из папки"),!1;let e=bt.id();(await(0,t.v_)("/adminsc/test/delete",{id:e})).notAdmin?(t.gk.show("Видимость теста скрыта. Чтобы удалить полностью - обратитесь к ГД"),setTimeout((()=>{window.location="/adminsc/test/edit/400"}),4e3)):window.location="/adminsc/test/edit/400"}};function wt(e){let{target:t}=e;t.classList.contains("test-path__update")||t.classList.contains("test__update")||t.classList.contains("test__save")?bt.update():t.classList.contains("test__delete")?bt.delete():t.classList.contains("test-path__create")?bt.path_create():t.classList.contains("test__create")?bt.create():t.closest(".question__show-answers")?vt.showAnswers(t):t.classList.contains("question__create-button")?vt.questionCreate(t):t.closest(".question__delete")?vt.del(t):t.closest(".delete")?gt.del(t):t.classList.contains("answer__create-button")?gt.answerCreate(t):t.classList.contains("correct")&&gt.saveAnswer(t)}let yt=(0,t.Ds)((async function(e){let{target:t}=e;t.classList.contains("text")&&(t.closest(".answer")?gt.saveAnswer(t):vt.saveQuestion(t))}));async function _t(e){let{target:t}=e;t.closest(".question-edit__parent-select")&&vt.changeParent(t)}let Et=(0,t.$)(".test-do")[0];Et&&((0,t.$)(".question").removeClass("show"),(0,t.$)(".question:first-child").addClass("show"),function(){let e=(0,t.$)(".test-do__finish-btn")[0];e&&window.location.pathname.match("^/test/result/.?")&&e.classList.add("inactive")}(),Et.addEventListener("click",(function(e){let{target:n}=e;if(n.classList.contains("accordion-open"))return;let i=(0,t.$)(".question.show")[0]??"",o=+(null==i?void 0:i.dataset.id)??"",a=(0,t.$)("[data-pagination]")??"",s=a.findIndex((e=>e.classList.contains("active")))??"";function r(e,n){(0,t.$)(`[data-pagination="${e}"]`)[0].classList.toggle("active"),(0,t.$)(`[data-pagination="${n}"]`)[0].classList.toggle("active")}function l(e){i.classList.toggle("show"),(0,t.$)(`.question[data-id="${e}"]`)[0].classList.toggle("show")}"checkbox"===n.type?n.labels[0].classList.toggle("pushed"):"prev"===n.id?function(){if(s<1)return!1;let e=+a[s-1].dataset.pagination;r(o,e),l(e)}():"next"===n.id?function(){if(s===a.length-1)return!1;let e=+a[s+1].dataset.pagination;r(o,e),l(e)}():n.classList.contains("test-do__finish-btn")&&async function(e){if("ПРОЙТИ ТЕСТ ЗАНОВО"===e.innerText)return void location.reload();e.innerText="ПРОЙТИ ТЕСТ ЗАНОВО",e.classList.add("inactive"),function(e){let n=(0,t.$)(".question");[].map.call(n,(n=>{let i=function(e,n){let i=e.querySelectorAll(".a"),o=[];return[].map.call(i,(e=>{let i=(0,t.$)(e).find("input"),a=function(e,t,n,i){let o=-1!==t.indexOf(e),a=n.checked,s=!1;return a&&o?i.classList.add("done"):a&&!o?s=!0:!a&&o&&(i.classList.add("done"),s=!0),s}(e.dataset.id,n,i,e);a&&o.push(!0)})),o}(n,e);!function(e,n){let i=e.dataset.id,o=(0,t.$)(`.pagination [data-pagination='${+i}']`)[0];n.length?(0,t.$)(o).addClass("redShadow"):(0,t.$)(o).addClass("greenShadow")}(n,i)}))}((await(0,t.v_)("/adminsc/test/getCorrectAnswers",{})).arr);let n=(i=(0,t.$)(".redShadow").length,{questionCnt:(0,t.$)(".question").length,errorCnt:i,html:(0,t.$k)(".test-do"),testid:(0,t.$)("[data-test-id]")[0].dataset.testId,testname:(0,t.$)(".test-name")[0].innerText,user:(0,t.$)(".user-menu .fio")[0].innerText});var i;await(0,t.v_)("/adminsc/testresult/create",n)&&(e.href=location.href,e.innerText="ПРОЙТИ ТЕСТ ЗАНОВО")}(n)})));let $t=(0,t.$)(".opentest-do")[0];$t&&(function(){let e=(0,t.$)(".question")[0];e&&e.classList.add("show")}(),(0,t.$)($t).on("click",(async function(e){let{target:n}=e,i=n.dataset.id;(0,t.$)(".question.show")[0],"finish"===n.id&&async function(e){if("ПРОЙТИ ТЕСТ ЗАНОВО"===e.innerText)return void location.reload();let n=(o=function(e){let n=0;return[].forEach.call(e,(e=>{let i=e.id,o=(0,t.$)(`.question[data-id='${i}']`)[0],a=(0,t.$)(o).find(".textarea");if(!e.Openanswer)return;let s="";e.Openanswer.forEach((e=>{s+=`(${e.answer})?`})),n+=function(e,t){let n=t.innerHTML,i=new RegExp(e,"g"),o=n.match(i),a=0;return o.forEach((e=>{if(!e)return;a=1;let n=new RegExp(e,"g"),i="<span style='color:red;'>"+e+"</span>";t.innerHTML=t.innerHTML.replace(n,i)})),a}(`${s}`,a)})),n}((await(0,t.v_)("/adminsc/opentestresult/getanswers",i)).arr),(0,t.$)(".buttons")[0].remove(),{testId:+i,questionCnt:paginations.length,html:(0,t.$k)(".test"),testname:(0,t.$)(".test-name")[0].innerText,username:(0,t.$)(".user-menu .fio")[0].innerText,rightAnswers:o});var o;await(0,t.v_)("/adminsc/opentestresult/finish",n)&&(e.innerText="ПРОЙТИ ТЕСТ ЗАНОВО",e.classList.add("inactive"))}(n)})),(0,t.$)($t).on("keyup",(function(e){let{target:n}=e;if(n.classList.contains("textarea")){let e=(0,t.$)("[data-pagination].active")[0];n.innerText?e.classList.add("filled"):e.classList.remove("filled")}})));class St{constructor(e){this.pClass=e.pClass??"",this.pActiveClass=e.pActiveClass??"",this.pageClass=e.pageClass??"",this.pageActiveClass=e.pageActiveClass??"",this.prevBttnEl=e.prevBttnEl??null,this.nextBttnEl=e.nextBttnEl??null,this.paginations=(0,t.$)(this.pClass),this.activePClass=this.pClass+"."+this.pActiveClass,this.activePageClass="."+this.pageClass+"."+this.pageActiveClass,this.paginations.length&&(this.navInit(),(0,t.$)(this.pClass).on("click",this.handleClick.bind(this)),this.prevBttnEl&&((0,t.$)(this.prevBttnEl).on("click",this.handleNextPrev.bind(this)),(0,t.$)(this.nextBttnEl).on("click",this.handleNextPrev.bind(this))))}navInit(){[].map.call(this.paginations,(e=>{e.classList.remove(this.pActiveClass)})),this.paginations[0].classList.add(this.pActiveClass)}handleNextPrev(e){let{target:n}=e,i=(0,t.$)(this.activePageClass)[0],o=(0,t.$)(this.activePClass)[0],a=this.paginations.indexOf(o);n===this.prevBttnEl?function(){if(a<1)return!1;let e=this.paginations[a-1];this.togglePage(e,i),this.toggleNav(e,o)}.call(this):n===this.nextBttnEl&&function(){if(a>this.paginations.length-2)return!1;let e=this.paginations[a+1];this.togglePage(e,i),this.toggleNav(e,o)}.call(this)}toggleNav(e,t){t.classList.toggle(this.pActiveClass),e.classList.toggle(this.pActiveClass)}togglePage(e,n){let i=e.dataset.pagination;(0,t.$)(`.question[data-id='${i}']`)[0].classList.toggle(this.pageActiveClass),n.classList.toggle(this.pageActiveClass)}handleClick(e){let{target:n}=e;if(!n.dataset.pagination)return;if(n.classList.contains(this.pActiveClass))return;let i=(0,t.$)(this.activePClass)[0];i.classList.remove(this.pActiveClass),n.classList.add(this.pActiveClass);let o=i.dataset.pagination;(0,t.$)(`.${this.pageClass}[data-id="${o}"]`).removeClass(this.pageActiveClass);let a=n.dataset.pagination;(0,t.$)(`.${this.pageClass}[data-id="${a}"]`).addClass(this.pageActiveClass)}}(0,t.$)(document).ready((function(){var e;new St({pClass:"[data-pagination]",pActiveClass:"active",pageClass:"question",pageActiveClass:"show",prevBttnEl:(0,t.$)("#prev")[0],nextBttnEl:(0,t.$)("#next")[0]}),e=window.location.pathname,/\/adminsc\/settings/.test(e)||/\/adminsc\/right\/list/.test(e)||/\/adminsc\/post\/list/.test(e)||/\/adminsc\/todo\/list/.test(e)?((0,t.$)(".rights-table").on("click",(function(e){let{target:n}=e;function i(e){let n=e.dataset.id??"new",i=(0,t.$)(`[data-id='${n}']`),o={toServ:{},empty:{}};return i.map((e=>{e.classList.contains("id")?(o.id=e,o.toServ.id=e.dataset.id):e.classList.contains("name")?(o.name=e,o.toServ.name=e.innerText.trim()):e.classList.contains("description")?(o.description=e,o.toServ.description=e.innerText.trim()):e.classList.contains("save.svg")?o.save=e:e.classList.contains("del")&&(o.del=e)})),o.empty.del=o.id.previousElementSibling.cloneNode(!0),o.empty.save=o.id.previousElementSibling.previousElementSibling.cloneNode(!0),o.empty.description=o.id.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),o.empty.name=o.id.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),o.empty.id=o.id.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),o}n.closest(".del")&&function(e){let n=i(e);"new"!==n.toServ.id&&confirm("Удалить право?")&&(function(e){e.id.remove(),e.name.remove(),e.description.remove(),e.save.remove(),e.del.remove()}(n),async function(e){await(0,t.v_)("/right/delete",{id:e.toServ.id})}(n))}(n.closest(".del")),n.closest(".save")&&function(e){let n=i(e);if("new"!==n.toServ.id)!async function(e){await(0,t.v_)("/right/update",e)}(n.toServ);else{if(!n.toServ.name||!n.toServ.description)return!1;!async function(e){let n=await(0,t.v_)("/right/create",e.toServ);n.arr.id&&(function(e,t){e.empty.id.dataset.id=t,e.empty.id.innerText=t,e.empty.name.dataset.id=t,e.empty.name.innerText=e.name.innerText.trim(),e.empty.description.dataset.id=t,e.empty.description.innerText=e.description.innerText.trim(),e.empty.save.dataset.id=t,e.empty.del.dataset.id=t}(e,n.id-1),function(e){let n=(0,t.$)(".id[data-id='new']")[0];n.before(e.empty.id),n.before(e.empty.name),n.before(e.empty.description),n.before(e.empty.save),n.before(e.empty.del)}(e),function(e){e.name.innerText="",e.description.innerText=""}(e),t.gk.show("Сохранено"))}(n)}}(n.closest(".save"))})),(0,t.$)("[settings]").addClass("current")):/\/auth\/profile/.test(e)?function(){let e=(0,t.$)('[data-model="user"]')[0];function n(){let e=(0,t.$)(".right:checked"),n="";return[].map.call(e,(e=>{let t=e.previousElementSibling.innerText+",";n+=t}),n),n}function i(){const e=(0,t.$)("#conf option");for(let t of e)if(t.selected)return t.value;return"0"}e&&(0,t.$)(e).on("click",(async function(e){let{target:o}=e;if(o.closest("#save")){let e=function(e){return{id:(0,t.$)(e).find("#id").innerText,name:(0,t.$)(e).find("#name").innerText,surName:(0,t.$)(e).find("#s-name").innerText,middleName:(0,t.$)(e).find("#m-name").innerText,birthDate:(0,t.$)(e).find("#bday").innerText,phone:(0,t.$)(e).find("#phone").innerText,email:(0,t.$)(e).find("#email").innerText,hired:(0,t.$)(e).find("#hired").innerText,fired:(0,t.$)(e).find("#fired").innerText,confirm:i(),sex:void 0,rights:n()}}((0,t.$)(".user-item")[0]);await(0,t.v_)("/adminsc/user/update",e)}else if(o.classList.contains("right")){let e=(0,t.$)("input.right:checked"),n="";[].map.call(e,(function(e){let t=e.previousElementSibling.innerText;n+=t+","})),o.closest("[tab]").dataset.value=n}}))}():/\/adminsc\/crm/.test(e)?(0,t.$)("[crm]").addClass("current"):/\/adminsc\/planning/.test(e)?(0,t.$)("[plan]").addClass("current"):/\/test/.test(e)||/\/opentest/.test(e)||/\/adminsc\/opentest/.test(e)||/\/adminsc\/test/.test(e)?(0,t.$)("[test]").addClass("current"):(0,t.$)("[href='/adminsc']").addClass("current"),function(){let e=(0,t.$)("[custom-radio]");[].map.call(e,(function(e){(0,t.$)(e).on("click",(function(t){let{target:n}=t,i=n.closest("label");e.dataset.value=i.dataset.value}))}))}(),function(){const e=(0,t.$)(".custom-list__wrapper");e&&[].forEach.call(e,(function(e){const n=(0,t.$)("[contenteditable]"),i=e.querySelectorAll(".head"),o=e.querySelectorAll("[data-sort]"),a=(0,t.$)(e).findAll(".head input"),s=(0,t.$)(e)[0].querySelectorAll(".id:not(.head"),r=e.dataset.model,l=[];(0,t.$)(e).on("click",function(n){let{target:o}=n;if("add-model"===o.className)!async function(n,i){let o=await(0,t.v_)(`/adminsc/${n}/create`,{});o.arr.id&&function(n){let i=[...l[0]];[].forEach.call(i,(function(i){let o=i.cloneNode(!0);(0,t.$)(e).find(".custom-list").appendChild(o),["id"].includes(o.className)?o.innerText=n:["del","edit","save"].includes(o.className)||(o.innerText=""),o.dataset.id=n}))}(o.arr.id)}(r);else if(".del:not(.head)"===o.className||o.closest(".del:not(.head)"))!async function(e){if(!confirm("Удалить?"))return;let n=e.dataset.id;await(0,t.v_)(`/adminsc/${r}/delete`,{id:n})&&function(e){let n=(0,t.$)(`[data-id='${e}']`);[].forEach.call(n,(function(e){e.remove()}))}(n)}(o.closest(".del:not(.head)"));else if(".edit:not(.head)"===o.className||o.closest(".edit:not(.head)")){let e=o.closest(".edit:not(.head)").dataset.id;window.location=`/adminsc/${r}/edit/${e}`}else if(o.classList.contains("head")){let e=o.closest(".head");!function(e){const t=d[e]||"asc",n="asc"===t?1:-1,o=Array.from(l);o.sort((function(t,i){const o=t[e].innerHTML,a=i[e].innerHTML,s=u(e,o),r=u(e,a);switch(!0){case s>r:return 1*n;case s<r:return-1*n;case s===r:return 0}})),[].forEach.call(l,(function(e){[].forEach.call(e,(e=>{e.remove()}))})),d[e]="asc"===t?"desc":"asc",o.forEach((function(e){(e=Array.from(e)).reverse(),[].forEach.call(e,(e=>{i[i.length-1].after(e)}))}))}([].findIndex.call(i,((t,n,i)=>t===e)))}}.bind(this)),(0,t.$)(e).on("keyup",function(t){let{target:o}=t;if(o.hasAttribute("contenteditable"))c(e,n,o);else if(o.closest(".head")){let e=o.closest(".head");!function(e,t){[].forEach.call(l,(e=>{[].forEach.call(e,(e=>{e.style.display="flex"}))}));const n=t.value;[].forEach.call(a,(e=>{e!==t&&(e.value="")})),[].forEach.call(l,(function(t){const i=t[e].innerText,o=new RegExp(`${n}`,"gi");i.match(o)||[].forEach.call(t,(e=>{e.style.display="none"}))}))}([].findIndex.call(i,((t,n,i)=>t===e)),o)}}.bind(this));let c=(0,t.Ds)((function(e,n,i){if(!i.hasAttribute("contenteditable"))return!1;!async function(e){let n=`/adminsc/${e.modelName}/updateOrCreate`;await(0,t.v_)(n,e.model)}(function(e,t){let n=e.dataset.field;return{model:{id:e.dataset.id,[n]:e.innerText},modelName:t}}(i,r))}));for(let n=0;n<s.length;n++){let i=s[n].dataset.id,o=(0,t.$)(e)[0].querySelectorAll(`[data-id='${i}']`);l.push(o)}const d=Array.from(o).map((function(e){return""}));function u(e,t){return"number"===o[e].getAttribute("data-type")?parseFloat(t):t}}))}(),function(){let e=(0,t.$)("[multi-select] ");e&&[].forEach.call(e,(function(e){e.addEventListener("click",(function(e){let{target:n}=e,i=n.closest("[multi-select]");if(n.closest(".arrow")||["chip-wrap"].includes(n.className))i.querySelector("ul").classList.toggle("show");else if(["del"].includes(n.className))!function(e){(0,t.$)(i).find(`label[data-id='${e}']`).classList.remove("selected")}(n.closest(".chip").dataset.id),n.closest(".chip").remove();else if("label"===n.tagName.toLowerCase()){let e=n.dataset.id,o=i.querySelectorAll(".chip"),a=[].some.call(o,(t=>t.dataset.id===e)),s=(0,t.$)(i).find(".chip-wrap");if(a)n.classList.toggle("selected"),s.querySelector(`[data-id='${e}']`).remove();else{n.classList.toggle("selected");let t=function(e){let t=document.createElement("div");t.classList.add("chip"),t.innerText=n.innerText,t.dataset.id=e;let i=document.createElement("div");return i.classList.add("del"),i.innerText="X",t.append(i),t}(e);s.append(t)}}}),!1),e.addEventListener("blur",(function(e){let{target:n}=e,i=(0,t.$)(this).find(".show");i&&i.classList.remove("show")}),!1)}))}(),function(){let e=(0,t.$)(".item_wrap")[0];e&&(0,t.$)(e).on("click",async function(n){let{target:i}=n,o=e,a=o.dataset.model;i.closest(".save")?async function(e){if(function(){let e=(0,t.$)("[required]"),n=0;return[].forEach.call(e,(function(e){if(!e.innerText){if(e.style.borderColor="red",(0,t.$)(e).find(".error"))return;let i=document.createElement("div");i.innerText="Заполните поле",i.classList.add("error"),e.closest(".value").appendChild(i),n++}})),n}())return!1;let n=function(){let e=(0,t.$)("[data-field]"),n={};[].map.call(e,(e=>{if(e.hasAttribute("multi-select")){let t=e.querySelectorAll(".chip"),i=[].map.call(t,(e=>e.dataset.id));n[e.dataset.field]=i.toString()}else e.hasAttribute("custom-select")?n[e.dataset.field]=e.dataset.value:"inputs"===e.dataset.type?n[e.dataset.field]=function(e){let t=e.querySelectorAll("input"),n=[];return t.forEach((e=>{if(!e.checked)return;let t=e.parentNode.querySelector(".name").innerText;t&&n.push(t)})),n.join(",")}(e):e.hasAttribute("custom-radio")||e.hasAttribute("tab")?n[e.dataset.field]=e.dataset.value:"date"===e.type?n[e.dataset.field]=e.value:n[e.dataset.field]=(0,t.mN)(e.innerText)}),n);let i=(0,t.$)("[data-isTest]")[0];return i&&(n.isTest=+i.dataset.istest),n}();await(0,t.v_)(`/adminsc/${e}/updateorcreate`,n)}(a):i.closest(".del")&&i.closest(".del").dataset.model?async function(e,n){let i=e.dataset.id;await(0,t.v_)(`/adminsc/${n}/delete`,{id:i})&&(window.location.href=`/adminsc/${n}/edit`)}(o,i.closest(".del").dataset.model):i.classList.contains("tab")&&async function(e){(0,t.$)("section.show")[0].classList.toggle("show"),(0,t.$)(`section[data-id='${e.dataset.id}']`)[0].classList.toggle("show"),(0,t.$)(".tab.active")[0].classList.toggle("active"),e.classList.toggle("active")}(i)}.bind(this))}(),document.addEventListener("mouseenter",(function(e){let{target:t}=e;if(!t.dataset||!t.dataset.tooltip)return;let n=t.dataset.tooltip,i=document.createElement("div");i.className="tooltip",i.innerHTML=n,document.body.append(i);let o=t.getBoundingClientRect(),a=o.left+(t.offsetWidth-i.offsetWidth)/2;a<0&&(a=0);let s=o.top-i.offsetHeight-5;s<0&&(s=o.top+t.offsetHeight+5),i.style.left=a+"px",i.style.top=s+"px"}),!0),document.addEventListener("mouseleave",(function(){let e=document.querySelectorAll(".tooltip");e&&[].forEach.call(e,(e=>{e.remove()}))}),!0),function(){let e=(0,t.$)("[data-testid]")[0];if(e){e=+e.dataset.testid;let n=(0,t.$)(".test-edit.accordion a");Array.from(n).filter((t=>{+t.dataset.id===e&&t.classList.add("current")}))}let n=(0,t.$)(".accordion-open")[0];n&&(0,t.$)(n).on("click",(function(){(0,t.$)(".accordion_wrap")[0].classList.toggle("open")}))}(),function(){let e=(0,t.$)(".test-edit-wrapper")[0];e&&(dt(".test-edit-wrapper .questions",".questions>.question-edit","question"),(0,t.$)(e).on("keyup",yt),(0,t.$)(e).on("change",_t),(0,t.$)(e).on("click",wt))}()}))}()}();
//# sourceMappingURL=admin.js.map