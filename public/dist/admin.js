/*! For license information please see admin.js.LICENSE.txt */
!function(){"use strict";var e={317:function(e,t,n){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{$:function(){return d},$k:function(){return a},Ds:function(){return o},gk:function(){return r},mN:function(){return s},v_:function(){return l}});const o=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700;return function(){const i=()=>e.apply(this,arguments);clearTimeout(t),t=setTimeout(i,n)}};function a(e){return s(d(e)[0].outerHTML)}function s(e){return function(e){var t=new RegExp("\\t?","g");return e.replace(t,"")}(e=function(e){var t=new RegExp("\\n?","g");return e.replace(t,"")}(e=function(e){var t=new RegExp("&nbsp;?","g");return e.replace(t," ")}(e)))}let r={show:function(e,t){let n=this.el("div","popup__close");n.innerText="X";let i=this.el("div","popup__item");i.innerText=e,i.append(n);let o=d(".popup")[0];o||(o=this.el("div","popup")),o.append(i),o.addEventListener("click",this.close,!0),document.body.append(o),setTimeout((()=>{i.classList.remove("popup__item"),i.classList.add("popup-hide")}),5e3),setTimeout((()=>{i.remove(),t&&t()}),5950)},close:function(e){e.target.classList.contains("popup__close")&&this.closest(".popup").remove()},el:function(e,t){let n=document.createElement(e);return n.classList.add(t),n}};async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((async function(n,i){t.token=document.querySelector('meta[name="token"]').getAttribute("content");let o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),t instanceof FormData?o.send(t):(o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send("param="+JSON.stringify(t))),o.onerror=function(e){i(Error("Network Error"+e))},o.onload=function(){var e;let t=JSON.parse(o.response),i=d(".message")[0];var a;t.popup||null!=t&&null!==(e=t.arr)&&void 0!==e&&e.popup?r.show(t.popup??(null==t||null===(a=t.arr)||void 0===a?void 0:a.popup)):t.msg?i&&(i.innerHTML=t.msg,i.innerHTML=t.msg,d(i).removeClass("success"),d(i).removeClass("error")):t.success?i&&(i.innerHTML=t.success,d(i).addClass("success"),d(i).removeClass("error")):t.error&&i&&(i.innerHTML="",i.innerHTML=t.error,d(i).removeClass("success"),d(i).addClass("error")),n(t)}}))}class c extends Array{constructor(){super(...arguments),i(this,"value",(function(){return this[0].getAttribute("value")})),i(this,"attr",(function(e,t){return t&&this[0].setAttribute(e,t),this[0].getAttribute(e)})),i(this,"selectedIndexValue",(function(){if(this.length)return this[0].selectedOptions[0].value})),i(this,"options",(function(){if(this.length)return this[0].options})),i(this,"count",(function(){return this.length})),i(this,"text",(function(){if(this.length)return this[0].innerText})),i(this,"checked",(function(){if(this.length)return this[0].checked})),i(this,"getWithStyle",(function(e,t){let n=[];return this.forEach((i=>{i.style[e]===t&&n.push(i)})),n})),i(this,"addClass",(function(e){this.forEach((t=>{t.classList.add(e)}))})),i(this,"removeClass",(function(e){this.forEach((t=>{t.classList.remove(e)}))})),i(this,"hasClass",(function(e){if(this.classList.contains(e))return!0})),i(this,"append",(function(e){this[0].appendChild(e)})),i(this,"find",(function(e){return"string"==typeof e?this[0].querySelector(e):this[0].filter((t=>t===e))[0]})),i(this,"findAll",(function(e){if("string"==typeof e)return this[0].querySelectorAll(e)})),i(this,"css",(function(e,t){if(!t)return this[0].style[e];this.forEach((n=>{n.style[e]=t}))}))}on(e,t,n){"function"==typeof t?this.forEach((n=>n.addEventListener(e,t))):this.forEach((i=>{i.addEventListener(e,(e=>{e.target===t&&n(e)}))}))}ready(e){this.some((e=>null!=e.readyState&&"loading"!=e.readyState))?e():document.addEventListener("DOMContentLoaded",e)}}function d(e){return"string"==typeof e||e instanceof String?new c(...document.querySelectorAll(e)):new c(e)}},704:function(e,t,n){var i=n(317);const o=(0,i.$)(".custom-list__wrapper");o&&[].forEach.call(o,(function(e){const t=(0,i.$)("[contenteditable]"),n=e.querySelectorAll(".head"),o=e.querySelectorAll("[hidden]"),a=e.querySelectorAll("[data-sort]"),s=(0,i.$)(e).findAll(".head input"),r=(0,i.$)(e)[0].querySelectorAll(".id:not(.head"),l=e.dataset.model,c=e.dataset.parent??null,d=e.dataset.parentId??null,u=e.dataset.morph??null,h=e.dataset.morphid??null,p=[];(0,i.$)(e).on("click",function(t){let s=t.target;if("add-model"===s.className)!async function(t,n,a,s,r){let l={};n&&(l={[n+"_id"]:+a}),s&&(l={morph_type:s,morph_id:r});let c=await(0,i.v_)(`/adminsc/${t}/updateOrCreate`,l);c.arr.id&&function(t){let n=[...o];[].forEach.call(n,(function(n){let o=n.cloneNode(!0);o.removeAttribute("hidden"),(0,i.$)(e).find(".custom-list").appendChild(o),["id"].includes(o.dataset.field)?o.innerText=t:["del","edit","save"].includes(o.className)||(o.innerText=""),o.dataset.id=t}))}(c.arr.id)}(l,c,d,u,h);else if(".del:not(.head)"===s.className||s.closest(".del:not(.head)"))!async function(e){if(!confirm("Удалить?"))return;let t=e.dataset.id;await(0,i.v_)(`/adminsc/${l}/delete`,{id:t})&&function(e){let t=(0,i.$)(`[data-id='${e}']`);[].forEach.call(t,(function(e){e.remove()}))}(t)}(s.closest(".del:not(.head)"));else if(".edit:not(.head)"===s.className||s.closest(".edit:not(.head)"))t.preventDefault(),function(e,t){let n=e.closest(".edit:not(.head)").dataset.id;window.location=`/adminsc/${t}/edit/${n}`}(s,l);else if(s.classList.contains("head")){let e=s.closest(".head");e.hasAttribute("data-sort")&&function(e){const t=m[e]||"asc",i="asc"===t?1:-1,o=Array.from(p);o.sort((function(t,n){const o=t[e].innerHTML,a=n[e].innerHTML,s=g(e,o),r=g(e,a);switch(!0){case s>r:return 1*i;case s<r:return-1*i;case s===r:return 0}})),[].forEach.call(p,(function(e){[].forEach.call(e,(e=>{e.remove()}))})),m[e]="asc"===t?"desc":"asc",o.forEach((function(e){(e=Array.from(e)).reverse(),[].forEach.call(e,(e=>{n[n.length-1].after(e)}))}))}([].findIndex.call(a,((t,n,i)=>t===e)))}}.bind(this)),(0,i.$)(e).on("keyup",function(i){let{target:o}=i;if(o.hasAttribute("contenteditable"))f(e,t,o);else if(o.closest(".head")){let e=o.closest(".head");!function(e,t){[].forEach.call(p,(e=>{[].forEach.call(e,(e=>{e.style.display="flex"}))}));const n=t.value;[].forEach.call(s,(e=>{e!==t&&(e.value="")})),[].forEach.call(p,(function(t){const i=t[e].innerText,o=new RegExp(`${n}`,"gi");i.match(o)||[].forEach.call(t,(e=>{e.style.display="none"}))}))}([].findIndex.call(n,((t,n,i)=>t===e)),o)}}.bind(this)),(0,i.$)(e).on("paste",function(e){let t=e.clipboardData.getData("text/plain");e.target.innerText=t,v(0,0,e.target),e.target.innerText=""}.bind(this));let f=(0,i.Ds)(v);for(let t=0;t<r.length;t++){let n=r[t].dataset.id,o=(0,i.$)(e)[0].querySelectorAll(`[data-id='${n}']`);p.push(o)}const m=Array.from(a).map((function(e){return""}));function g(e,t){if(a[e])return"number"===a[e].getAttribute("data-type")?parseFloat(t):t}function v(e,t,n){if(!n.hasAttribute("contenteditable"))return!1;!async function(e){let t=`/adminsc/${e.modelName}/updateOrCreate`;await(0,i.v_)(t,e.model)}(b(n,l))}function b(t,n){let i=t.dataset.field,o=e.dataset.parent+"_id",a=e.dataset.parentid,s={model:{id:t.dataset.id,[i]:t.innerText},modelName:n};return o&&(s.model[o]=a),s}}))}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e=n(317);if((0,e.$)("[accordion]")){let n=(0,e.$)("[accordion] [type='checkbox']");n&&[...n].filter((e=>{e.checked=!1})),(0,e.$)("[accordion]").on("click",(function(n){let{target:i}=n,o=i.closest("li");if(!o)return;let a=(0,e.$)(o).find("ul");if(a)if(a.classList.contains("open"))t(a,o);else{if(!a)return;let n=o.closest("ul");!function(n){if(!n)return;let i=(0,e.$)(n).find("li>ul.open");if(i){let e=i.closest("li");t(i,e)}}(n),function(e,t,n){n&&(n.style.maxHeight=e.scrollHeight+n.scrollHeight+"px"),e.style.maxHeight=e.scrollHeight+"px",e.classList.toggle("open"),t.classList.toggle("rotate")}(a,o,n)}else!function(e){e.classList.toggle("rotate")}(o)}))}function t(e,t){e.style.maxHeight="0px",e.classList.toggle("open"),t.classList.toggle("rotate")}(0,e.$)(".admin_sidebar")[0]&&(0,e.$)("svg#burger").on("click",(function(){(0,e.$)(".admin_sidebar [accordion]")[0].classList.toggle("show")}));const i={delServer:async t=>{(0,e.$)(".opentest")[0]?await(0,e.v_)("/adminsc/opentestresult/delete",{id:t}):await(0,e.v_)("/adminsc/testresult/delete",{id:t})},delDom:t=>{[].map.call((0,e.$)(`[data-row = "${t}"]`),(function(e){e.remove()}))},delete:e=>{confirm("Удалить результат теста?")&&(i.delServer(e),i.delDom(e))}};let o=(0,e.$)(".test-results__table")[0];function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}o&&(0,e.$)(o).on("click",(function(e){let{target:t}=e;if(t.closest(".del-btn")){let e=t.closest(".del-btn").dataset.row;i.delete(e)}})),(0,e.$)(".testresult")[0]&&((0,e.$)(".accordion_wrap")[0].remove(),(0,e.$)(".page-name")[0].remove(),(0,e.$)(".test-name")[0].remove(),(0,e.$)(".test-do__finish-btn")[0].remove());const s=new class{constructor(){var t;a(this,"model","openquestion"),a(this,"questions",(0,e.$)(".questions>.question-edit")),a(this,"testId",+(null===(t=(0,e.$)(".questions")[0])||void 0===t?void 0:t.dataset.testId)??null),a(this,"questionCnt",(0,e.$)(".questions>.question-edit").length??null)}async create(t){let n=this.testId,i=this.questionCnt+1,o=await(0,e.v_)(`/adminsc/${this.model}/updateOrCreate`,{id:0,opentest_id:n,sort:i});if(o.arr.id){let e=this.cloneEmptyModel();e.querySelector(".sort").innerText=this.questionCnt+1,e.querySelector(".text").innerText="",e.dataset.id=o.arr.id,t.before(e)}}cloneEmptyModel(){let t=(0,e.$)(".questions .question-edit")[0];if(t){let e=t.cloneNode(!0),n=e.querySelectorAll(".row .answer");return[].forEach.call(n,(function(e){e.remove()})),e}}async sort(t){let n=this.questions.filter((function(e,n){if(n+1<t)return e})),i=n.map((e=>e.dataset.id));await(0,e.v_)(`/${this.model}/sort`,{toChange:i}),n.map(((t,n)=>{(0,e.$)(t).find(".sort").innerText=n+1}))}async changeParent(t){let n=+t.options[t.selectedIndex].value;if(!n)return;let i=t.closest(".question-edit"),o=i.dataset.id,a=t.innerText;await(0,e.v_)(`/adminsc/${this.model}/changeParent`,{id:o,test_id:n})&&(i.remove(),e.gk.show("Перемещен в "+a))}showAnswers(t){let n=t.closest(".question-edit"),i=(0,e.$)(n).find(".question__answers");i.classList.toggle("height"),i.classList.toggle("scale"),t.classList.toggle("rotate")}async del(t){if(confirm("Удалить вопрос со всеми его ответами?")){let n=t.closest(".question-edit"),i=n.dataset.id;await(0,e.v_)(`/adminsc/${this.model}/delete`,{id:i})&&n.remove()}}};function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},u.apply(this,arguments)}function h(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function p(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var f=p(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),m=p(/Edge/i),g=p(/firefox/i),v=p(/safari/i)&&!p(/chrome/i)&&!p(/android/i),b=p(/iP(ad|od|hone)/i),w=p(/chrome/i)&&p(/android/i),y={capture:!1,passive:!1};function _(e,t,n){e.addEventListener(t,n,!f&&y)}function E(e,t,n){e.removeEventListener(t,n,!f&&y)}function $(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function S(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function T(e,t,n,i){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&$(e,t):$(e,t))||i&&e===n)return e;if(e===n)break}while(e=S(e))}return null}var x,C=/\s+/g;function L(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(C," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(C," ")}}function D(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function A(e,t){var n="";if("string"==typeof e)n=e;else do{var i=D(e,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function q(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function O(){return document.scrollingElement||document.documentElement}function k(e,t,n,i,o){if(e.getBoundingClientRect||e===window){var a,s,r,l,c,d,u;if(e!==window&&e.parentNode&&e!==O()?(s=(a=e.getBoundingClientRect()).top,r=a.left,l=a.bottom,c=a.right,d=a.height,u=a.width):(s=0,r=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!f))do{if(o&&o.getBoundingClientRect&&("none"!==D(o,"transform")||n&&"static"!==D(o,"position"))){var h=o.getBoundingClientRect();s-=h.top+parseInt(D(o,"border-top-width")),r-=h.left+parseInt(D(o,"border-left-width")),l=s+a.height,c=r+a.width;break}}while(o=o.parentNode);if(i&&e!==window){var p=A(o||e),m=p&&p.a,g=p&&p.d;p&&(l=(s/=g)+(d/=g),c=(r/=m)+(u/=m))}return{top:s,left:r,bottom:l,right:c,width:u,height:d}}}function N(e,t,n){for(var i=H(e,!0),o=k(e)[t];i;){var a=k(i)[n];if(!("top"===n||"left"===n?o>=a:o<=a))return i;if(i===O())break;i=H(i,!1)}return!1}function M(e,t,n,i){for(var o=0,a=0,s=e.children;a<s.length;){if("none"!==s[a].style.display&&s[a]!==Be.ghost&&(i||s[a]!==Be.dragged)&&T(s[a],n.draggable,e,!1)){if(o===t)return s[a];o++}a++}return null}function I(e,t){for(var n=e.lastElementChild;n&&(n===Be.ghost||"none"===D(n,"display")||t&&!$(n,t));)n=n.previousElementSibling;return n||null}function P(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Be.clone||t&&!$(e,t)||n++;return n}function R(e){var t=0,n=0,i=O();if(e)do{var o=A(e),a=o.a,s=o.d;t+=e.scrollLeft*a,n+=e.scrollTop*s}while(e!==i&&(e=e.parentNode));return[t,n]}function H(e,t){if(!e||!e.getBoundingClientRect)return O();var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=D(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return O();if(i||t)return n;i=!0}}}while(n=n.parentNode);return O()}function X(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function B(e,t){return function(){if(!x){var n=arguments,i=this;1===n.length?e.call(i,n[0]):e.apply(i,n),x=setTimeout((function(){x=void 0}),t)}}}function Y(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function F(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var j="Sortable"+(new Date).getTime();var W=[],z={initializeByDefault:!0},V={mount:function(e){for(var t in z)z.hasOwnProperty(t)&&!(t in e)&&(e[t]=z[t]);W.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),W.push(e)},pluginEvent:function(e,t,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var o=e+"Global";W.forEach((function(i){t[i.pluginName]&&(t[i.pluginName][o]&&t[i.pluginName][o](l({sortable:t},n)),t.options[i.pluginName]&&t[i.pluginName][e]&&t[i.pluginName][e](l({sortable:t},n)))}))},initializePlugins:function(e,t,n,i){for(var o in W.forEach((function(i){var o=i.pluginName;if(e.options[o]||i.initializeByDefault){var a=new i(e,t,e.options);a.sortable=e,a.options=e.options,e[o]=a,u(n,a.defaults)}})),e.options)if(e.options.hasOwnProperty(o)){var a=this.modifyOption(e,o,e.options[o]);void 0!==a&&(e.options[o]=a)}},getEventProperties:function(e,t){var n={};return W.forEach((function(i){"function"==typeof i.eventProperties&&u(n,i.eventProperties.call(t[i.pluginName],e))})),n},modifyOption:function(e,t,n){var i;return W.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(i=o.optionListeners[t].call(e[o.pluginName],n))})),i}};var G=["evt"],U=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.evt,o=h(n,G);V.pluginEvent.bind(Be)(e,t,l({dragEl:J,parentEl:Z,ghostEl:K,rootEl:ee,nextEl:te,lastDownEl:ne,cloneEl:ie,cloneHidden:oe,dragStarted:ve,putSortable:de,activeSortable:Be.active,originalEvent:i,oldIndex:ae,oldDraggableIndex:re,newIndex:se,newDraggableIndex:le,hideGhostForTarget:Pe,unhideGhostForTarget:Re,cloneNowHidden:function(){oe=!0},cloneNowShown:function(){oe=!1},dispatchSortableEvent:function(e){Q({sortable:t,name:e,originalEvent:i})}},o))};function Q(e){!function(e){var t=e.sortable,n=e.rootEl,i=e.name,o=e.targetEl,a=e.cloneEl,s=e.toEl,r=e.fromEl,c=e.oldIndex,d=e.newIndex,u=e.oldDraggableIndex,h=e.newDraggableIndex,p=e.originalEvent,g=e.putSortable,v=e.extraEventProperties;if(t=t||n&&n[j]){var b,w=t.options,y="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||f||m?(b=document.createEvent("Event")).initEvent(i,!0,!0):b=new CustomEvent(i,{bubbles:!0,cancelable:!0}),b.to=s||n,b.from=r||n,b.item=o||n,b.clone=a,b.oldIndex=c,b.newIndex=d,b.oldDraggableIndex=u,b.newDraggableIndex=h,b.originalEvent=p,b.pullMode=g?g.lastPutMode:void 0;var _=l(l({},v),V.getEventProperties(i,t));for(var E in _)b[E]=_[E];n&&n.dispatchEvent(b),w[y]&&w[y].call(t,b)}}(l({putSortable:de,cloneEl:ie,targetEl:J,rootEl:ee,oldIndex:ae,oldDraggableIndex:re,newIndex:se,newDraggableIndex:le},e))}var J,Z,K,ee,te,ne,ie,oe,ae,se,re,le,ce,de,ue,he,pe,fe,me,ge,ve,be,we,ye,_e,Ee=!1,$e=!1,Se=[],Te=!1,xe=!1,Ce=[],Le=!1,De=[],Ae="undefined"!=typeof document,qe=b,Oe=m||f?"cssFloat":"float",ke=Ae&&!w&&!b&&"draggable"in document.createElement("div"),Ne=function(){if(Ae){if(f)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Me=function(e,t){var n=D(e),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=M(e,0,t),a=M(e,1,t),s=o&&D(o),r=a&&D(a),l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+k(o).width,c=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+k(a).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&s.float&&"none"!==s.float){var d="left"===s.float?"left":"right";return!a||"both"!==r.clear&&r.clear!==d?"horizontal":"vertical"}return o&&("block"===s.display||"flex"===s.display||"table"===s.display||"grid"===s.display||l>=i&&"none"===n[Oe]||a&&"none"===n[Oe]&&l+c>i)?"vertical":"horizontal"},Ie=function(e){function t(e,n){return function(i,o,a,s){var r=i.options.group.name&&o.options.group.name&&i.options.group.name===o.options.group.name;if(null==e&&(n||r))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(i,o,a,s),n)(i,o,a,s);var l=(n?i:o).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},i=e.group;i&&"object"==c(i)||(i={name:i}),n.name=i.name,n.checkPull=t(i.pull,!0),n.checkPut=t(i.put),n.revertClone=i.revertClone,e.group=n},Pe=function(){!Ne&&K&&D(K,"display","none")},Re=function(){!Ne&&K&&D(K,"display","")};Ae&&!w&&document.addEventListener("click",(function(e){if($e)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),$e=!1,!1}),!0);var He=function(e){if(J){e=e.touches?e.touches[0]:e;var t=(o=e.clientX,a=e.clientY,Se.some((function(e){var t=e[j].options.emptyInsertThreshold;if(t&&!I(e)){var n=k(e),i=o>=n.left-t&&o<=n.right+t,r=a>=n.top-t&&a<=n.bottom+t;return i&&r?s=e:void 0}})),s);if(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[j]._onDragOver(n)}}var o,a,s},Xe=function(e){J&&J.parentNode[j]._isOutsideThisEl(e.target)};function Be(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=u({},t),e[j]=this;var n,i,o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Me(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Be.supportPointer&&"PointerEvent"in window&&!v,emptyInsertThreshold:5};for(var a in V.initializePlugins(this,e,o),o)!(a in t)&&(t[a]=o[a]);for(var s in Ie(t),this)"_"===s.charAt(0)&&"function"==typeof this[s]&&(this[s]=this[s].bind(this));this.nativeDraggable=!t.forceFallback&&ke,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?_(e,"pointerdown",this._onTapStart):(_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Se.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),u(this,(i=[],{captureAnimationState:function(){i=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(e){if("none"!==D(e,"display")&&e!==Be.ghost){i.push({target:e,rect:k(e)});var t=l({},i[i.length-1].rect);if(e.thisAnimationDuration){var n=A(e,!0);n&&(t.top-=n.f,t.left-=n.e)}e.fromRect=t}}))},addAnimationState:function(e){i.push(e)},removeAnimationState:function(e){i.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n);return-1}(i,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(n),void("function"==typeof e&&e());var o=!1,a=0;i.forEach((function(e){var n=0,i=e.target,s=i.fromRect,r=k(i),l=i.prevFromRect,c=i.prevToRect,d=e.rect,u=A(i,!0);u&&(r.top-=u.f,r.left-=u.e),i.toRect=r,i.thisAnimationDuration&&X(l,r)&&!X(s,r)&&(d.top-r.top)/(d.left-r.left)==(s.top-r.top)/(s.left-r.left)&&(n=function(e,t,n,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*i.animation}(d,l,c,t.options)),X(r,s)||(i.prevFromRect=s,i.prevToRect=r,n||(n=t.options.animation),t.animate(i,d,r,n)),n&&(o=!0,a=Math.max(a,n),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),n),i.thisAnimationDuration=n)})),clearTimeout(n),o?n=setTimeout((function(){"function"==typeof e&&e()}),a):"function"==typeof e&&e(),i=[]},animate:function(e,t,n,i){if(i){D(e,"transition",""),D(e,"transform","");var o=A(this.el),a=o&&o.a,s=o&&o.d,r=(t.left-n.left)/(a||1),l=(t.top-n.top)/(s||1);e.animatingX=!!r,e.animatingY=!!l,D(e,"transform","translate3d("+r+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),D(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),D(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){D(e,"transition",""),D(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),i)}}}))}function Ye(e,t,n,i,o,a,s,r){var l,c,d=e[j],u=d.options.onMove;return!window.CustomEvent||f||m?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=i,l.related=o||t,l.relatedRect=a||k(t),l.willInsertAfter=r,l.originalEvent=s,e.dispatchEvent(l),u&&(c=u.call(d,l,s)),c}function Fe(e){e.draggable=!1}function je(){Le=!1}function We(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function ze(e){return setTimeout(e,0)}function Ve(e){return clearTimeout(e)}Be.prototype={constructor:Be,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(be=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,J):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,i=this.options,o=i.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,r=(s||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||r,c=i.filter;if(function(e){De.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&De.push(i)}}(n),!J&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||i.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!v||!r||"SELECT"!==r.tagName.toUpperCase())&&!((r=T(r,i.draggable,n,!1))&&r.animated||ne===r)){if(ae=P(r),re=P(r,i.draggable),"function"==typeof c){if(c.call(this,e,r,this))return Q({sortable:t,rootEl:l,name:"filter",targetEl:r,toEl:n,fromEl:n}),U("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(i){if(i=T(l,i.trim(),n,!1))return Q({sortable:t,rootEl:i,name:"filter",targetEl:r,fromEl:n,toEl:n}),U("filter",t,{evt:e}),!0}))))return void(o&&e.cancelable&&e.preventDefault());i.handle&&!T(l,i.handle,n,!1)||this._prepareDragStart(e,s,r)}}},_prepareDragStart:function(e,t,n){var i,o=this,a=o.el,s=o.options,r=a.ownerDocument;if(n&&!J&&n.parentNode===a){var l=k(n);if(ee=a,Z=(J=n).parentNode,te=J.nextSibling,ne=n,ce=s.group,Be.dragged=J,ue={target:J,clientX:(t||e).clientX,clientY:(t||e).clientY},me=ue.clientX-l.left,ge=ue.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,J.style["will-change"]="all",i=function(){U("delayEnded",o,{evt:e}),Be.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!g&&o.nativeDraggable&&(J.draggable=!0),o._triggerDragStart(e,t),Q({sortable:o,name:"choose",originalEvent:e}),L(J,s.chosenClass,!0))},s.ignore.split(",").forEach((function(e){q(J,e.trim(),Fe)})),_(r,"dragover",He),_(r,"mousemove",He),_(r,"touchmove",He),_(r,"mouseup",o._onDrop),_(r,"touchend",o._onDrop),_(r,"touchcancel",o._onDrop),g&&this.nativeDraggable&&(this.options.touchStartThreshold=4,J.draggable=!0),U("delayStart",this,{evt:e}),!s.delay||s.delayOnTouchOnly&&!t||this.nativeDraggable&&(m||f))i();else{if(Be.eventCanceled)return void this._onDrop();_(r,"mouseup",o._disableDelayedDrag),_(r,"touchend",o._disableDelayedDrag),_(r,"touchcancel",o._disableDelayedDrag),_(r,"mousemove",o._delayedDragTouchMoveHandler),_(r,"touchmove",o._delayedDragTouchMoveHandler),s.supportPointer&&_(r,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(i,s.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){J&&Fe(J),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;E(e,"mouseup",this._disableDelayedDrag),E(e,"touchend",this._disableDelayedDrag),E(e,"touchcancel",this._disableDelayedDrag),E(e,"mousemove",this._delayedDragTouchMoveHandler),E(e,"touchmove",this._delayedDragTouchMoveHandler),E(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?_(document,"pointermove",this._onTouchMove):_(document,t?"touchmove":"mousemove",this._onTouchMove):(_(J,"dragend",this),_(ee,"dragstart",this._onDragStart));try{document.selection?ze((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(Ee=!1,ee&&J){U("dragStarted",this,{evt:t}),this.nativeDraggable&&_(document,"dragover",Xe);var n=this.options;!e&&L(J,n.dragClass,!1),L(J,n.ghostClass,!0),Be.active=this,e&&this._appendGhost(),Q({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(he){this._lastX=he.clientX,this._lastY=he.clientY,Pe();for(var e=document.elementFromPoint(he.clientX,he.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(he.clientX,he.clientY))!==t;)t=e;if(J.parentNode[j]._isOutsideThisEl(e),t)do{if(t[j]&&t[j]._onDragOver({clientX:he.clientX,clientY:he.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);Re()}},_onTouchMove:function(e){if(ue){var t=this.options,n=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,a=K&&A(K,!0),s=K&&a&&a.a,r=K&&a&&a.d,l=qe&&_e&&R(_e),c=(o.clientX-ue.clientX+i.x)/(s||1)+(l?l[0]-Ce[0]:0)/(s||1),d=(o.clientY-ue.clientY+i.y)/(r||1)+(l?l[1]-Ce[1]:0)/(r||1);if(!Be.active&&!Ee){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(K){a?(a.e+=c-(pe||0),a.f+=d-(fe||0)):a={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");D(K,"webkitTransform",u),D(K,"mozTransform",u),D(K,"msTransform",u),D(K,"transform",u),pe=c,fe=d,he=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!K){var e=this.options.fallbackOnBody?document.body:ee,t=k(J,!0,qe,!0,e),n=this.options;if(qe){for(_e=e;"static"===D(_e,"position")&&"none"===D(_e,"transform")&&_e!==document;)_e=_e.parentNode;_e!==document.body&&_e!==document.documentElement?(_e===document&&(_e=O()),t.top+=_e.scrollTop,t.left+=_e.scrollLeft):_e=O(),Ce=R(_e)}L(K=J.cloneNode(!0),n.ghostClass,!1),L(K,n.fallbackClass,!0),L(K,n.dragClass,!0),D(K,"transition",""),D(K,"transform",""),D(K,"box-sizing","border-box"),D(K,"margin",0),D(K,"top",t.top),D(K,"left",t.left),D(K,"width",t.width),D(K,"height",t.height),D(K,"opacity","0.8"),D(K,"position",qe?"absolute":"fixed"),D(K,"zIndex","100000"),D(K,"pointerEvents","none"),Be.ghost=K,e.appendChild(K),D(K,"transform-origin",me/parseInt(K.style.width)*100+"% "+ge/parseInt(K.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,i=e.dataTransfer,o=n.options;U("dragStart",this,{evt:e}),Be.eventCanceled?this._onDrop():(U("setupClone",this),Be.eventCanceled||((ie=F(J)).removeAttribute("id"),ie.draggable=!1,ie.style["will-change"]="",this._hideClone(),L(ie,this.options.chosenClass,!1),Be.clone=ie),n.cloneId=ze((function(){U("clone",n),Be.eventCanceled||(n.options.removeCloneOnHide||ee.insertBefore(ie,J),n._hideClone(),Q({sortable:n,name:"clone"}))})),!t&&L(J,o.dragClass,!0),t?($e=!0,n._loopId=setInterval(n._emulateDragOver,50)):(E(document,"mouseup",n._onDrop),E(document,"touchend",n._onDrop),E(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(n,i,J)),_(document,"drop",n),D(J,"transform","translateZ(0)")),Ee=!0,n._dragStartId=ze(n._dragStarted.bind(n,t,e)),_(document,"selectstart",n),ve=!0,v&&D(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,i,o,a=this.el,s=e.target,r=this.options,c=r.group,d=Be.active,u=ce===c,h=r.sort,p=de||d,f=this,m=!1;if(!Le){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=T(s,r.draggable,a,!0),R("dragOver"),Be.eventCanceled)return m;if(J.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||f._ignoreWhileAnimating===s)return X(!1);if($e=!1,d&&!r.disabled&&(u?h||(i=Z!==ee):de===this||(this.lastPutMode=ce.checkPull(this,d,J,e))&&c.checkPut(this,d,J,e))){if(o="vertical"===this._getDirection(e,s),t=k(J),R("dragOverValid"),Be.eventCanceled)return m;if(i)return Z=ee,H(),this._hideClone(),R("revert"),Be.eventCanceled||(te?ee.insertBefore(J,te):ee.appendChild(J)),X(!0);var g=I(a,r.draggable);if(!g||function(e,t,n){var i=k(I(n.el,n.options.draggable));return t?e.clientX>i.right+10||e.clientX<=i.right&&e.clientY>i.bottom&&e.clientX>=i.left:e.clientX>i.right&&e.clientY>i.top||e.clientX<=i.right&&e.clientY>i.bottom+10}(e,o,this)&&!g.animated){if(g===J)return X(!1);if(g&&a===e.target&&(s=g),s&&(n=k(s)),!1!==Ye(ee,a,J,t,s,n,e,!!s))return H(),g&&g.nextSibling?a.insertBefore(J,g.nextSibling):a.appendChild(J),Z=a,B(),X(!0)}else if(g&&function(e,t,n){var i=k(M(n.el,0,n.options,!0));return t?e.clientX<i.left-10||e.clientY<i.top&&e.clientX<i.right:e.clientY<i.top-10||e.clientY<i.bottom&&e.clientX<i.left}(e,o,this)){var v=M(a,0,r,!0);if(v===J)return X(!1);if(n=k(s=v),!1!==Ye(ee,a,J,t,s,n,e,!1))return H(),a.insertBefore(J,v),Z=a,B(),X(!0)}else if(s.parentNode===a){n=k(s);var b,w,y,_=J.parentNode!==a,E=!function(e,t,n){var i=n?e.left:e.top,o=n?e.right:e.bottom,a=n?e.width:e.height,s=n?t.left:t.top,r=n?t.right:t.bottom,l=n?t.width:t.height;return i===s||o===r||i+a/2===s+l/2}(J.animated&&J.toRect||t,s.animated&&s.toRect||n,o),$=o?"top":"left",S=N(s,"top","top")||N(J,"top","top"),x=S?S.scrollTop:void 0;if(be!==s&&(w=n[$],Te=!1,xe=!E&&r.invertSwap||_),b=function(e,t,n,i,o,a,s,r){var l=i?e.clientY:e.clientX,c=i?n.height:n.width,d=i?n.top:n.left,u=i?n.bottom:n.right,h=!1;if(!s)if(r&&ye<c*o){if(!Te&&(1===we?l>d+c*a/2:l<u-c*a/2)&&(Te=!0),Te)h=!0;else if(1===we?l<d+ye:l>u-ye)return-we}else if(l>d+c*(1-o)/2&&l<u-c*(1-o)/2)return function(e){return P(J)<P(e)?1:-1}(t);return(h=h||s)&&(l<d+c*a/2||l>u-c*a/2)?l>d+c/2?1:-1:0}(e,s,n,o,E?1:r.swapThreshold,null==r.invertedSwapThreshold?r.swapThreshold:r.invertedSwapThreshold,xe,be===s),0!==b){var C=P(J);do{C-=b,y=Z.children[C]}while(y&&("none"===D(y,"display")||y===K))}if(0===b||y===s)return X(!1);be=s,we=b;var A=s.nextElementSibling,q=!1,O=Ye(ee,a,J,t,s,n,e,q=1===b);if(!1!==O)return 1!==O&&-1!==O||(q=1===O),Le=!0,setTimeout(je,30),H(),q&&!A?a.appendChild(J):s.parentNode.insertBefore(J,q?A:s),S&&Y(S,0,x-S.scrollTop),Z=J.parentNode,void 0===w||xe||(ye=Math.abs(w-k(s)[$])),B(),X(!0)}if(a.contains(J))return X(!1)}return!1}function R(r,c){U(r,f,l({evt:e,isOwner:u,axis:o?"vertical":"horizontal",revert:i,dragRect:t,targetRect:n,canSort:h,fromSortable:p,target:s,completed:X,onMove:function(n,i){return Ye(ee,a,J,t,n,k(n),e,i)},changed:B},c))}function H(){R("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function X(t){return R("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(f),f!==p&&(L(J,de?de.options.ghostClass:d.options.ghostClass,!1),L(J,r.ghostClass,!0)),de!==f&&f!==Be.active?de=f:f===Be.active&&de&&(de=null),p===f&&(f._ignoreWhileAnimating=s),f.animateAll((function(){R("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(s===J&&!J.animated||s===a&&!s.animated)&&(be=null),r.dragoverBubble||e.rootEl||s===document||(J.parentNode[j]._isOutsideThisEl(e.target),!t&&He(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function B(){se=P(J),le=P(J,r.draggable),Q({sortable:f,name:"change",toEl:a,newIndex:se,newDraggableIndex:le,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){E(document,"mousemove",this._onTouchMove),E(document,"touchmove",this._onTouchMove),E(document,"pointermove",this._onTouchMove),E(document,"dragover",He),E(document,"mousemove",He),E(document,"touchmove",He)},_offUpEvents:function(){var e=this.el.ownerDocument;E(e,"mouseup",this._onDrop),E(e,"touchend",this._onDrop),E(e,"pointerup",this._onDrop),E(e,"touchcancel",this._onDrop),E(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;se=P(J),le=P(J,n.draggable),U("drop",this,{evt:e}),Z=J&&J.parentNode,se=P(J),le=P(J,n.draggable),Be.eventCanceled||(Ee=!1,xe=!1,Te=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ve(this.cloneId),Ve(this._dragStartId),this.nativeDraggable&&(E(document,"drop",this),E(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),v&&D(document.body,"user-select",""),D(J,"transform",""),e&&(ve&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),K&&K.parentNode&&K.parentNode.removeChild(K),(ee===Z||de&&"clone"!==de.lastPutMode)&&ie&&ie.parentNode&&ie.parentNode.removeChild(ie),J&&(this.nativeDraggable&&E(J,"dragend",this),Fe(J),J.style["will-change"]="",ve&&!Ee&&L(J,de?de.options.ghostClass:this.options.ghostClass,!1),L(J,this.options.chosenClass,!1),Q({sortable:this,name:"unchoose",toEl:Z,newIndex:null,newDraggableIndex:null,originalEvent:e}),ee!==Z?(se>=0&&(Q({rootEl:Z,name:"add",toEl:Z,fromEl:ee,originalEvent:e}),Q({sortable:this,name:"remove",toEl:Z,originalEvent:e}),Q({rootEl:Z,name:"sort",toEl:Z,fromEl:ee,originalEvent:e}),Q({sortable:this,name:"sort",toEl:Z,originalEvent:e})),de&&de.save()):se!==ae&&se>=0&&(Q({sortable:this,name:"update",toEl:Z,originalEvent:e}),Q({sortable:this,name:"sort",toEl:Z,originalEvent:e})),Be.active&&(null!=se&&-1!==se||(se=ae,le=re),Q({sortable:this,name:"end",toEl:Z,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){U("nulling",this),ee=J=Z=K=te=ie=ne=oe=ue=he=ve=se=le=ae=re=be=we=de=ce=Be.dragged=Be.ghost=Be.clone=Be.active=null,De.forEach((function(e){e.checked=!0})),De.length=pe=fe=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":J&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,i=0,o=n.length,a=this.options;i<o;i++)T(e=n[i],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||We(e));return t},sort:function(e,t){var n={},i=this.el;this.toArray().forEach((function(e,t){var o=i.children[t];T(o,this.options.draggable,i,!1)&&(n[e]=o)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return T(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var i=V.modifyOption(this,e,t);n[e]=void 0!==i?i:t,"group"===e&&Ie(n)},destroy:function(){U("destroy",this);var e=this.el;e[j]=null,E(e,"mousedown",this._onTapStart),E(e,"touchstart",this._onTapStart),E(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(E(e,"dragover",this),E(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Se.splice(Se.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!oe){if(U("hideClone",this),Be.eventCanceled)return;D(ie,"display","none"),this.options.removeCloneOnHide&&ie.parentNode&&ie.parentNode.removeChild(ie),oe=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(oe){if(U("showClone",this),Be.eventCanceled)return;J.parentNode!=ee||this.options.group.revertClone?te?ee.insertBefore(ie,te):ee.appendChild(ie):ee.insertBefore(ie,J),this.options.group.revertClone&&this.animate(J,ie),D(ie,"display",""),oe=!1}}else this._hideClone()}},Ae&&_(document,"touchmove",(function(e){(Be.active||Ee)&&e.cancelable&&e.preventDefault()})),Be.utils={on:_,off:E,css:D,find:q,is:function(e,t){return!!T(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:B,closest:T,toggleClass:L,clone:F,index:P,nextTick:ze,cancelNextTick:Ve,detectDirection:Me,getChild:M},Be.get=function(e){return e[j]},Be.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Be.utils=l(l({},Be.utils),e.utils)),V.mount(e)}))},Be.create=function(e,t){return new Be(e,t)},Be.version="1.15.0";var Ge,Ue,Qe,Je,Ze,Ke,et=[],tt=!1;function nt(){et.forEach((function(e){clearInterval(e.pid)})),et=[]}function it(){clearInterval(Ke)}var ot=B((function(e,t,n,i){if(t.scroll){var o,a=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,r=t.scrollSensitivity,l=t.scrollSpeed,c=O(),d=!1;Ue!==n&&(Ue=n,nt(),Ge=t.scroll,o=t.scrollFn,!0===Ge&&(Ge=H(n,!0)));var u=0,h=Ge;do{var p=h,f=k(p),m=f.top,g=f.bottom,v=f.left,b=f.right,w=f.width,y=f.height,_=void 0,E=void 0,$=p.scrollWidth,S=p.scrollHeight,T=D(p),x=p.scrollLeft,C=p.scrollTop;p===c?(_=w<$&&("auto"===T.overflowX||"scroll"===T.overflowX||"visible"===T.overflowX),E=y<S&&("auto"===T.overflowY||"scroll"===T.overflowY||"visible"===T.overflowY)):(_=w<$&&("auto"===T.overflowX||"scroll"===T.overflowX),E=y<S&&("auto"===T.overflowY||"scroll"===T.overflowY));var L=_&&(Math.abs(b-a)<=r&&x+w<$)-(Math.abs(v-a)<=r&&!!x),A=E&&(Math.abs(g-s)<=r&&C+y<S)-(Math.abs(m-s)<=r&&!!C);if(!et[u])for(var q=0;q<=u;q++)et[q]||(et[q]={});et[u].vx==L&&et[u].vy==A&&et[u].el===p||(et[u].el=p,et[u].vx=L,et[u].vy=A,clearInterval(et[u].pid),0==L&&0==A||(d=!0,et[u].pid=setInterval(function(){i&&0===this.layer&&Be.active._onTouchMove(Ze);var t=et[this.layer].vy?et[this.layer].vy*l:0,n=et[this.layer].vx?et[this.layer].vx*l:0;"function"==typeof o&&"continue"!==o.call(Be.dragged.parentNode[j],n,t,e,Ze,et[this.layer].el)||Y(et[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=H(h,!1)));tt=d}}),30),at=function(e){var t=e.originalEvent,n=e.putSortable,i=e.dragEl,o=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,r=e.unhideGhostForTarget;if(t){var l=n||o;s();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);r(),l&&!l.el.contains(d)&&(a("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function st(){}function rt(){}st.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=M(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:at},u(st,{pluginName:"revertOnSpill"}),rt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:at},u(rt,{pluginName:"removeOnSpill"}),Be.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):this.options.supportPointer?_(document,"pointermove",this._handleFallbackAutoScroll):t.touches?_(document,"touchmove",this._handleFallbackAutoScroll):_(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?E(document,"dragover",this._handleAutoScroll):(E(document,"pointermove",this._handleFallbackAutoScroll),E(document,"touchmove",this._handleFallbackAutoScroll),E(document,"mousemove",this._handleFallbackAutoScroll)),it(),nt(),clearTimeout(x),x=void 0},nulling:function(){Ze=Ue=Ge=tt=Ke=Qe=Je=null,et.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,i=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(i,o);if(Ze=e,t||this.options.forceAutoScrollFallback||m||f||v){ot(e,this.options,a,t);var s=H(a,!0);!tt||Ke&&i===Qe&&o===Je||(Ke&&it(),Ke=setInterval((function(){var a=H(document.elementFromPoint(i,o),!0);a!==s&&(s=a,nt()),ot(e,n.options,a,t)}),10),Qe=i,Je=o)}else{if(!this.options.bubbleScroll||H(a,!0)===O())return void nt();ot(e,this.options,H(a,!1),!1)}}},u(e,{pluginName:"scroll",initializeByDefault:!0})}),Be.mount(rt,st);var lt=Be;function ct(t,n,i){let o=(0,e.$)(t)[0];o&&lt.create(o,{animation:150,onEnd:function(t){let o=t.oldIndex,a=t.newIndex;!async function(t){let o=(0,e.$)(n),a=[].map.call(o,(function(e,n){if(n-1<t)return e})),s=a.map((e=>e.dataset.id));await(0,e.v_)(`/adminsc/${i}/sort`,{toChange:s}),a.map(((t,n)=>{(0,e.$)(t).find(".sort").innerText=n+1}))}(o>a?o:a)}})}class dt{constructor(){this.model="opentest"}async create(){let t=dt.serverModel();t.id=0,t.isTest=1;let n=`/${this.model}/updateOrCreate`,i=await(0,e.v_)(n,t);i&&(window.location.href=`/adminsc/${model}/edit/${i.id}`)}id(){return id??(0,e.$)(".test-name")[0].dataset.testid}children(){return(0,e.$)(".children").length||!1}async path_create(){let t=dt.serverModel();t.id=0,t.isTest=0;let n=`/adminsc/${model}/create`,i=await(0,e.v_)(n,t);i&&(window.location.href=`/adminsc/${model}/edit/${i.id-1}`)}name(){return(0,e.$)(".test-name")[0].innerText}async update(){let t=dt.serverModel(),n=`/adminsc/${t}/update/${t.id}`;await(0,e.v_)(n,t)&&(window.location.href=`/adminsc/${t}/edit/${t.id}`)}async del(){if(dt.children())return e.gk.show("Сначала удалите все тесты из папки"),!1;let t=dt.id();(await(0,e.v_)("/adminsc/${model}/delete",{id:t})).notAdmin?(e.gk.show("Видимость теста скрыта. Чтобы удалить полностью - обратитесь к ГД"),setTimeout((()=>{window.location=`/adminsc/${model}/edit/400`}),4e3)):window.location=`/adminsc/${model}/edit/400`}}let ut={async create(t){let n=t.closest(".question-edit"),i=n.dataset.id,o=n.querySelectorAll(".answer").length+1,a=(await(0,e.v_)("/adminsc/openanswer/updateOrCreate",{openquestion_id:i,sort:o})).arr.html;a?t.insertAdjacentHTML("beforebegin",a):e.gk.show("Сохранено")},async del(t){let n=t.closest(".delete");if(!n)return!1;if(confirm("Удалить этот ответ?")){let t=n.closest(".answer"),i=+t.dataset.answerId;await(0,e.v_)("/adminsc/openanswer/delete",{id:i})&&t.remove()}}};class ht{constructor(e){return!!e&&!e.multiple&&(this.title=e.title??"",this.field=e.dataset.field,this.model=e.dataset.model,this.options=(t=e.querySelectorAll("option"),[...t].map((e=>({value:e.value,label:e.label,selected:e.selected,element:e})))),this.sel=document.createElement("div"),e.className&&this.sel.classList.add(e.className),this.label=document.createElement("span"),this.arrow=document.createElement("div"),this.space=document.createElement("div"),this.ul=document.createElement("ul"),function(e){let t;e.title&&(e.titleElement=document.createElement("div"),e.titleElement.classList.add("title"),e.titleElement.innerText=e.title,e.sel.append(e.titleElement)),e.sel.setAttribute("custom-select",""),e.field&&(e.sel.dataset.field=e.field,e.sel.dataset.model=e.model),e.sel.dataset.value=e.selectedOption.value,e.sel.tabIndex=0,e.sel.append(e.label),e.space.classList.add("space"),e.space.innerText=e.selectedOption.label,e.label.append(e.space),e.arrow.classList.add("arrow"),e.label.append(e.arrow),e.ul.classList.add("options"),e.options.forEach((t=>{!function(t){const n=document.createElement("li");n.innerText=t.label,n.dataset.value=t.value,n.classList.toggle("selected",t.selected),n.addEventListener("click",(()=>{e.selectValue(t.value),e.ul.classList.remove("show")})),e.ul.append(n)}(t)})),e.sel.append(e.ul),e.label.addEventListener("click",(()=>{e.ul.classList.toggle("show")})),e.sel.addEventListener("blur",(()=>{e.ul.classList.remove("show")}));let n="";e.sel.addEventListener("keydown",(i=>{switch(i.code){case"Space":e.ul.classList.toggle("show");break;case"ArrowUp":{const t=e.options[e.selectedOptionIndex-1];t&&e.selectValue(t.value);break}case"ArrowDown":{const t=e.options[e.selectedOptionIndex+1];t&&e.selectValue(t.value);break}case"Enter":case"Escape":e.ul.classList.remove("show");break;default:{clearTimeout(t),n+=i.key,t=setTimeout((()=>{n=""}),500);const o=e.options.find((e=>e.label.toLowerCase().startsWith(n)));o&&e.selectValue(o.value)}}}))}(this),e.after(this.sel),void e.remove());var t}get selectedOption(){return this.options.find((e=>e.selected))}get selectedOptionIndex(){return this.options.indexOf(this.selectedOption)}selectValue(e){const t=this.options.find((t=>t.value===e)),n=this.selectedOption;n.selected=!1,t.selected=!0,this.space.innerText=t.label,this.label.closest("[custom-select]").dataset.id=t.value,this.label.closest("[custom-select]").dataset.value=t.value,this.ul.querySelector(`[data-value="${n.value}"]`).classList.remove("selected");const i=this.ul.querySelector(`[data-value="${t.value}"]`);i.classList.add("selected"),i.scrollIntoView({block:"nearest"})}}let pt=(0,e.$)(".opentest-edit-wrapper")[0];if(pt){ct(".opentest-edit-wrapper .questions",".opentest-edit-wrapper .question-edit","openquestion"),new ht((0,e.$)('[data-field="enable"]')[0]),new ht((0,e.$)('[data-field="opentest_id"]')[0]),(0,e.$)(pt).on("change",(async function(e){let{target:t}=e,n=t.closest(".answer"),i=t.closest(".question-edit__parent-select");n?ft(n):i&&s.changeParent(t)})),(0,e.$)(pt).on("click",(e=>{let{target:t}=e;const n=new dt;t.classList.contains("test-path__create")?n.path_create():t.classList.contains("test__create")?n.create():t.closest(".question__show-answers")?s.showAnswers(t):t.closest(".question__delete")?s.del(t):t.classList.contains("question__create-button")?s.create(t):t.closest(".delete")?ut.del(t):t.classList.contains("answer__create-button")?ut.create(t):t.classList.contains("led")&&t.classList.toggle("animated")}));let t=async function(t){let{target:n}=t;if(n.classList.contains("text")){let t=n.closest(".answer"),i=n.closest(".question-edit");if(t)ft(t);else if(i){let t=i.dataset.id,o=n.innerText;await(0,e.v_)("/adminsc/openquestion/updateOrCreate",{id:t,question:o})}}},n=(0,e.Ds)(t);(0,e.$)(pt).on("keyup",n)}async function ft(t){let n=t.dataset.answerId,i=+t.querySelector("input").checked,o=t.closest(".question-edit").dataset.id,a=t.querySelector(".text").innerText;await(0,e.v_)("/adminsc/openanswer/updateOrCreate",{id:n,answer:a,openquestion_id:o,is_correct:i})}let mt=new class{constructor(){}async saveAnswer(t){let n=t.closest(".question-edit").dataset.id,i=t.closest(".answer"),o=this.getAnswerModel(i,n);await(0,e.v_)("/adminsc/answer/updateOrCreate",o)}async del(t){let n=t.closest(".answer"),i=+t.dataset.id;confirm("Удалить?")&&await(0,e.v_)("/adminsc/answer/delete",{id:i})&&n.remove()}async answerCreate(t){let n=(0,e.$)(".answer__create .answer")[0],i=t.closest(".question-edit"),o=+i.id,a=n.cloneNode(!0),s=this.getAnswerModel(a,o),r=await(0,e.v_)("/adminsc/answer/updateOrCreate",s);if(r&&(r.arr.popup&&e.gk.show(r.arr.popup),r.arr.id)){let e=i.querySelectorAll(".answer").length+1;a.querySelector(".sort").innerText=e,a.querySelector(".delete").dataset.id=a.dataset.id=r.arr.id,t.before(a)}}getAnswerModel(t,n){return{id:+t.dataset.id,answer:(0,e.mN)((0,e.$)(t).find(".text").innerText),question_id:n,correct_answer:+(0,e.$)(t).find("input").checked,pica:""}}},gt=new class{constructor(e){this.sort=document.querySelectorAll(".questions>.question-edit").length+1??0}async questionCreate(t){let n=(0,e.$)(".question__create .question-edit")[0].cloneNode(!0),i=this.getQuestionModel(n),o=await(0,e.v_)("/adminsc/question/updateOrCreate",i);o&&(n.querySelector(".sort").innerText=this.sort,n.querySelector(".question__delete").dataset.id=n.dataset.id=o.arr.id,t.before(n))}getQuestionModel(t){return{id:t.dataset.id,qustion:(0,e.mN)(t.querySelector(".text").innerText),parent:+window.location.href.split("/").pop(),sort:t.querySelector(".sort").innerText}}async changeParent(t){let n=t.closest(".question-edit"),i=n.dataset.id,o=t.options[t.selectedIndex].dataset.questionParentId;await(0,e.v_)("/adminsc/question/changeParent",{id:i,test_id:o})&&n.remove()}showAnswers(t){let n=t.closest(".question-edit"),i=(0,e.$)(n).find(".question__answers");i.classList.toggle("height"),i.classList.toggle("scale"),t.classList.toggle("rotate")}async del(t){let n=t.dataset.model,i=null;"answer"===n?i=t.closest(".answer"):"question"===n&&(i=t.closest(".question-edit"));let o=+t.dataset.id;confirm("Удалить?")&&await(0,e.v_)(`/adminsc/${n}/delete`,{id:o})&&i.remove()}async saveQuestion(t){let n=t.closest(".question-edit"),i=gt.getQuestionModel(n);await(0,e.v_)("/adminsc/question/UpdateOrCreate",i)}};const vt={viewModel:()=>({id:+window.location.href.split("/").pop(),name:(0,e.$)("#test_name").text(),enable:(0,e.$)("#enable")[0],parent:(0,e.$)("select").selectedIndexValue()}),children:()=>(0,e.$)(".children").length||!1,path_create:async()=>{let t=vt.serverModel();t.id=0,t.isTest=0;let n=await(0,e.v_)("/adminsc/test/updateOrCreate",t);n&&(window.location.href=`/adminsc/test/edit/${n.arr.id}`)},id:t=>t??(0,e.$)(".test-name")[0].dataset.testid,name:()=>(0,e.$)(".test-name")[0].innerText,create:async()=>{let t=vt.serverModel();t.id=0,t.isTest=1;let n=await(0,e.v_)("/test/updateOrCreate",t);n&&(window.location.href=`/adminsc/test/edit/${n.arr.id}`)},serverModel:()=>{let t=!!+window.location.href.split("/").pop();t=t||0;let n={id:t,name:(0,e.$)("#name.field")[0].value,isTest:+(0,e.$)("[isTest]")[0].getAttribute("isTest")},i=(0,e.$)("[custom-select]");return[].forEach.call(i,(function(e){n[e.dataset.field]=e.dataset.id})),n},update:async()=>{let t=vt.serverModel(),n=`/adminsc/test/update/${t.id}`;await(0,e.v_)(n,t)&&(window.location.href=`/adminsc/test/edit/${t.id}`)},delete:async function(){if(vt.children())return e.gk.show("Сначала удалите все тесты из папки"),!1;let t=vt.id();(await(0,e.v_)("/adminsc/test/delete",{id:t})).notAdmin?(e.gk.show("Видимость теста скрыта. Чтобы удалить полностью - обратитесь к ГД"),setTimeout((()=>{window.location="/adminsc/test/edit/400"}),4e3)):window.location="/adminsc/test/edit/400"}};function bt(e){let{target:t}=e;t.classList.contains("test-path__update")||t.classList.contains("test__update")||t.classList.contains("test__save")?vt.update():t.classList.contains("test__delete")?vt.delete():t.classList.contains("test-path__create")?vt.path_create():t.classList.contains("test__create")?vt.create():t.closest(".question__show-answers")?gt.showAnswers(t):t.classList.contains("question__create-button")?gt.questionCreate(t):t.closest(".question__delete")?gt.del(t):t.closest(".delete")?mt.del(t):t.classList.contains("answer__create-button")?mt.answerCreate(t):t.classList.contains("correct")&&mt.saveAnswer(t)}let wt=(0,e.Ds)((async function(e){let{target:t}=e;t.classList.contains("text")&&(t.closest(".answer")?mt.saveAnswer(t):gt.saveQuestion(t))}));async function yt(e){let{target:t}=e;t.closest(".question-edit__parent-select")&&gt.changeParent(t)}let _t=(0,e.$)(".test-do")[0];_t&&((0,e.$)(".question").removeClass("show"),(0,e.$)(".question:first-child").addClass("show"),function(){let t=(0,e.$)(".test-do__finish-btn")[0];t&&window.location.pathname.match("^/test/result/.?")&&t.classList.add("inactive")}(),_t.addEventListener("click",(function(t){let{target:n}=t;if(n.classList.contains("accordion-open"))return;let i=(0,e.$)(".question.show")[0]??"",o=+(null==i?void 0:i.dataset.id)??"",a=(0,e.$)("[data-pagination]")??"",s=a.findIndex((e=>e.classList.contains("active")))??"";function r(t,n){(0,e.$)(`[data-pagination="${t}"]`)[0].classList.toggle("active"),(0,e.$)(`[data-pagination="${n}"]`)[0].classList.toggle("active")}function l(t){i.classList.toggle("show"),(0,e.$)(`.question[data-id="${t}"]`)[0].classList.toggle("show")}"checkbox"===n.type?n.labels[0].classList.toggle("pushed"):"prev"===n.id?function(){if(s<1)return!1;let e=+a[s-1].dataset.pagination;r(o,e),l(e)}():"next"===n.id?function(){if(s===a.length-1)return!1;let e=+a[s+1].dataset.pagination;r(o,e),l(e)}():n.classList.contains("test-do__finish-btn")&&async function(t){if("ПРОЙТИ ТЕСТ ЗАНОВО"===t.innerText)return void location.reload();t.innerText="ПРОЙТИ ТЕСТ ЗАНОВО",t.classList.add("inactive"),function(t){let n=(0,e.$)(".question");[].map.call(n,(n=>{let i=function(t,n){let i=t.querySelectorAll(".a"),o=[];return[].map.call(i,(t=>{let i=(0,e.$)(t).find("input"),a=function(e,t,n,i){let o=-1!==t.indexOf(e),a=n.checked,s=!1;return a&&o?i.classList.add("done"):a&&!o?s=!0:!a&&o&&(i.classList.add("done"),s=!0),s}(t.dataset.id,n,i,t);a&&o.push(!0)})),o}(n,t);!function(t,n){let i=t.dataset.id,o=(0,e.$)(`.pagination [data-pagination='${+i}']`)[0];n.length?(0,e.$)(o).addClass("redShadow"):(0,e.$)(o).addClass("greenShadow")}(n,i)}))}((await(0,e.v_)("/adminsc/test/getCorrectAnswers",{})).arr);let n=(i=(0,e.$)(".redShadow").length,{questionCnt:(0,e.$)(".question").length,errorCnt:i,html:(0,e.$k)(".test-do"),testid:(0,e.$)("[data-test-id]")[0].dataset.testId,testname:(0,e.$)(".test-name")[0].innerText,user:(0,e.$)(".user-menu .fio")[0].innerText});var i;await(0,e.v_)("/adminsc/testresult/create",n)&&(t.href=location.href,t.innerText="ПРОЙТИ ТЕСТ ЗАНОВО")}(n)}))),n(704);let Et=(0,e.$)(".opentest-do")[0];Et&&(function(){let t=(0,e.$)(".question")[0];t&&t.classList.add("show")}(),(0,e.$)(Et).on("click",(async function(t){let{target:n}=t,i=n.dataset.id;(0,e.$)(".question.show")[0],"finish"===n.id&&async function(t){if("ПРОЙТИ ТЕСТ ЗАНОВО"===t.innerText)return void location.reload();let n=function(t){let n=0;return[].forEach.call(t,(t=>{let i=t.id,o=(0,e.$)(`.question[data-id='${i}']`)[0],a=(0,e.$)(o).find(".textarea");if(!t.Openanswer)return;let s="";t.Openanswer.forEach((e=>{s+=`(${e.answer})?`})),n+=function(t,n,i){let o=n.innerHTML,a=new RegExp(t,"g"),s=o.match(a),r=0;return s.forEach((t=>{if(!t)return;r=1;let o=new RegExp(t,"g"),a="<span style='color:limegreen;'>"+t+"</span>";n.innerHTML=n.innerHTML.replace(o,a),function(t){let n=(0,e.$)(`[data-pagination="${t}"]`);n&&n.css("backgroundColor","green")}(i)})),r}(`${s}`,a,i)})),n}((await(0,e.v_)("/adminsc/opentestresult/getanswers",{id:i})).arr),o=(a=n,(0,e.$)(".buttons")[0].remove(),{id:i,questionCnt:(0,e.$)("[data-pagination]").length,html:(0,e.$k)(".test"),testname:(0,e.$)(".test-name")[0].innerText,username:(0,e.$)(".user-menu .fio")[0].innerText,rightAnswers:a});var a;await(0,e.v_)("/adminsc/opentestresult/finish",o)&&(t.innerText="ПРОЙТИ ТЕСТ ЗАНОВО",t.classList.add("inactive"))}(n)})),(0,e.$)(Et).on("keyup",(function(t){let{target:n}=t;if(n.classList.contains("textarea")){let t=(0,e.$)("[data-pagination].active")[0];n.innerText?t.classList.add("filled"):t.classList.remove("filled")}})));class $t{constructor(t){this.pClass=t.pClass??"",this.pActiveClass=t.pActiveClass??"",this.pageClass=t.pageClass??"",this.pageActiveClass=t.pageActiveClass??"",this.prevBttnEl=t.prevBttnEl??null,this.nextBttnEl=t.nextBttnEl??null,this.paginations=(0,e.$)(this.pClass),this.activePClass=this.pClass+"."+this.pActiveClass,this.activePageClass="."+this.pageClass+"."+this.pageActiveClass,this.paginations.length&&(this.navInit(),(0,e.$)(this.pClass).on("click",this.handleClick.bind(this)),this.prevBttnEl&&((0,e.$)(this.prevBttnEl).on("click",this.handleNextPrev.bind(this)),(0,e.$)(this.nextBttnEl).on("click",this.handleNextPrev.bind(this))))}navInit(){[].map.call(this.paginations,(e=>{e.classList.remove(this.pActiveClass)})),this.paginations[0].classList.add(this.pActiveClass)}handleNextPrev(t){let{target:n}=t,i=(0,e.$)(this.activePageClass)[0],o=(0,e.$)(this.activePClass)[0],a=this.paginations.indexOf(o);n===this.prevBttnEl?function(){if(a<1)return!1;let e=this.paginations[a-1];this.togglePage(e,i),this.toggleNav(e,o)}.call(this):n===this.nextBttnEl&&function(){if(a>this.paginations.length-2)return!1;let e=this.paginations[a+1];this.togglePage(e,i),this.toggleNav(e,o)}.call(this)}toggleNav(e,t){t.classList.toggle(this.pActiveClass),e.classList.toggle(this.pActiveClass)}togglePage(t,n){let i=t.dataset.pagination;(0,e.$)(`.question[data-id='${i}']`)[0].classList.toggle(this.pageActiveClass),n.classList.toggle(this.pageActiveClass)}handleClick(t){let{target:n}=t;if(!n.dataset.pagination)return;if(n.classList.contains(this.pActiveClass))return;let i=(0,e.$)(this.activePClass)[0];i.classList.remove(this.pActiveClass),n.classList.add(this.pActiveClass);let o=i.dataset.pagination;(0,e.$)(`.${this.pageClass}[data-id="${o}"]`).removeClass(this.pageActiveClass);let a=n.dataset.pagination;(0,e.$)(`.${this.pageClass}[data-id="${a}"]`).addClass(this.pageActiveClass)}}(0,e.$)(document).ready((function(){var t;new $t({pClass:"[data-pagination]",pActiveClass:"active",pageClass:"question",pageActiveClass:"show",prevBttnEl:(0,e.$)("#prev")[0],nextBttnEl:(0,e.$)("#next")[0]}),t=window.location.pathname,/\/adminsc\/settings/.test(t)||/\/adminsc\/right\/list/.test(t)||/\/adminsc\/post\/list/.test(t)||/\/adminsc\/todo\/list/.test(t)?((0,e.$)(".rights-table").on("click",(function(t){let{target:n}=t;function i(t){let n=t.dataset.id??"new",i=(0,e.$)(`[data-id='${n}']`),o={toServ:{},empty:{}};return i.map((e=>{e.classList.contains("id")?(o.id=e,o.toServ.id=e.dataset.id):e.classList.contains("name")?(o.name=e,o.toServ.name=e.innerText.trim()):e.classList.contains("description")?(o.description=e,o.toServ.description=e.innerText.trim()):e.classList.contains("save.svg")?o.save=e:e.classList.contains("del")&&(o.del=e)})),o.empty.del=o.id.previousElementSibling.cloneNode(!0),o.empty.save=o.id.previousElementSibling.previousElementSibling.cloneNode(!0),o.empty.description=o.id.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),o.empty.name=o.id.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),o.empty.id=o.id.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.previousElementSibling.cloneNode(!0),o}n.closest(".del")&&function(t){let n=i(t);"new"!==n.toServ.id&&confirm("Удалить право?")&&(function(e){e.id.remove(),e.name.remove(),e.description.remove(),e.save.remove(),e.del.remove()}(n),async function(t){await(0,e.v_)("/right/delete",{id:t.toServ.id})}(n))}(n.closest(".del")),n.closest(".save")&&function(t){let n=i(t);if("new"!==n.toServ.id)!async function(t){await(0,e.v_)("/right/update",t)}(n.toServ);else{if(!n.toServ.name||!n.toServ.description)return!1;!async function(t){let n=await(0,e.v_)("/right/create",t.toServ);n.arr.id&&(function(e,t){e.empty.id.dataset.id=t,e.empty.id.innerText=t,e.empty.name.dataset.id=t,e.empty.name.innerText=e.name.innerText.trim(),e.empty.description.dataset.id=t,e.empty.description.innerText=e.description.innerText.trim(),e.empty.save.dataset.id=t,e.empty.del.dataset.id=t}(t,n.id-1),function(t){let n=(0,e.$)(".id[data-id='new']")[0];n.before(t.empty.id),n.before(t.empty.name),n.before(t.empty.description),n.before(t.empty.save),n.before(t.empty.del)}(t),function(e){e.name.innerText="",e.description.innerText=""}(t),e.gk.show("Сохранено"))}(n)}}(n.closest(".save"))})),(0,e.$)("[settings]").addClass("current")):/\/auth\/profile/.test(t)?function(){let t=(0,e.$)('[data-model="user"]')[0];function n(){let t=(0,e.$)(".right:checked"),n="";return[].map.call(t,(e=>{let t=e.previousElementSibling.innerText+",";n+=t}),n),n}function i(){const t=(0,e.$)("#conf option");for(let e of t)if(e.selected)return e.value;return"0"}t&&(0,e.$)(t).on("click",(async function(t){let{target:o}=t;if(o.closest("#save")){let t=function(t){return{id:(0,e.$)(t).find("#id").innerText,name:(0,e.$)(t).find("#name").innerText,surName:(0,e.$)(t).find("#s-name").innerText,middleName:(0,e.$)(t).find("#m-name").innerText,birthDate:(0,e.$)(t).find("#bday").innerText,phone:(0,e.$)(t).find("#phone").innerText,email:(0,e.$)(t).find("#email").innerText,hired:(0,e.$)(t).find("#hired").innerText,fired:(0,e.$)(t).find("#fired").innerText,confirm:i(),sex:void 0,rights:n()}}((0,e.$)(".user-item")[0]);await(0,e.v_)("/adminsc/user/update",t)}else if(o.classList.contains("right")){let t=(0,e.$)("input.right:checked"),n="";[].map.call(t,(function(e){let t=e.previousElementSibling.innerText;n+=t+","})),o.closest("[tab]").dataset.value=n}}))}():/\/adminsc\/crm/.test(t)?(0,e.$)("[crm]").addClass("current"):/\/adminsc\/planning/.test(t)?(0,e.$)("[plan]").addClass("current"):/\/test/.test(t)||/\/opentest/.test(t)||/\/adminsc\/opentest/.test(t)||/\/adminsc\/test/.test(t)?(0,e.$)("[test]").addClass("current"):(0,e.$)("[href='/adminsc']").addClass("current"),function(){let t=(0,e.$)("[custom-radio]");[].map.call(t,(function(t){(0,e.$)(t).on("click",(function(e){let{target:n}=e,i=n.closest("label");t.dataset.value=i.dataset.value}))}))}(),function(){let t=(0,e.$)("[multi-select] ");t&&[].forEach.call(t,(function(t){t.addEventListener("click",(function(t){let{target:n}=t,i=n.closest("[multi-select]");if(n.closest(".arrow")||["chip-wrap"].includes(n.className))i.querySelector("ul").classList.toggle("show");else if(["view.components.Builders.ListBuilder.del"].includes(n.className))!function(t){(0,e.$)(i).find(`label[data-id='${t}']`).classList.remove("selected")}(n.closest(".chip").dataset.id),n.closest(".chip").remove();else if("label"===n.tagName.toLowerCase()){let t=n.dataset.id,o=i.querySelectorAll(".chip"),a=[].some.call(o,(e=>e.dataset.id===t)),s=(0,e.$)(i).find(".chip-wrap");if(a)n.classList.toggle("selected"),s.querySelector(`[data-id='${t}']`).remove();else{n.classList.toggle("selected");let e=function(e){let t=document.createElement("div");t.classList.add("chip"),t.innerText=n.innerText,t.dataset.id=e;let i=document.createElement("div");return i.classList.add("view.components.Builders.ListBuilder.del"),i.innerText="X",t.append(i),t}(t);s.append(e)}}}),!1),t.addEventListener("blur",(function(t){let{target:n}=t,i=(0,e.$)(this).find(".show");i&&i.classList.remove("show")}),!1)}))}(),function(){let t=(0,e.$)(".item_wrap")[0];if(t){(0,e.$)(t).on("click",(async function(n){let{target:i}=n,o=t,a=o.dataset.model;i.closest(".save")?async function(t){if(function(){let t=(0,e.$)("[required]"),n=0;return[].forEach.call(t,(function(t){if(!t.innerText){if(t.style.borderColor="red",(0,e.$)(t).find(".error"))return;let i=document.createElement("div");i.innerText="Заполните поле",i.classList.add("error"),t.closest(".value").appendChild(i),n++}})),n}())return!1;let n=function(t){let n=(0,e.$)(`[data-field][data-model='${t}']`),i={};[].map.call(n,(t=>{if(t.closest("[data-parent]"))return i;if(t.hasAttribute("multi-select")){let e=t.querySelectorAll(".chip"),n=[].map.call(e,(e=>e.dataset.id));i[t.dataset.field]=n.toString()}else t.hasAttribute("custom-select")?i[t.dataset.field]=t.dataset.value:"inputs"===t.dataset.type?i[t.dataset.field]=function(e){let t=e.querySelectorAll("input"),n=[];return t.forEach((e=>{if(!e.checked)return;let t=e.parentNode.querySelector(".name").innerText;t&&n.push(t)})),n.join(",")}(t):t.hasAttribute("custom-radio")||t.hasAttribute("tab")?i[t.dataset.field]=t.dataset.value:"date"===t.type?i[t.dataset.field]=t.value:i[t.dataset.field]=(0,e.mN)(t.innerText)}),i);let o=(0,e.$)("[data-isTest]")[0];return o&&(i.isTest=+o.dataset.istest),i}(t);await(0,e.v_)(`/adminsc/${t}/updateorcreate`,n)}(a):i.closest(".del")&&i.closest(".del").dataset.model?async function(t,n){let i=t.dataset.id;await(0,e.v_)(`/adminsc/${n}/delete`,{id:i})&&(window.location.href=`/adminsc/${n}/edit`)}(o,i.closest(".del").dataset.model):i.classList.contains("tab")&&async function(t){(0,e.$)("[data-tab].show")[0].classList.toggle("show"),(0,e.$)(`[data-tab='${t.dataset.tabId}']`)[0].classList.toggle("show"),(0,e.$)(".tab.active")[0].classList.toggle("active"),t.classList.toggle("active")}(i)}));let n=(0,e.$)("[custom-select]");n&&[].map.call(n,(function(e){new ht(e)}))}}(),document.addEventListener("mouseenter",(function(e){let{target:t}=e;if(!t.dataset||!t.dataset.tooltip)return;let n=t.dataset.tooltip,i=document.createElement("div");i.className="tooltip",i.innerHTML=n,document.body.append(i);let o=t.getBoundingClientRect(),a=o.left+(t.offsetWidth-i.offsetWidth)/2;a<0&&(a=0);let s=o.top-i.offsetHeight-5;s<0&&(s=o.top+t.offsetHeight+5),i.style.left=a+"px",i.style.top=s+"px"}),!0),document.addEventListener("mouseleave",(function(){let e=document.querySelectorAll(".tooltip");e&&[].forEach.call(e,(e=>{e.remove()}))}),!0),function(){let t=(0,e.$)("[data-testid]")[0];if(t){t=+t.dataset.testid;let n=(0,e.$)(".test-edit.accordion a");Array.from(n).filter((e=>{+e.dataset.id===t&&e.classList.add("current")}))}let n=(0,e.$)(".accordion-open")[0];n&&(0,e.$)(n).on("click",(function(){(0,e.$)(".accordion_wrap")[0].classList.toggle("open")}));let i=(0,e.$)("#burger")[0];i&&(0,e.$)(i).on("click",(function(){(0,e.$)(".admin_sidebar")[0].classList.toggle("open")}))}(),function(){let t=(0,e.$)(".test-edit-wrapper")[0];t&&(ct(".test-edit-wrapper .questions",".questions>.question-edit","question"),(0,e.$)(t).on("keyup",wt),(0,e.$)(t).on("change",yt),(0,e.$)(t).on("click",bt))}()}))}()}();
//# sourceMappingURL=admin.js.map