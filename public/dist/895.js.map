{"version":3,"file":"895.js","mappings":"4JAGe,MAAMA,EAEnBC,WAAAA,CAAYC,GAAQ,GAElBC,KAAKD,MAAQA,EACb,IAAIE,GAASC,EAAAA,EAAAA,GAAE,kBAAkBC,QAC7BC,GAAQF,EAAAA,EAAAA,GAAE,iBAAiBC,QAE1BF,GAAWG,IAChBJ,KAAKC,OAASA,EACdD,KAAKI,MAAQA,EACbJ,KAAKK,MAAOH,EAAAA,EAAAA,GAAEE,GAAOE,KAAK,SAC1BN,KAAKO,QAASL,EAAAA,EAAAA,GAAEE,GAAOE,KAAK,WAC5BN,KAAKQ,UAAWN,EAAAA,EAAAA,GAAEE,GAAOE,KAAK,UAE9BN,KAAKC,OAAOQ,QAAUT,KAAKU,UAAUC,KAAKX,MAC1CA,KAAKI,MAAMK,QAAUT,KAAKY,WAAWD,KAAKX,MAE1CA,KAAKa,gBAAiBC,EAAAA,EAAAA,IAASd,KAAKM,KAAM,KAC1CN,KAAKK,KAAKU,QAAUf,KAAKa,eAAeF,KAAKX,MAE7CA,KAAKQ,SAASQ,QAAUhB,KAAKY,WAAWD,KAAKX,MAC/C,CAEAU,SAAAA,GACEV,KAAKI,MAAMa,UAAUC,OAAO,QAC5BlB,KAAKO,OAAOY,UAAY,GACxBnB,KAAKK,KAAKe,MAAQ,EACpB,CAEAR,UAAAA,EAAW,OAACS,KAGRA,EAAOJ,UAAUK,SAAS,iBAC1BD,EAAOJ,UAAUK,SAAS,YAG1BtB,KAAKI,MAAMa,UAAUC,OAAO,QAC5BlB,KAAKO,OAAOY,UAAY,GACxBnB,KAAKK,KAAKe,MAAQ,GAEtB,CAEA,UAAMd,EAAK,OAACe,IACVrB,KAAKO,OAAOY,UAAY,GAExB,IAAId,EAAOgB,EAAOD,MAClB,IAAKf,EAAM,OAAO,EAClB,IAAIkB,QAAYC,EAAAA,EAAAA,IAAK,UAAW,CAACnB,SAC7BkB,GAAKE,KAAKC,QACZ1B,KAAKO,OAAOoB,MAAMC,QAAU,UAC5B5B,KAAK6B,WAAWN,GAAKE,KAAKC,OAE9B,CAEAG,UAAAA,CAAWJ,GACTA,EAAIK,KAAKC,IACP/B,KAAKO,OAAOyB,OAAOhC,KAAKiC,SAASF,GAAK,GAE1C,CAEAG,WAAAA,CAAYH,GACV,OAAI/B,KAAKD,MACA,yBAAyBgC,EAAII,KAE7B,YAAYJ,EAAIK,MAE3B,CAEAH,QAAAA,CAASF,GAEP,IAAIM,GAAKC,EAAAA,EAAAA,IAAS,MAEdC,GAAID,EAAAA,EAAAA,IAAS,KACjBC,EAAEC,KAAOxC,KAAKkC,YAAYH,GACtBA,EAAIU,YACNF,EAAEtB,UAAUyB,IAAI,WAElBL,EAAGM,YAAYJ,GACf,IAAIK,GAAON,EAAAA,EAAAA,IAAS,MAAO,OAAQP,EAAIa,MACnCC,GAAMP,EAAAA,EAAAA,IAAS,MAAO,MAAOP,EAAIc,KACjCC,GAAMR,EAAAA,EAAAA,IAAS,OAMnB,OALAQ,EAAIC,IAAMhB,EAAIiB,UACdT,EAAEP,OAAOa,GACTN,EAAEP,OAAOY,GACTL,EAAEP,OAAOc,GACTT,EAAGL,OAAOO,GACHF,CACT,E","sources":["webpack://my-webpack-project/./public/src/components/search/search.js"],"sourcesContent":["import \"./search.scss\";\r\nimport {$, debounce, post, createEl} from '../../common'\r\n\r\nexport default class Search {\r\n\r\n  constructor(admin = false) {\r\n\r\n    this.admin = admin;\r\n    let button = $('.utils .search').first();\r\n    let panel = $('.search-panel').first();\r\n    // debugger\r\n    if (!button || !panel) return;\r\n    this.button = button;\r\n    this.panel = panel;\r\n    this.text = $(panel).find('.text');\r\n    this.result = $(panel).find('.result');\r\n    this.closeBtn = $(panel).find('.close');\r\n\r\n    this.button.onclick = this.showPanel.bind(this);\r\n    this.panel.onclick = this.closePanel.bind(this);\r\n\r\n    this.debouncedKeyUp = debounce(this.find, 800);\r\n    this.text.onkeyup = this.debouncedKeyUp.bind(this);\r\n\r\n    this.closeBtn.onklick = this.closePanel.bind(this)\r\n  }\r\n\r\n  showPanel() {\r\n    this.panel.classList.toggle('show');\r\n    this.result.innerHTML = '';\r\n    this.text.value = ''\r\n  }\r\n\r\n  closePanel({target}) {\r\n    // let list = target.classList\r\n    if (\r\n      target.classList.contains('search-panel') ||\r\n      target.classList.contains('close')\r\n    ) {\r\n\r\n      this.panel.classList.toggle('show');\r\n      this.result.innerHTML = '';\r\n      this.text.value = ''\r\n    }\r\n  }\r\n\r\n  async find({target}) {\r\n    this.result.innerHTML = '';\r\n\r\n    let text = target.value;\r\n    if (!text) return false;\r\n    let res = await post('/search', {text});\r\n    if (res?.arr?.found) {\r\n      this.result.style.display = 'initial';\r\n      this.makeString(res?.arr?.found)\r\n    }\r\n  }\r\n\r\n  makeString(arr) {\r\n    arr.map((row) => {\r\n      this.result.append(this.createLi(row))\r\n    })\r\n  }\r\n\r\n  composeHref(row) {\r\n    if (this.admin) {\r\n      return `/adminsc/product/edit/${row.id}`\r\n    } else {\r\n      return `/product/${row.slug}`\r\n    }\r\n  }\r\n\r\n  createLi(row) {\r\n    // debugger\r\n    let li = createEl('li');\r\n\r\n    let a = createEl('a');\r\n    a.href = this.composeHref(row);\r\n    if (row.deleted_at){\r\n      a.classList.add('deleted')\r\n    }\r\n    li.appendChild(a);\r\n    let name = createEl('div', 'name', row.name);\r\n    let art = createEl('div', 'art', row.art);\r\n    let img = createEl('img');\r\n    img.src = row.mainImage;\r\n    a.append(art);\r\n    a.append(name);\r\n    a.append(img);\r\n    li.append(a);\r\n    return li\r\n  }\r\n\r\n\r\n}"],"names":["Search","constructor","admin","this","button","$","first","panel","text","find","result","closeBtn","onclick","showPanel","bind","closePanel","debouncedKeyUp","debounce","onkeyup","onklick","classList","toggle","innerHTML","value","target","contains","res","post","arr","found","style","display","makeString","map","row","append","createLi","composeHref","id","slug","li","createEl","a","href","deleted_at","add","appendChild","name","art","img","src","mainImage"],"sourceRoot":""}