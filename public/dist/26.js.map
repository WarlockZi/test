{"version":3,"file":"26.js","mappings":"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","sources":["webpack://my-webpack-project/./public/src/Admin/Product/units.js","webpack://my-webpack-project/./public/src/Admin/Product/UnitTable.js","webpack://my-webpack-project/./public/src/Admin/Product/Values.js","webpack://my-webpack-project/./public/src/constants.js","webpack://my-webpack-project/./public/src/Admin/Product/Fields.js","webpack://my-webpack-project/./public/src/Admin/Product/product.js"],"sourcesContent":["import './units.scss'\r\nimport {$} from '../../common'\r\nimport UnitTable from './UnitTable'\r\n\r\n  let $units = $('.units').first();\r\n  if ($units) {\r\n    // $(`[data-tab='3']`).first().classList.toggle('show');\r\n    // $(`[data-tab='1']`).first().classList.toggle('show');\r\n\r\n    new UnitTable('.units')\r\n\r\n}\r\n","import {$, createElement, post} from '../../common'\r\nimport WDSSelect from \"../../components/select/WDSSelect\";\r\nimport SelectNew from \"../../components/select/SelectNew\";\r\n\r\n\r\nexport default class UnitTable {\r\n  constructor(tableClass) {\r\n    this.$table = $(tableClass).first();\r\n    if (!this.$table) return;\r\n\r\n    this.product1sId = $(`[data-field='1s_id']`).first().innerText;\r\n\r\n    this.$baseUnit = $(`[data-field='base_unit'] [data-field='base_unit']`).first();\r\n    // this.baseUnitId = this.$baseUnit.options[this.$baseUnit.selectedIndex].value;\r\n\r\n    this.$addUnit = $('.add-unit').first();\r\n    this.$rows = $('.rows').first();\r\n    this.$selector = $(this.$rows).find('[select-new]');\r\n\r\n    this.$addUnit.onclick = this.createRow.bind(this);\r\n    this.$rows.onchange = this.handleChange.bind(this);\r\n    this.$rows.onkeyup = this.handleKeyUp.bind(this);\r\n    this.$rows.onclick = this.clickRow.bind(this);\r\n    this.$rows.addEventListener('customSelect.changed', this.unitChanged.bind(this));\r\n\r\n    this.initSelects();\r\n    setTimeout(this.deleteSelected.bind(this), 800)\r\n  }\r\n\r\n  initSelects() {\r\n    this.$rows.querySelectorAll('[select-new]').forEach((s) => {\r\n      new SelectNew(s)\r\n    })\r\n  }\r\n\r\n  deleteSelected() {\r\n    debugger\r\n    let selected = this.$rows.querySelectorAll('.selected');\r\n    selected = Array.from(selected).map((s) => {\r\n      if (+s.dataset.value) return s.dataset.value;\r\n    });\r\n    this.$table.querySelectorAll('[custom-select]').forEach(\r\n      function (select) {\r\n        select.querySelectorAll('li').forEach(function (o) {\r\n          if (selected.includes(o.dataset.value)) {\r\n            o.remove()\r\n          }\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  createRow() {\r\n    let baseUnitText = this.$baseUnit.selectedOptions[0].innerText;\r\n\r\n    let row = (new createElement()).tag('div').attr('class', 'row').get();\r\n    let $selector = this.$selector.cloneNode(true);\r\n\r\n    let multiplier = (new createElement()).attr('type', 'number').tag('input').attr('value', 10).get();\r\n    let baseUnit = (new createElement()).tag('div').attr('class', 'base-unit').text(baseUnitText).get();\r\n    let minUnit = (new createElement()).tag('div').className( 'min-unit').get();\r\n    let minUnitInput = (new createElement()).tag('input').attr('type','checkbox').get();\r\n    let del = (new createElement()).tag('div').attr('class', 'del').text('X').get();\r\n\r\n    row.append($selector);\r\n    row.append(multiplier);\r\n    row.append(baseUnit);\r\n    minUnit.append(minUnitInput);\r\n    row.append(minUnit);\r\n    row.append(del);\r\n\r\n    new SelectNew($selector);\r\n\r\n    this.$rows.append(row);\r\n    this.deleteSelected()\r\n  }\r\n\r\n  async unitChanged(obj) {\r\n    let data = this.dto(obj.target.closest('.row'));\r\n    data.morphed.new_id = obj.detail.next.value;\r\n    data.morphed.old_id = obj.detail.prev.value;\r\n    if (obj.detail.next.value)\r\n      this.deleteSelectedUnitFromSelects(obj.detail.next.value);\r\n\r\n    if (obj.detail.prev.value)\r\n      this.addDeletedUnitToSelects(obj.detail.prev);\r\n\r\n    let res = await post('/adminsc/product/changeUnit', data)\r\n  }\r\n\r\n  deleteSelectedUnitFromSelects(value) {\r\n    this.$table.querySelectorAll('[custom-select]').forEach(\r\n      function (select) {\r\n        let options = select.querySelectorAll('li');\r\n        options.forEach(function (o) {\r\n          if (o.dataset.value === value) {\r\n            o.remove()\r\n          }\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  addDeletedUnitToSelects() {\r\n    this.$table.querySelectorAll('[custom-select]').forEach(\r\n      function (select) {\r\n        let options = select.querySelectorAll('li');\r\n        options.forEach(function (o) {\r\n          if (o.dataset.value === value) {\r\n            o.remove()\r\n          }\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  async clickRow({target}) {\r\n    if (target.classList.contains('del')) {\r\n      let row = target.closest('.row');\r\n      let data = this.dto(row);\r\n      data.morphed.detach = 1;\r\n      let res = await post('/adminsc/product/changeunit', data);\r\n      if (res?.arr?.ok) {\r\n        row.remove()\r\n      }\r\n    }\r\n  }\r\n\r\n  handleKeyUp(e){\r\n    let multiplier = +e.target.value;\r\n    if (!/\\d+/.test(multiplier)) {\r\n      return\r\n    }\r\n    this.update(e, this)\r\n  }\r\n\r\n  handleChange(e){\r\n    this.update(e, this)\r\n  }\r\n\r\n  async update(e, self) {\r\n    let row = e.target.closest('.row');\r\n    let chosenUnit = +$(row).find('[select-new]').dataset.value;\r\n    if (!chosenUnit) return false;\r\n    let data = self.dto(row);\r\n    data.morphed.new_id = data.morphed.old_id;\r\n\r\n    let res = await post('/adminsc/product/changeUnit', data);\r\n  }\r\n\r\n  dto(row) {\r\n    let pivot = {\r\n      'product_id': this.product1sId,\r\n      'multiplier': +$(row).find(`input[type='number']`).value ?? 0,\r\n      'main': $(row).find(`input[type='checkbox']`).checked?1:null,\r\n    };\r\n    let morphed = {\r\n      new_id: 0,\r\n      old_id: +this.getUnitId(row),\r\n      detach: 0\r\n    };\r\n    return {\r\n      baseUnitId: this.getBaseUnitId(),\r\n      pivot, morphed\r\n    }\r\n  }\r\n\r\n  getBaseUnitId() {\r\n    return +this.$baseUnit.options[this.$baseUnit.selectedIndex].value\r\n  }\r\n\r\n  getUnitId(row) {\r\n    let classSelected = row.querySelector('[select-new]');\r\n    return classSelected.dataset.value ?? 0\r\n  }\r\n\r\n}","import './values.scss'\r\nimport {$, post} from '../../common'\r\nimport SelectNew from \"../../components/select/SelectNew\";\r\n\r\nexport default class Values {\r\n  constructor($product) {\r\n    this.$product = $product;\r\n    this.$values = $($product).find('.values');\r\n    this.values = this.$values.querySelectorAll('.value');\r\n    // this.dto = this.dto();\r\n    this.$values.addEventListener('customSelect.changed', this.selectChanged.bind(this));\r\n    this.values.forEach((value) => {\r\n      new SelectNew(value)\r\n    })\r\n  }\r\n\r\n  dto() {\r\n    return {\r\n      product_id: this.$product.dataset.id,\r\n      morphed: {\r\n        old_id: 0,\r\n        new_id: 0\r\n      }\r\n    }\r\n  }\r\n\r\n  async selectChanged(obj) {\r\n    let data = this.dto();\r\n    data.morphed.old_id = obj.detail.prev.value;\r\n    data.morphed.new_id = obj.detail.next.value;\r\n    let res = await post(`/adminsc/product/changeVal`, data)\r\n  }\r\n}\r\n\r\n","export const d = 'document'\r\nexport const qs = 'querySelector'\r\nexport const qa = 'querySelectorAll'\r\nexport const ael = 'addEventListener'\r\nexport const st = 'setTimeout'\r\nexport const it = 'innerText'","import SelectNew from \"../../components/select/SelectNew\";\r\nimport {$, post} from \"../../common\";\r\n\r\nexport class Fields {\r\n  constructor($product) {\r\n    this.$product = $product;\r\n    this.$fields = $('.item_content').first();\r\n    this.$category_id = $(`[data-field=\"category_id\"]`).first();\r\n    this.$promotions = $(`[data-field=\"promotions\"]`).first();\r\n    this.$base_unit = $(`[data-field=\"base_unit\"]`).first();\r\n    this.$manufacturer_id = $(`[data-field=\"manufacturer_id\"]`).first();\r\n    this.$printName = $(`[data-field='print_name']`).first();\r\n    this.$printName.addEventListener('catalogItem.changed', this.changePrintName.bind(this))\r\n    this.$productUrl= $(`[data-field='slug']`).first();\r\n    this.setup()\r\n  }\r\n\r\n  setup() {\r\n    this.$fields.addEventListener('customSelect.changed', this.changeFields.bind(this));\r\n    new SelectNew(this.$category_id);\r\n    new SelectNew(this.$promotions);\r\n    new SelectNew(this.$base_unit);\r\n    new SelectNew(this.$manufacturer_id);\r\n  }\r\n\r\n  changePrintName(item) {\r\n    if (item.detail) {\r\n      let $url = this.$productUrl.querySelector('a')\r\n      let slug = item.detail?.res?.arr?.model.slug\r\n      $url.setAttribute('href',`/product/${slug}`)\r\n      $url.text = slug\r\n    }\r\n\r\n  }\r\n\r\n  async checkBoxChanged({target}) {\r\n    let data = this.dto(this);\r\n    data[target.dataset.field] = +target.checked;\r\n    let res = await post('/adminsc/product/updateOrCreate', data)\r\n  }\r\n\r\n  async changeFields(obj) {\r\n    let field = obj.detail.target.dataset.field;\r\n    if (!field) return;\r\n    let data = this.dto(obj);\r\n    data[field] = obj.detail.next.value;\r\n    let res = await post('/adminsc/product/updateOrCreate', data)\r\n  }\r\n\r\n  dto(obj) {\r\n    return {\r\n      id: this.$product.dataset.id,\r\n    }\r\n  }\r\n}","import './product.scss'\r\nimport './units'\r\nimport './Values'\r\nimport {$, objAndFiles2FormData, post} from '../../common'\r\nimport {d, qs, qa, ael} from '../../constants'\r\nimport shippableTable from \"../../share/shippable/shippableUnitsTable\";\r\n\r\n\r\nimport {Fields} from \"./Fields\";\r\n\r\nimport Values from \"./Values\";\r\n\r\nimport Dnd from \"../../components/dnd/dnd\";\r\n\r\nexport default function product() {\r\n  const product = document[qs](`.item-wrap\r\n  [data-model='product']`);\r\n  if (!product) return false;\r\n\r\n  new Values(product);\r\n\r\n  new Fields(product);\r\n\r\n  new Dnd($('.add-file')[0], addMainImage);\r\n}\r\n\r\nasync function setEqual({target}) {\r\n  let data = {\r\n    ['1s_id']: target.closest('.item_content').querySelector(`[data-field=\"1s_id\"]`).innerText,\r\n    'equal': +target.checked\r\n  };\r\n  let res = await post('/adminsc/product/Setbaseequalmainunit', data)\r\n}\r\n\r\nasync function addMainImage(files, target) {\r\n\r\n  const obj = {productId: target.closest('.item-wrap').dataset.id,};\r\n  // debugger\r\n  let data = objAndFiles2FormData(obj, files[0]);\r\n\r\n  let res = await post('/adminsc/product/attachMainImage', data);\r\n  let src = res?.arr[0];\r\n  if (src) {\r\n    let mainImage = target.closest('.dnd-container').querySelector('img');\r\n    mainImage.removeAttribute(\"src\");\r\n    mainImage.setAttribute(\"src\", src)\r\n  }\r\n}\r\n\r\n\r\n"],"names":["$","first","constructor","tableClass","this","$table","product1sId","innerText","$baseUnit","$addUnit","$rows","$selector","find","onclick","createRow","bind","onchange","handleChange","onkeyup","handleKeyUp","clickRow","addEventListener","unitChanged","initSelects","setTimeout","deleteSelected","querySelectorAll","forEach","s","SelectNew","selected","Array","from","map","dataset","value","select","o","includes","remove","baseUnitText","selectedOptions","row","createElement","tag","attr","get","cloneNode","multiplier","baseUnit","text","minUnit","className","minUnitInput","del","append","obj","data","dto","target","closest","morphed","new_id","detail","next","old_id","prev","deleteSelectedUnitFromSelects","addDeletedUnitToSelects","post","_ref","classList","contains","_res$arr","detach","res","arr","ok","e","test","update","self","pivot","checked","getUnitId","baseUnitId","getBaseUnitId","options","selectedIndex","querySelector","Values","$product","$values","values","selectChanged","product_id","id","qs","Fields","$fields","$category_id","$promotions","$base_unit","$manufacturer_id","$printName","changePrintName","$productUrl","setup","changeFields","item","_item$detail","_item$detail$res","_item$detail$res$arr","$url","slug","model","setAttribute","checkBoxChanged","field","product","document","Dnd","addMainImage","async","files","productId","objAndFiles2FormData","src","mainImage","removeAttribute"],"sourceRoot":""}