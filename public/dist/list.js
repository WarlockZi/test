!function(){"use strict";var e={317:function(e,t,n){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{$:function(){return c},Ds:function(){return s},v_:function(){return o}});const s=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700;return function(){const i=()=>e.apply(this,arguments);clearTimeout(t),t=setTimeout(i,n)}};let r={show:function(e,t){let n=this.el("div","popup__close");n.innerText="X";let i=this.el("div","popup__item");i.innerText=e,i.append(n);let s=c(".popup")[0];s||(s=this.el("div","popup")),s.append(i),s.addEventListener("click",this.close,!0),document.body.append(s),setTimeout((()=>{i.classList.remove("popup__item"),i.classList.add("popup-hide")}),5e3),setTimeout((()=>{i.remove(),t&&t()}),5950)},close:function(e){e.target.classList.contains("popup__close")&&this.closest(".popup").remove()},el:function(e,t){let n=document.createElement(e);return n.classList.add(t),n}};async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((async function(n,i){t.token=document.querySelector('meta[name="token"]').getAttribute("content");let s=new XMLHttpRequest;s.open("POST",e,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),t instanceof FormData?s.send(t):(s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send("param="+JSON.stringify(t))),s.onerror=function(e){i(Error("Network Error"+e))},s.onload=function(){var e;let t=JSON.parse(s.response),i=c(".message")[0];var o;t.popup||null!=t&&null!==(e=t.arr)&&void 0!==e&&e.popup?r.show(t.popup??(null==t||null===(o=t.arr)||void 0===o?void 0:o.popup)):t.msg?i&&(i.innerHTML=t.msg,i.innerHTML=t.msg,c(i).removeClass("success"),c(i).removeClass("error")):t.success?i&&(i.innerHTML=t.success,c(i).addClass("success"),c(i).removeClass("error")):t.error&&i&&(i.innerHTML="",i.innerHTML=t.error,c(i).removeClass("success"),c(i).addClass("error")),n(t)}}))}class a extends Array{constructor(){super(...arguments),i(this,"value",(function(){return this[0].getAttribute("value")})),i(this,"attr",(function(e,t){return t&&this[0].setAttribute(e,t),this[0].getAttribute(e)})),i(this,"selectedIndexValue",(function(){if(this.length)return this[0].selectedOptions[0].value})),i(this,"options",(function(){if(this.length)return this[0].options})),i(this,"count",(function(){return this.length})),i(this,"text",(function(){if(this.length)return this[0].innerText})),i(this,"checked",(function(){if(this.length)return this[0].checked})),i(this,"getWithStyle",(function(e,t){let n=[];return this.forEach((i=>{i.style[e]===t&&n.push(i)})),n})),i(this,"addClass",(function(e){this.forEach((t=>{t.classList.add(e)}))})),i(this,"removeClass",(function(e){this.forEach((t=>{t.classList.remove(e)}))})),i(this,"hasClass",(function(e){if(this.classList.contains(e))return!0})),i(this,"append",(function(e){this[0].appendChild(e)})),i(this,"find",(function(e){return"string"==typeof e?this[0].querySelector(e):this[0].filter((t=>t===e))[0]})),i(this,"findAll",(function(e){if("string"==typeof e)return this[0].querySelectorAll(e)})),i(this,"css",(function(e,t){if(!t)return this[0].style[e];this.forEach((n=>{n.style[e]=t}))}))}on(e,t,n){"function"==typeof t?this.forEach((n=>n.addEventListener(e,t))):this.forEach((i=>{i.addEventListener(e,(e=>{e.target===t&&n(e)}))}))}ready(e){this.some((e=>null!=e.readyState&&"loading"!=e.readyState))?e():document.addEventListener("DOMContentLoaded",e)}}function c(e){return"string"==typeof e||e instanceof String?new a(...document.querySelectorAll(e)):new a(e)}}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e=n(317);const t=(0,e.$)(".custom-list__wrapper");t&&[].forEach.call(t,(function(t){const n=(0,e.$)("[contenteditable]"),i=t.querySelectorAll(".head"),s=t.querySelectorAll("[hidden]"),r=t.querySelectorAll("[data-sort]"),o=(0,e.$)(t).findAll(".head input"),a=(0,e.$)(t)[0].querySelectorAll(".id:not(.head"),c=t.dataset.model,l=t.dataset.parent??null,u=t.dataset.parentId??null,d=[];(0,e.$)(t).on("click",function(n){let{target:o}=n;if("add-model"===o.className)!async function(n,i,r){let o={};i&&(o={[i+"_id"]:+r});let a=await(0,e.v_)(`/adminsc/${n}/updateOrCreate`,o);a.arr.id&&function(n){let i=[...s];[].forEach.call(i,(function(i){let s=i.cloneNode(!0);s.removeAttribute("hidden"),(0,e.$)(t).find(".custom-list").appendChild(s),["id"].includes(s.className)?s.innerText=n:["view.components.Builders.ListBuilder.del","edit","save"].includes(s.className)||(s.innerText=""),s.dataset.id=n}))}(a.arr.id)}(c,l,u);else if(".del:not(.head)"===o.className||o.closest(".del:not(.head)"))!async function(t){if(!confirm("Удалить?"))return;let n=t.dataset.id;await(0,e.v_)(`/adminsc/${c}/delete`,{id:n})&&function(t){let n=(0,e.$)(`[data-id='${t}']`);[].forEach.call(n,(function(e){e.remove()}))}(n)}(o.closest(".del:not(.head)"));else if(".edit:not(.head)"===o.className||o.closest(".edit:not(.head)"))!function(e,t){let n=e.closest(".edit:not(.head)").dataset.id;window.location=`/adminsc/${t}/edit/${n}`}(o,c);else if(o.classList.contains("head")){let e=o.closest(".head");e.hasAttribute("data-sort")&&function(e){const t=h[e]||"asc",n="asc"===t?1:-1,s=Array.from(d);s.sort((function(t,i){const s=t[e].innerHTML,r=i[e].innerHTML,o=p(e,s),a=p(e,r);switch(!0){case o>a:return 1*n;case o<a:return-1*n;case o===a:return 0}})),[].forEach.call(d,(function(e){[].forEach.call(e,(e=>{e.remove()}))})),h[e]="asc"===t?"desc":"asc",s.forEach((function(e){(e=Array.from(e)).reverse(),[].forEach.call(e,(e=>{i[i.length-1].after(e)}))}))}([].findIndex.call(r,((t,n,i)=>t===e)))}}.bind(this)),(0,e.$)(t).on("keyup",function(e){let{target:s}=e;if(s.hasAttribute("contenteditable"))f(t,n,s);else if(s.closest(".head")){let e=s.closest(".head");!function(e,t){[].forEach.call(d,(e=>{[].forEach.call(e,(e=>{e.style.display="flex"}))}));const n=t.value;[].forEach.call(o,(e=>{e!==t&&(e.value="")})),[].forEach.call(d,(function(t){const i=t[e].innerText,s=new RegExp(`${n}`,"gi");i.match(s)||[].forEach.call(t,(e=>{e.style.display="none"}))}))}([].findIndex.call(i,((t,n,i)=>t===e)),s)}}.bind(this)),(0,e.$)(t).on("paste",function(e){let t=e.clipboardData.getData("text/plain");e.target.innerText=t,m(0,0,e.target),e.target.innerText=""}.bind(this));let f=(0,e.Ds)(m);for(let n=0;n<a.length;n++){let i=a[n].dataset.id,s=(0,e.$)(t)[0].querySelectorAll(`[data-id='${i}']`);d.push(s)}const h=Array.from(r).map((function(e){return""}));function p(e,t){if(r[e])return"number"===r[e].getAttribute("data-type")?parseFloat(t):t}function m(t,n,i){if(!i.hasAttribute("contenteditable"))return!1;!async function(t){let n=`/adminsc/${t.modelName}/updateOrCreate`;await(0,e.v_)(n,t.model)}(v(i,c))}function v(e,n){let i=e.dataset.field,s=t.dataset.parent+"_id",r=t.dataset.parentId,o={model:{id:e.dataset.id,[i]:e.innerText},modelName:n};return s&&(o.model[s]=r),o}}))}()}();
//# sourceMappingURL=list.js.map