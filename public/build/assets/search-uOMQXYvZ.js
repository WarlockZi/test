const k="modulepreload",D=function(s){return"/public/build/"+s},v={},Y=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),r=a?.nonce||a?.getAttribute("nonce");i=Promise.allSettled(t.map(u=>{if(u=D(u),u in v)return;v[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const o=document.createElement("link");if(o.rel=h?"stylesheet":k,h||(o.as="script"),o.crossOrigin="",o.href=u,r&&o.setAttribute("nonce",r),document.head.appendChild(o),h)return new Promise((m,g)=>{o.addEventListener("load",m),o.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(a){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a}return i.then(a=>{for(const r of a||[])r.status==="rejected"&&l(r.reason);return e().catch(l)})},w=()=>{const s=document.documentElement.scrollTop||document.body.scrollTop;s>0&&(window.requestAnimationFrame(w),window.scrollTo(0,s-s/8))},C=new Intl.NumberFormat("ru",{style:"currency",currency:"RUB",minimumFractionDigits:2});function P(s,e,t=new FormData){if(self.formData=t,typeof e=="FileList")for(let n=0;n<e.length;n++)self.formData.append(n,e[n]);else self.formData.append("file",e);return self.createFormData=function(n,i=""){for(let l in n){let a=n[l],r=i?i+"["+l+"]":l;typeof a=="string"||typeof a=="number"?self.formData.append(r,a):typeof a=="object"&&self.createFormData(a,r)}},self.createFormData(s),self.formData}const L=(s,e=700)=>{let t;return function(){const n=()=>s.apply(this,arguments);clearTimeout(t),t=setTimeout(n,e)}};function T(s){try{JSON.parse(s)}catch{return!1}return!0}function M(s){var e=new RegExp("&nbsp;?","g");return s.replace(e," ")}function N(s){var e=new RegExp("\\n?","g");return s.replace(e,"")}function q(s){var e=new RegExp("\\t?","g");return s.replace(e,"")}function F(s){return s.trim()}function E(s){return s=M(s),s=N(s),s=q(s),s=F(s),s}function R(s){const e=c(s).first().outerHTML;return H(E(e))}const S={show:function(s){const e=this.el("div","popup"),t=this.el("div","popup__close");t.innerText="X";const n=this.el("div","popup__item");n.innerText=s,n.append(t),e.append(n),e.addEventListener("click",this.close,!0),document.body.append(e);const i=5e3;setTimeout(()=>{n.classList.remove("popup__item"),n.classList.add("popup-hide")},i);const l=i+950;setTimeout(()=>{n.remove()},l)},close:function({target:s}){s.classList.contains("popup__close")&&this.closest(".popup").remove()},el:function(s,e){const t=document.createElement(s);return t.classList.add(e),t}};function _(){return document.querySelector('meta[name="phpSession"]').getAttribute("content")??null}function j(s){if(!s)return;const e={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;","(":"&fp",")":"&bp","/":"&fs","\\":"&bs",";":"&sc","|":"&or","?php":"&?php",delete:"&del"},t=/[&<>'()\/\\;]/gi;return s.replace(t,n=>e[n])}function $(s){const e=[],i=/[0-9\(\)\s\+-]*/g;return s.length||e.push("Поле должно быть заполнено"),s.replace(i,"").length&&e.push("Разрешены цифры, пробел, скобки, знак +, знак -"),s.length<11&&e.push("Длина меньше 11 символов"),s.length>19&&e.push("Длина больше 19 символов"),e}function I(s){const t=[],n=/[a-zA-Z0-9\@\-\_\.А-я]*/;return s.length||t.push("Поле не должно быть пустым"),s.replace(n,"").length&&t.push("Разрешены только английские"),s.length<6&&t.push("Длина меньше 6 символов"),t}function U(s){const e=decodeURI(s),t=2,n="(.){2,}@(.){2,}",i=".",l="^(.){2,}@(.){2,}.(.){2,}$",a=[],r=/[a-zA-Z0-9\@\-\_\.]*/;return e.length||a.push("Поле не должно быть пустым"),e.replace(r,"").length&&a.push("Разрешены только английские"),e.length<t&&a.push("Длина меньше 2 символов"),/[\@]/.test(e)||a.push("Нет знака @"),e.match(n)||a.push("Меньше 2 знаков после @"),e.includes(i)||a.push("Нет точки"),e.match(l)||a.push("Меньше 2 знаков После точки"),a}function p(s,e="",t=""){let n=document.createElement(s);return e&&n.classList.add(e),n.innerText=t||"",n}class d{constructor(){this.attributes=[]}tag(e){return this.tag=e,this}className(e){return this._className=e,this}field(e){return this._field=e,this}text(e){return this._text=e,this}html(e){return this._html=e,this}attr(e,t){return this.attributes.push([e,t]),this}get(){let e=document.createElement(this.tag);return this._text&&(e.innerText=this._text),this._html&&(e.innerHTML=this._html),this._className&&e.classList.add(this._className),this._field&&(e.dataset.field=this._field),this.attributes.forEach((t,n)=>{e.setAttribute(t[0],t[1])}),e}}async function x(s,e={},t={}){const n=V(s,e,t),i=await J(s,n).catch(l=>{console.log(l)});return z(i),O(i),i}function B(s){return!Object.keys(s).length}function V(s,e,t){if(e.phpSession=_(),t=B(t)?{"X-Requested-With":"XMLHttpRequest"}:t,!(e instanceof FormData))t["Content-Type"]="application/x-www-form-urlencoded";else return{method:"POST",body:e};return{method:"POST",headers:t,body:"params="+JSON.stringify(e,null,2)}}function H(s){return s.replaceAll("&","%26")}function J(s,e){return new Promise(async(t,n)=>{await fetch(s,e).then(async i=>{if(i.status===200){const l=await i.json();t(l)}}).catch(i=>{console.log("Fetch error"+i.message),n(i.message)})})}function O(s){const e=c(".message")[0];if(!e)return!1;s.msg?e.innerHTML=s.msg:s.success?e.innerHTML=s.success:s.error&&(e.innerHTML=s.error),c(e).removeClass("success"),c(e).removeClass("error")}function z(s){try{return s?.arr?.popup?S.show(s?.arr?.popup):O(s),s}catch{return console.log("////////////********* REQUEST ERROR ***********//////////////////////"),T(s.response)?console.log(JSON.parse(s.response)):console.log(s.response),!1}}class b extends Array{on(e,t,n){typeof t=="function"?this.forEach(i=>i.addEventListener(e,t)):this[0].querySelectorAll(t).forEach(l=>{l.addEventListener(e,n)})}value=function(){return this[0].getAttribute("value")};first=function(){return this[0]};attr=function(e,t){return t&&this[0].setAttribute(e,t),this[0].getAttribute(e)};selectedIndexValue=function(){if(this.length)return this[0].selectedOptions[0].value};options=function(){if(this.length)return this[0].options};count=function(){return this.length};text=function(){if(this.length)return this[0].innerText};checked=function(){if(this.length)return this[0].checked};getWithStyle=function(e,t){let n=[];return this.forEach(i=>{i.style[e]===t&&n.push(i)}),n};addClass=function(e){this.forEach(t=>{t.classList.add(e)})};removeClass=function(e){this.forEach(t=>{t.classList.remove(e)})};hasClass=function(e){if(this.classList.contains(e))return!0};append=function(e){this[0].appendChild(e)};find=function(e){return typeof e=="string"?this[0].querySelector(e):this[0].filter(n=>n===e)[0]};findAll=function(e){if(typeof e=="string")return this[0].querySelectorAll(e)};css=function(e,t){if(!t)return this[0].style[e];this.forEach(n=>{n.style[e]=t})};ready(e){this.some(n=>n.readyState!=null&&n.readyState!="loading")?e():document.addEventListener("DOMContentLoaded",e)}}function c(s){return typeof s=="string"||s instanceof String?new b(...document.querySelectorAll(s)):new b(s)}function K(s){let e=document.cookie.match("(^|;)?"+s+"=([^;]*)");return e?e[2]:!1}function W(s,e,t,n,i="/"){let l={s:1,m:60,h:3600,d:86400,w:604800,M:2592e3,y:31536e3},a=new Date;a.setTime(a.getTime()+t*l.unit),document.cookie=`${s}=${e}; expires=${a} path=${i}; SameSite=lax`}function X(s,e,t,n,i,l){let a=new Date(s),r=["January","February","March","April","May","June","July","August","September","October","November","December"],u=["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],h=a.getFullYear(),f=a.getMonth()+1,o=a.getDate(),m=r[a.getMonth()],g=a.getDay(),A=u[a.getDay()];return o<10&&(o="0"+o),f<10&&(f="0"+f),{yyyy:h,mm:f,dd:o,M:m,D:g,wd:A}}const Z=Object.freeze(Object.defineProperty({__proto__:null,$:c,IsJson:T,cachePage:R,createEl:p,createElement:d,debounce:L,emailValidator:U,formatter:C,fragmentDate:X,getCookie:K,getPhpSession:_,objAndFiles2FormData:P,passwordValidator:I,phoneValidator:$,popup:S,post:x,sanitizeInput:j,scrollToTop:w,setCookie:W,trimStr:E},Symbol.toStringTag,{value:"Module"})),G="querySelector",Q="querySelectorAll",y="addEventListener",ee="innerText";document.querySelectorAll.bind(document);const te=document.querySelector.bind(document);class se{constructor(e){if(!(!e|!c(e).find("option")))return this.ul=new d().tag("ul").attr("class","options").get(),this.label=new d().tag("span").get(),this.options=this.getFormattedOptions(e.querySelectorAll("option")),this.space=new d().tag("div").attr("class","space").text(this?.selectedOption?.label).get(),this.arrow=new d().tag("div").attr("class","arrow").get(),this.sel=this.createSelectTag(e),e.after(this.sel),this.label.append(this.space),this.label.append(this.arrow),this.sel.append(this.label),this.sel.append(this.ul),e.remove(),this.ul.addEventListener("click",this.handleUlClick.bind(this)),this.label.addEventListener("click",this.handleLabelClick.bind(this)),this.sel.addEventListener("blur",this.handleSelectBlur.bind(this)),this.sel.addEventListener("keydown",this.handleSelectKeydown.bind(this)),this}getFormattedOptions(e){return[...e].map(t=>{const n=new d().tag("li").text(t.label).attr("data-value",t.value).get();return t.selected&&n.classList.add("selected"),this.ul.append(n),{value:t.value,label:t.label,selected:t.selected,element:n,option:t}})}createSelectTag(e){const t=this.setSelectTag(e);return e.hasAttribute("data-field")&&t.attr("data-field",e.dataset.field),e.hasAttribute("name")&&t.attr("name",e.name),e.hasAttribute("data-relation")&&t.attr("data-relation",e.dataset.relation),e.hasAttribute("data-pivot")&&t.attr("data-pivot",e.dataset.pivot),e.firstElementChild.hasAttribute("data-relation")&&t.attr("data-relation",e.firstChild.dataset.relation),e.firstElementChild.hasAttribute("data-relationmodel")&&t.attr("data-relationmodel",e.firstChild.dataset.relationmodel),t.get()}setSelectTag(e){return new d().tag("div").className(e?.className).field(e.dataset.field).attr("select-new","").attr("data-value",this?.selectedOption?.value??"").attr("tabindex","0")}handleSelectBlur(){this.ul.classList.remove("show")}handleLabelClick(){this.ul.classList.toggle("show")}handleUlClick({target:e}){e.classList.add("selected"),this.selectedOption.element.classList.remove("selected"),this.selectValue(e.dataset.value),this.ul.classList.remove("show")}onchange(e){this.callback=e}handleSelectKeydown(e){let t,n="";if(e.code==="Space")select.ul.classList.toggle("show");else if(e.code==="ArrowUp"){const i=select.options[select.selectedOptionIndex-1];i&&select.selectValue(i.value)}else if(e.code==="ArrowDown"){const i=select.options[select.selectedOptionIndex+1];i&&select.selectValue(i.value)}else if(e.code==="Enter"||e.code==="Escape")select.ul.classList.remove("show");else{clearTimeout(t),n+=e.key,t=setTimeout(()=>{n=""},500);const i=this.options.find(l=>l.label.toLowerCase().includes(n));i&&this.sel.selectValue(i.value)}}get selectedOption(){return this.options.find(e=>e.selected)}get selectedOptionIndex(){return this.options.indexOf(this.selectedOption)}selectValue(e){const t=this.options.find(i=>i.value===e),n=this.selectedOption;n.selected=!1,t.selected=!0,this.space.innerText=t.label,this.sel.dataset.value=t.value,n.element.classList.remove("selected"),t.element.classList.add("selected"),t.element.scrollIntoView({block:"nearest"}),this.sel.dispatchEvent(new CustomEvent("customSelect.changed",{bubbles:!0,detail:{next:t,prev:n,target:this.sel}}))}}var ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ie(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function ae(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var i=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return s[n]}})}),t}class le{constructor(e=0,t=null){this.id=e??t?.parentNode?.dataset?.id??0,this.attach=t?.parentNode?.dataset?.attach??!1,this.fields={[t?.dataset?.field]:t?.dataset?.value??t?.checked??t?.innerText};const n=t?.dataset?.field,i=n?{[n]:t?.dataset?.value??t.innerText??t.checked}:{};this.relation={name:t?.dataset?.relation??t?.closest("[data-relation]")?.dataset?.relation??"",id:t?.dataset?.value??t?.dataset?.id??0,fields:i,pivot:{field:t?.dataset?.pivotField??t?.parentNode?.dataset?.pivot,value:t?.dataset?.pivotValue??t?.innerText}}}}class re{constructor(e=!1){this.admin=e;const t=c(".utils .search").first(),n=c(".search-panel").first();!t||!n||(this.openBtn=t,this.panel=n,this.text=c(n).find(".text"),this.result=c(n).find(".result"),this.closeBtn=c(n).find(".close"),this.debouncedKeyUp=L(this.find,800),this.text[y]("keyup",this.debouncedKeyUp.bind(this)),this.openBtn[y]("click",this.togglePanel.bind(this)),this.closeBtn[y]("click",this.togglePanel.bind(this)))}togglePanel(){window.ym==!0&&YM("click_search"),this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value=""}async find({target:e}){this.result.innerHTML="";const t=e.value;if(!t)return!1;const n=await x("/search",{text:t});n?.arr?.found&&(this.result.style.display="initial",n?.arr?.found.map(i=>{this.result.append(this.createLi(i))}))}createLi(e){const t=p("li"),n=p("a");n.href=this.admin?`/adminsc/product/edit/${e.id}`:`/product/${e.slug}`,e.deleted_at&&n.classList.add("deleted"),t.appendChild(n);const i=p("div","name",e.name),l=p("div","art",e.art),a=p("img");return a.src=e.mainImage,n.append(l),n.append(i),n.append(a),t.append(n),t}}export{c as $,le as D,T as I,se as S,Y as _,y as a,re as b,d as c,S as d,j as e,U as f,_ as g,I as h,ae as i,ne as j,ie as k,Q as l,L as m,K as n,W as o,x as p,G as q,te as r,w as s,P as t,X as u,ee as v,C as w,R as x,Z as y};
//# sourceMappingURL=search-uOMQXYvZ.js.map
