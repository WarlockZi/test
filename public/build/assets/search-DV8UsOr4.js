const P="modulepreload",k=function(t,e){return new URL(t,e).href},b={},Z=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),p=a?.nonce||a?.getAttribute("nonce");i=Promise.allSettled(n.map(c=>{if(c=k(c,s),c in b)return;b[c]=!0;const l=c.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(!!s)for(let d=o.length-1;d>=0;d--){const y=o[d];if(y.href===c&&(!l||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${h}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":P,l||(u.as="script"),u.crossOrigin="",u.href=c,p&&u.setAttribute("nonce",p),document.head.appendChild(u),l)return new Promise((d,y)=>{u.addEventListener("load",d),u.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})},w=()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;t>0&&(window.requestAnimationFrame(w),window.scrollTo(0,t-t/8))},O=new Intl.NumberFormat("ru",{style:"currency",currency:"RUB",minimumFractionDigits:2});function M(t,e,n=new FormData){if(self.formData=n,typeof e=="FileList")for(let s=0;s<e.length;s++)self.formData.append(s,e[s]);else self.formData.append("file",e);return self.createFormData=function(s,i=""){for(let r in s){let o=s[r],a=i?i+"["+r+"]":r;typeof o=="string"||typeof o=="number"?self.formData.append(a,o):typeof o=="object"&&self.createFormData(o,a)}},self.createFormData(t),self.formData}const E=(t,e=700)=>{let n;return function(){const s=()=>t.apply(this,arguments);clearTimeout(n),n=setTimeout(s,e)}};function T(t){try{JSON.parse(t)}catch{return!1}return!0}function R(t){var e=new RegExp("&nbsp;?","g");return t.replace(e," ")}function q(t){var e=new RegExp("\\n?","g");return t.replace(e,"")}function C(t){var e=new RegExp("\\t?","g");return t.replace(e,"")}function N(t){return t.trim()}function S(t){return t=R(t),t=q(t),t=C(t),t=N(t),t}function F(t){const e=f(t).first().outerHTML;return U(S(e))}const L={show:function(t){const e=this.el("div","popup"),n=this.el("div","popup__close");n.innerText="X";const s=this.el("div","popup__item");s.innerText=t,s.append(n),e.append(s),e.addEventListener("click",this.close,!0),document.body.append(e);const i=5e3;setTimeout(()=>{s.classList.remove("popup__item"),s.classList.add("popup-hide")},i);const r=i+950;setTimeout(()=>{s.remove()},r)},close:function({target:t}){t.classList.contains("popup__close")&&this.closest(".popup").remove()},el:function(t,e){const n=document.createElement(t);return n.classList.add(e),n}};function x(){return document.querySelector('meta[name="phpSession"]').getAttribute("content")??null}function j(t){if(!t)return;const e={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;","(":"&fp",")":"&bp","/":"&fs","\\":"&bs",";":"&sc","|":"&or","?php":"&?php",delete:"&del"},n=/[&<>'()\/\\;]/gi;return t.replace(n,i=>e[i]).trim()}function $(t){const n=[],s=/[a-zA-Z0-9\@\-\_\.А-я]*/;return t.length||n.push("Поле не должно быть пустым"),t.replace(s,"").length&&n.push("Разрешены только английские"),t.length<6&&n.push("Длина меньше 6 символов"),n}function B(t){const e=decodeURI(t),n=2,s="(.){2,}@(.){2,}",i=".",r="^(.){2,}@(.){2,}.(.){2,}$",o=[],a=/[a-zA-Z0-9\@\-\_\.]*/;return e.length||o.push("Поле не должно быть пустым"),e.replace(a,"").length&&o.push("Разрешены только английские"),e.length<n&&o.push("Длина меньше 2 символов"),/[\@]/.test(e)||o.push("Нет знака @"),e.match(s)||o.push("Меньше 2 знаков после @"),e.includes(i)||o.push("Нет точки"),e.match(r)||o.push("Меньше 2 знаков После точки"),o}function m(t,e="",n=""){let s=document.createElement(t);return e&&s.classList.add(e),s.innerText=n||"",s}class H{constructor(){this.attributes=[]}tag(e){return this.tag=e,this}className(e){return this._className=e,this}field(e){return this._field=e,this}text(e){return this._text=e,this}html(e){return this._html=e,this}attr(e,n){return this.attributes.push([e,n]),this}get(){let e=document.createElement(this.tag);return this._text&&(e.innerText=this._text),this._html&&(e.innerHTML=this._html),this._className&&e.classList.add(this._className),this._field&&(e.dataset.field=this._field),this.attributes.forEach((n,s)=>{e.setAttribute(n[0],n[1])}),e}}async function D(t,e={},n={}){const s=J(t,e,n),i=await z(t,s).catch(r=>{console.log(r)});return V(i),A(i),i}function I(t){return!Object.keys(t).length}function J(t,e,n){if(e.phpSession=x(),n=I(n)?{"X-Requested-With":"XMLHttpRequest"}:n,!(e instanceof FormData))n["Content-Type"]="application/x-www-form-urlencoded";else return{method:"POST",body:e};return{method:"POST",headers:n,body:"params="+JSON.stringify(e,null,2)}}function U(t){return t.replaceAll("&","%26")}function z(t,e){return new Promise(async(n,s)=>{await fetch(t,e).then(async i=>{if(i.status===200){const r=await i.json();n(r)}}).catch(i=>{console.log("Fetch error"+i.message),s(i.message)})})}function A(t){const e=f(".message")[0];if(!e)return!1;t.msg?e.innerHTML=t.msg:t.success?e.innerHTML=t.success:t.error&&(e.innerHTML=t.error),f(e).removeClass("success"),f(e).removeClass("error")}function V(t){try{return t?.arr?.popup?L.show(t?.arr?.popup):A(t),t}catch{return console.log("////////////********* REQUEST ERROR ***********//////////////////////"),T(t.response)?console.log(JSON.parse(t.response)):console.log(t.response),!1}}class _ extends Array{on(e,n,s){typeof n=="function"?this.forEach(i=>i.addEventListener(e,n)):this[0].querySelectorAll(n).forEach(r=>{r.addEventListener(e,s)})}value=function(){return this[0].getAttribute("value")};first=function(){return this[0]};attr=function(e,n){return n&&this[0].setAttribute(e,n),this[0].getAttribute(e)};selectedIndexValue=function(){if(this.length)return this[0].selectedOptions[0].value};options=function(){if(this.length)return this[0].options};count=function(){return this.length};text=function(){if(this.length)return this[0].innerText};checked=function(){if(this.length)return this[0].checked};getWithStyle=function(e,n){let s=[];return this.forEach(i=>{i.style[e]===n&&s.push(i)}),s};addClass=function(e){this.forEach(n=>{n.classList.add(e)})};removeClass=function(e){this.forEach(n=>{n.classList.remove(e)})};hasClass=function(e){if(this.classList.contains(e))return!0};append=function(e){this[0].appendChild(e)};find=function(e){return typeof e=="string"?this[0].querySelector(e):this[0].filter(s=>s===e)[0]};findAll=function(e){if(typeof e=="string")return this[0].querySelectorAll(e)};css=function(e,n){if(!n)return this[0].style[e];this.forEach(s=>{s.style[e]=n})};ready(e){this.some(s=>s.readyState!=null&&s.readyState!="loading")?e():document.addEventListener("DOMContentLoaded",e)}}function f(t){return typeof t=="string"||t instanceof String?new _(...document.querySelectorAll(t)):new _(t)}function W(t){let e=document.cookie.match("(^|;)?"+t+"=([^;]*)");return e?e[2]:!1}function X(t,e){const n={},s=new Date;return s.setTime(s.getTime()+t*n.unit),s}function K(t,e,n,s,i="/",r="vitexopt.ru",o=!1,a=!1){const p=X(n),c=o?"Secure":"",l=a?"HttpOnly":"";document.cookie=`${t}=${e}; expires=${p} path=${i}; SameSite=lax;${c};${l}`}function Y(t,e,n,s,i,r){let o=new Date(t),a=["January","February","March","April","May","June","July","August","September","October","November","December"],p=["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],c=o.getFullYear(),l=o.getMonth()+1,h=o.getDate(),v=a[o.getMonth()],u=o.getDay(),d=p[o.getDay()];return h<10&&(h="0"+h),l<10&&(l="0"+l),{yyyy:c,mm:l,dd:h,M:v,D:u,wd:d}}const G=Object.freeze(Object.defineProperty({__proto__:null,$:f,IsJson:T,cachePage:F,createEl:m,createElement:H,debounce:E,emailValidator:B,formatter:O,fragmentDate:Y,getCookie:W,getPhpSession:x,objAndFiles2FormData:M,passwordValidator:$,popup:L,post:D,sanitizeInput:j,scrollToTop:w,setCookie:K,trimStr:S},Symbol.toStringTag,{value:"Module"})),Q="querySelector",ee="querySelectorAll",g="addEventListener",te="innerText";document.querySelectorAll.bind(document);const ne=document.querySelector.bind(document);var se=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ie(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function oe(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var i=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:function(){return t[s]}})}),n}class re{constructor(e=0,n=null){this.id=e??n?.parentNode?.dataset?.id??0,this.attach=n?.parentNode?.dataset?.attach??!1,this.fields={[n?.dataset?.field]:n?.dataset?.value??n?.checked??n?.innerText};const s=n?.dataset?.field,i=s?{[s]:n?.dataset?.value??n.innerText??n.checked}:{};this.relation={name:n?.dataset?.relation??n?.closest("[data-relation]")?.dataset?.relation??"",id:n?.dataset?.value??n?.dataset?.id??0,fields:i,pivot:{field:n?.dataset?.pivotField??n?.parentNode?.dataset?.pivot,value:n?.dataset?.pivotValue??n?.innerText}}}}class ae{constructor(e=!1){this.admin=e;const n=f(".utils .search").first(),s=f(".search-panel").first();!n||!s||(this.openBtn=n,this.panel=s,this.text=f(s).find(".text"),this.result=f(s).find(".result"),this.closeBtn=f(s).find(".close"),this.debouncedKeyUp=E(this.find,800),this.text[g]("keyup",this.debouncedKeyUp.bind(this)),this.openBtn[g]("click",this.togglePanel.bind(this)),this.closeBtn[g]("click",this.togglePanel.bind(this)))}togglePanel(){window.ym==!0&&YM("click_search"),this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value=""}async find({target:e}){this.result.innerHTML="";const n=e.value;if(!n)return!1;const s=await D("/search",{text:n});s?.arr?.found&&(this.result.style.display="initial",s?.arr?.found.map(i=>{this.result.append(this.createLi(i))}))}createLi(e){const n=m("li"),s=m("a");s.href=this.admin?`/adminsc/product/edit/${e.id}`:`/product/${e.slug}`,e.deleted_at&&s.classList.add("deleted"),n.appendChild(s);const i=m("div","name",e.name),r=m("div","art",e.art),o=m("img");return o.src=e.mainImage,s.append(r),s.append(i),s.append(o),n.append(s),n}}export{f as $,re as D,T as I,ae as S,Z as _,g as a,L as b,H as c,j as d,B as e,$ as f,x as g,oe as h,se as i,ie as j,ee as k,E as l,K as m,W as n,ne as o,D as p,Q as q,M as r,w as s,Y as t,O as u,te as v,F as w,G as x};
//# sourceMappingURL=search-DV8UsOr4.js.map
