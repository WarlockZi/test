import{$ as a,f as c,p as u,i as l}from"./common-CxZXMxz7.js";import{a as d}from"./constants-D_Ps4z6O.js";var h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function m(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function y(i){if(i.__esModule)return i;var s=i.default;if(typeof s=="function"){var e=function t(){return this instanceof t?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};e.prototype=s.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(t){var n=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:function(){return i[t]}})}),e}class b{constructor(s=0,e=null){this.id=s??e?.parentNode?.dataset?.id??0,this.attach=e?.parentNode?.dataset?.attach??!1,this.fields={[e?.dataset?.field]:e?.dataset?.value??e?.checked??e?.innerText};const t=e?.dataset?.field,n=t?{[t]:e?.dataset?.value??e.innerText??e.checked}:{};this.relation={name:e?.dataset?.relation??e?.closest("[data-relation]")?.dataset?.relation??"",id:e?.dataset?.value??e?.dataset?.id??0,fields:n,pivot:{field:e?.dataset?.pivotField??e?.parentNode?.dataset?.pivot,value:e?.dataset?.pivotValue??e?.innerText}}}}class v{constructor(s=!1){this.admin=s;const e=a(".utils .search").first(),t=a(".search-panel").first();!e||!t||(this.openBtn=e,this.panel=t,this.text=a(t).find(".text"),this.result=a(t).find(".result"),this.closeBtn=a(t).find(".close"),this.debouncedKeyUp=c(this.find,800),this.text[d]("keyup",this.debouncedKeyUp.bind(this)),this.openBtn[d]("click",this.togglePanel.bind(this)),this.closeBtn[d]("click",this.togglePanel.bind(this)))}togglePanel(){window.ym==!0&&YM("click_search"),this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value=""}async find({target:s}){this.result.innerHTML="";const e=s.value;if(!e)return!1;const t=await u("/search",{text:e});t?.arr?.found&&(this.result.style.display="initial",t?.arr?.found.map(n=>{this.result.append(this.createLi(n))}))}createLi(s){const e=l("li"),t=l("a");t.href=this.admin?`/adminsc/product/edit/${s.id}`:`/product/${s.slug}`,s.deleted_at&&t.classList.add("deleted"),e.appendChild(t);const n=l("div","name",s.name),r=l("div","art",s.art),o=l("img");return o.src=s.mainImage,t.append(r),t.append(n),t.append(o),e.append(t),e}}export{b as D,v as S,m as a,h as c,y as g};
//# sourceMappingURL=search-CAnQUWOV.js.map
