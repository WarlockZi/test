{"version":3,"mappings":"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","names":["QuillConst","AdminQuill","selector","options","el","$","Quill","ael","debounce","post","IsJson","parent","model","id","dto","DTO","AdminProductDescrioption","AdminProductSeoArticle","QuillFactory","type","Product","product","qs","units","unit","SelectNew","dragNdrop","Dnd","Fields","__vitePreload","Props","cardPanel","files","target","obj","data","objAndFiles2FormData","src","mainImage"],"ignoreList":[],"sources":["../../src/components/quill/QuillConstans.js","../../src/components/quill/AdminQuill.js","../../src/components/quill/AdminProductDescrioption.js","../../src/components/quill/AdminProductSeoArticle.js","../../src/components/quill/QuillFactory.js","../../src/Admin/Product/Product.js"],"sourcesContent":["export const QuillConst = {\r\n   'ADMIN_PRODUCT_DESCRIPTION': 'description',\r\n   'ADMIN_PRODUCT_SEO_ARTICLE': 'seo-article',\r\n}","import {$, debounce, IsJson, post} from \"@src/common.js\";\r\nimport DTO from \"@src/Admin/DTO.js\";\r\nimport Quill from \"quill\";\r\nimport {ael} from \"@src/constants.js\";\r\n\r\nexport default class AdminQuill {\r\n   constructor(selector, options) {\r\n      const el = $(selector).first()\r\n      if (!el) return\r\n      this.el = el\r\n      this.autosave = options?.autosave || true\r\n      this.editable = options?.editable || true\r\n      this.theme = options?.theme || 'snow'\r\n      this.placeholder = options?.theme || 'Начните писать...'\r\n\r\n      this.options = this.setOptions()\r\n      this.quill = new Quill(selector, this.options);\r\n      this.dto = this.setDTO()\r\n      this.setContent()\r\n      if (this.autosave) this.el[ael]('keyup', debounce(this.save.bind(this)))\r\n   }\r\n\r\n   async save() {\r\n      this.dto.relation.fields[this.el?.dataset?.field]\r\n         = JSON.stringify(this.quill.getContents())\r\n      const res = await post(`/adminsc/${this.dto.model}/updateOrCreate`, this.dto)\r\n   }\r\n\r\n   setContent() {\r\n      if (IsJson(this.el.innerText)) {\r\n         this.quill.setContents(JSON.parse(this.el.innerText + '\\n'))\r\n      } else {\r\n         this.quill.setText(this.el.innerText)\r\n      }\r\n   }\r\n\r\n\r\n   setDTO() {\r\n      const parent = this.el.closest(`[data-model]`)\r\n      const model = parent?.dataset.model\r\n      const id = parent.dataset.id\r\n      const dto = new DTO(id)\r\n      dto.model = model\r\n      dto.relation.name = this.el.dataset.relation\r\n      return dto\r\n   }\r\n\r\n   setToolbar() {\r\n      return [\r\n         ['bold', 'italic', 'underline', 'strike'],        // toggled buttons\r\n         ['blockquote'],\r\n\r\n         // [{ 'header': 1 }, { 'header': 2 }],               // custom button values\r\n         [{'list': 'ordered'}, {'list': 'bullet'}],\r\n         [{'script': 'sub'}, {'script': 'super'}],      // superscript/subscript\r\n         [{'indent': '-1'}, {'indent': '+1'}],          // outdent/indent\r\n         // [{ 'direction': 'rtl' }],                         // text direction\r\n\r\n         [{'size': ['small', false, 'large', 'huge']}],  // custom dropdown\r\n         // [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\r\n\r\n         [{'color': []}, {'background': []}],          // dropdown with defaults from theme\r\n         [{'font': []}],\r\n         [{'align': []}],\r\n\r\n         ['clean']                                         // remove formatting button\r\n      ];\r\n   }\r\n\r\n   setOptions() {\r\n      return {\r\n         theme: this.theme,\r\n         // theme: 'bubble',\r\n         placeholder: this.placeholder,\r\n         modules: {\r\n            toolbar: this.setToolbar()\r\n         },\r\n      };\r\n   }\r\n}","import {createElement} from \"@src/common.js\";\r\nimport AdminQuill from \"@src/components/quill/AdminQuill.js\";\r\n\r\nexport default class AdminProductDescrioption extends AdminQuill{\r\n   constructor(selector, options) {\r\n      super(selector, options);\r\n   }\r\n}","import {createElement} from \"@src/common.js\";\r\nimport AdminQuill from \"@src/components/quill/AdminQuill.js\";\r\n\r\nexport default class AdminProductSeoArticle extends AdminQuill{\r\n   constructor(selector, options) {\r\n      super(selector, options);\r\n   }\r\n}","import Quill from \"quill\";\r\nimport {QuillConst} from \"@src/components/quill/QuillConstans.js\";\r\nimport AdminProductDescrioption from \"@src/components/quill/AdminProductDescrioption.js\";\r\nimport AdminProductSeoArticle from \"@src/components/quill/AdminProductSeoArticle.js\";\r\n\r\nexport default class QuillFactory {\r\n   constructor() {\r\n      this.quill = new Quill();\r\n      debugger\r\n   }\r\n   static create(selector, type, options){\r\n      if (type === QuillConst.ADMIN_PRODUCT_DESCRIPTION) {\r\n         return new AdminProductDescrioption(selector, options)\r\n      }else if (type === QuillConst.ADMIN_PRODUCT_SEO_ARTICLE) {}\r\n         return new AdminProductSeoArticle(selector, options)\r\n\r\n   }\r\n\r\n}","import './product.scss'\r\nimport './units.scss'\r\nimport {objAndFiles2FormData, post, $} from '../../common.js'\r\nimport './Props.js'\r\nimport {qs} from '../../constants'\r\nimport MyQuill from \"../../components/quill/MyQuill.js\";\r\nimport SelectNew from \"@src/components/select/SelectNew.js\";\r\nimport DTO from \"@src/Admin/DTO.js\";\r\nimport QuillFactory from \"@src/components/quill/QuillFactory.js\";\r\nimport {QuillConst} from \"@src/components/quill/QuillConstans.js\";\r\n\r\nexport default class Product {\r\n   constructor() {\r\n      const product = document[qs](`.item-wrap[data-model='product']`)\r\n      if (!product) return false;\r\n      this.product = product\r\n      this.model = 'product'\r\n      this.id = $(this.product).find(`[data-field='id']`).innerText\r\n\r\n      this.setProps().then()\r\n\r\n      this.setDragNDrop().then()\r\n      this.setCardPanel().then()\r\n\r\n\r\n      QuillFactory.create('.txt', QuillConst.ADMIN_PRODUCT_DESCRIPTION);\r\n      QuillFactory.create('#seo-article', QuillConst.ADMIN_PRODUCT_SEO_ARTICLE);\r\n      // new MyQuill('#seo_article', true,true,true);\r\n      this.setUnitsCustomSelects()\r\n   }\r\n   // dto(){\r\n   //    return (new DTO(this.id)).model = 'product'\r\n   // }\r\n   setUnitsCustomSelects(){\r\n      const units = $('.units [custom-select]');\r\n      [].forEach.call(units, (unit)=>{\r\n         new SelectNew(unit)\r\n      })\r\n   }\r\n\r\n   async setDragNDrop() {\r\n      const dragNdrop = document[qs]('[dnd]')\r\n      if (dragNdrop) {\r\n         const {default: Dnd} = await import(\"../../components/dnd/dnd\")\r\n         const dnd = await new Dnd(dragNdrop, this.addMainImage)\r\n      }\r\n   }\r\n\r\n   async setFields() {\r\n      const {default: Fields} = await import(\"./Fields.js\")\r\n      new Fields(this.product)\r\n   }\r\n\r\n   async setProps() {\r\n      const {default: Props} = await import(\"./Props.js\")\r\n      new Props(this.product)\r\n   }\r\n\r\n\r\n   async setCardPanel() {\r\n      const cardPanel = document[qs](`.cardPanel`)\r\n      if (cardPanel) {\r\n         const {default: cardPanel} = await import(\"./../../share/card_panel/card_panel\")\r\n         new cardPanel()\r\n      }\r\n   }\r\n\r\n   async addMainImage(files, target) {\r\n      const obj = {productId: target.closest('.item-wrap').dataset.id,};\r\n      const data = objAndFiles2FormData(obj, files[0]);\r\n\r\n      const res = await post('/adminsc/product/saveMainImage', data);\r\n      const src = res?.arr[0];\r\n      if (src) {\r\n         const mainImage = target.closest('.dnd-container').querySelector('img');\r\n         mainImage.removeAttribute(\"src\");\r\n         mainImage.setAttribute(\"src\", src)\r\n      }\r\n   }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n"],"file":"assets/Product-1RhGLJgb.js"}