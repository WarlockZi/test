{"version":3,"file":"Promotion-DLPwRdLq.js","sources":["../../src/Promotions/Promotion.js"],"sourcesContent":["import \"./promotion.scss\";\nimport { $, post } from \"../common\";\nimport SelectNew from \"../components/select/SelectNew\";\n\nexport default class Promotion {\n  constructor() {\n    this.$promotion = $(\".promotion-edit\").first();\n    if (!this.$promotion) return;\n    this.updateUrl = \"/adminsc/promotion/updateOrCreate\";\n    this.id = $(this.$promotion).find(`[data-field='id']`).innerText;\n    this.$count = $(`[data-field='count']`).first();\n\n    this.$unit = $(\"[select-new].unit\").first();\n    new SelectNew(this.$unit);\n    $(`[data-field=\"unit\"]`)\n      .first()\n      .addEventListener(\"customSelect.changed\", this.unitChanged.bind(this));\n\n    this.$newPrice = $(`[data-field=\"new_price\"]`).first();\n\n    this.$activeTill = $(`[data-field='active-till']`).first();\n    this.$activeTill.addEventListener(\n      \"change\",\n      this.activetillChanged.bind(this),\n    );\n  }\n\n  unitChanged(customEvent) {\n    let data = this.dto(this);\n    data.unit_id = customEvent.detail.next.value;\n    let res = post(this.updateUrl, data);\n  }\n\n  async activetillChanged({ target }) {\n    let data = this.dto(this);\n    data.active_till = target.value;\n    let res = await post(this.updateUrl, data);\n    if (res) {\n    }\n  }\n\n  dto(self) {\n    return {\n      id: this.id,\n    };\n  }\n}\n"],"names":["Promotion","$","SelectNew","customEvent","data","post","target","self"],"mappings":"yJAIe,MAAMA,CAAU,CAC7B,aAAc,CACZ,KAAK,WAAaC,EAAE,iBAAiB,EAAE,MAAO,EACzC,KAAK,aACV,KAAK,UAAY,oCACjB,KAAK,GAAKA,EAAE,KAAK,UAAU,EAAE,KAAK,mBAAmB,EAAE,UACvD,KAAK,OAASA,EAAE,sBAAsB,EAAE,MAAO,EAE/C,KAAK,MAAQA,EAAE,mBAAmB,EAAE,MAAO,EAC3C,IAAIC,EAAU,KAAK,KAAK,EACxBD,EAAE,qBAAqB,EACpB,MAAK,EACL,iBAAiB,uBAAwB,KAAK,YAAY,KAAK,IAAI,CAAC,EAEvE,KAAK,UAAYA,EAAE,0BAA0B,EAAE,MAAO,EAEtD,KAAK,YAAcA,EAAE,4BAA4B,EAAE,MAAO,EAC1D,KAAK,YAAY,iBACf,SACA,KAAK,kBAAkB,KAAK,IAAI,CACjC,EACL,CAEE,YAAYE,EAAa,CACvB,IAAIC,EAAO,KAAK,IAAI,IAAI,EACxBA,EAAK,QAAUD,EAAY,OAAO,KAAK,MAC7BE,EAAK,KAAK,UAAWD,CAAI,CACvC,CAEE,MAAM,kBAAkB,CAAE,OAAAE,GAAU,CAClC,IAAIF,EAAO,KAAK,IAAI,IAAI,EACxBA,EAAK,YAAcE,EAAO,MAChB,MAAMD,EAAK,KAAK,UAAWD,CAAI,CAG7C,CAEE,IAAIG,EAAM,CACR,MAAO,CACL,GAAI,KAAK,EACV,CACL,CACA"}