const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/login-CnIrrZqb.js","assets/common-Boy4RmlM.js","assets/modal-Cmk2ACTR.js","assets/modal-D2zHcDFg.css"])))=>i.map(i=>d[i]);
import{$ as s,g as p,s as w,p as i,t as l,v as u,_ as f}from"./common-Boy4RmlM.js";/* empty css              */let c=s(".search input").first();c&&c.addEventListener("input",function(){v(c)});async function v(a){let t=a.parentNode,e=s(t).find(".search__result");if(a.value.length<1){e&&(e.innerHTML="");return}let n=await fetch("/search?q="+a.value);n=await n.json(n),e.childNodes.length!==0&&(e.innerHTML=""),n.map(r=>{let o=document.createElement("a");o.href=r.alias,o.innerHTML=`<img src='/pic/${r.preview_pic}' alt='${r.name}'>`+r.name,e.appendChild(o)}),s("body").on("click",function(r){e&&r.target!==e&&(e.innerHTML="")})}function g(){s(".password-control")&&s(".password-control").on("click",t);function t({target:e}){const n=e.parentNode.querySelector("input");n.getAttribute("type")==="password"?n.setAttribute("type","text"):n.setAttribute("type","password"),e.classList.toggle("view")}}h("cn");s("#cn-accept-cookie").on("click",_);function h(a){p(a)?s("#cookie-notice").css("bottom","-100%"):s("#cookie-notice").css("bottom","0")}function _(){w("cn",1,3),s("#cookie-notice").css("bottom","-100%")}s(".changepassword").on("click",async function(a){let t={old_password:s('[name="old_password"]')[0].value,new_password:s('[name="new_password"]')[0].value},e=s(".message")[0],n=await i("/auth/changepassword",t);n.success?(e.innerText=n.success,s(e).addClass("success"),s(e).removeClass("error")):n.error&&(e.innerText=n.error,s(e).addClass("error"),s(e).removeClass("success"))});let d=s("[data-auth='register']")[0];d&&s(d).on("click",L);function L({target:a}){let t=l(s("input[type = email]")[0].value),e=l(s("input[name = password]")[0].value);a.classList.contains("submit__button")&&b(t,e)&&k(t,e)}function m(a){let t=s(".message")[0];t.innerText="",t.innerText=t.innerText+a,s(t).removeClass("success"),s(t).addClass("error")}function b(a,t){let e=u.email(a);return e||(e=u.password(t),e)?(m(e),!1):!0}async function k(a,t){const e=s(".message")[0],n={email:a,password:t,surName:s("[name='surName']")[0].value,name:s("[name='name']")[0].value},r=await i("/auth/register",n);r?.arr?.success==="confirm"?(e.classList.remove("error"),e.classList.add("success"),e.innerHTML="-Пользователь зарегистрирован.<br>-Для подтверждения регистрации зайдите на почту, <bold>email</bold>.<br> -Перейдите по ссылке в письме."):r.msg==="mail exists"?(e.innerHTML="Эта почта уже зарегистрирована. Войдите в систему по кнопке внизу Войти или, если не помните пароль, восстановите пароль по кнопке Забыл пароль",e.classList.remove("success"),e.classList.add("error")):(e.innerHTML=r.msg,e.classList.remove("success"),e.classList.add("error"))}let y=s('[data-auth="returnpass"]')[0];y&&s(".submit__button").on("click",async function(a){let t=s('input[type="email"]')[0].value;await i("/auth/returnpass",{email:t})&&(window.location="/auth/login")});s("#save").on("click",async function(a){a.preventDefault();let t={name:s('[name = "name"]')[0].value,surName:s('[name = "surName"]')[0].value,middleName:s('[name = "middleName"]')[0].value,birthDate:s('[name = "birthDate"]')[0].value,phone:s('[name = "phone"]')[0].value,sex:void 0};await i("/user/edit",t)});const T=s("[data-auth='login']").first();if(T){const{default:a}=await f(async()=>{const{default:t}=await import("./login-CnIrrZqb.js");return{default:t}},__vite__mapDeps([0,1]));new a}if(s(".modal-wrapper")){const{default:a}=await f(async()=>{const{default:t}=await import("./modal-Cmk2ACTR.js");return{default:t}},__vite__mapDeps([2,1,3]));new a}g();
