{"version":3,"file":"MyQuill-DC8s65s0.js","sources":["../../src/components/quill/MyQuill.js"],"sourcesContent":["import { $, IsJson, post } from \"../../common\";\r\nimport Quill from \"quill\";\r\nimport \"quill/dist/quill.core.css\";\r\nimport \"quill/dist/quill.snow.css\";\r\nimport \"quill/dist/quill.bubble.css\";\r\nimport DTO from \"@src/Admin/DTO.js\";\r\n\r\nexport default class MyQuill {\r\n  constructor(\r\n    selector = \"#detail-text\",\r\n    autosave = false,\r\n    toolbar = false,\r\n    editable = false,\r\n    theme = \"snow\",\r\n    dto = null,\r\n  ) {\r\n    const el = $(selector).first();\r\n    if (!el) return false;\r\n    this.el = el;\r\n    this.model =\r\n      $(\"[data-model]\").first()?.dataset?.model ?? dto?.model ?? null;\r\n    this.id = this.model?.dataset?.id ?? dto?.id ?? null;\r\n    this.button = $(\"#button\").first();\r\n    this.selector = selector;\r\n\r\n    this.autosave = autosave;\r\n    this.editable = editable;\r\n    this.contents = $(selector).first().innerText ?? \"\\\\n\";\r\n\r\n    this.toolbar = toolbar ? this.setToolbar() : false;\r\n    this.options = this.setOptions();\r\n    this.init();\r\n  }\r\n\r\n  setToolbar() {\r\n    return [\r\n      [\"bold\", \"italic\", \"underline\", \"strike\"], // toggled buttons\r\n      [\"blockquote\"],\r\n\r\n      // [{ 'header': 1 }, { 'header': 2 }],               // custom button values\r\n      [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n      [{ script: \"sub\" }, { script: \"super\" }], // superscript/subscript\r\n      [{ indent: \"-1\" }, { indent: \"+1\" }], // outdent/indent\r\n      // [{ 'direction': 'rtl' }],                         // text direction\r\n\r\n      [{ size: [\"small\", false, \"large\", \"huge\"] }], // custom dropdown\r\n      // [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\r\n\r\n      [{ color: [] }, { background: [] }], // dropdown with defaults from theme\r\n      [{ font: [] }],\r\n      [{ align: [] }],\r\n\r\n      [\"clean\"], // remove formatting button\r\n    ];\r\n  }\r\n\r\n  setOptions() {\r\n    return {\r\n      theme: \"snow\",\r\n      // theme: 'bubble',\r\n      placeholder: \"Начните писать...\",\r\n      modules: {\r\n        toolbar: this.toolbar,\r\n      },\r\n    };\r\n  }\r\n\r\n  dto() {\r\n    return new DTO(this.id, this.el);\r\n  }\r\n\r\n  init() {\r\n    this.quill = new Quill(this.selector, this.options);\r\n    if (IsJson(this.contents)) {\r\n      const json = JSON.parse(this.contents + \"\\n\");\r\n      this.quill.setContents(json);\r\n    } else {\r\n      this.quill.setText(this.contents);\r\n    }\r\n    this.quill.enable(this.editable);\r\n    if (this.autosave) {\r\n      this.quill.on(\r\n        \"text-change\",\r\n        function (delta) {\r\n          // const content = JSON.stringify(quill.getContents())\r\n          post(`/adminsc/${this.model}/updateOrCreate`, this.dto());\r\n        }.bind(this),\r\n      );\r\n    }\r\n\r\n    if (this.button) {\r\n      this.button.addEventListener(\"click\", function () {\r\n        const productId = $(`.item-wrap[data-model='product']`)[0].dataset.id;\r\n        const txt = JSON.stringify(this.quill.getContents());\r\n        post(\"/adminsc/product/updateOrCreate\", {\r\n          txt,\r\n          id: productId,\r\n        }).then();\r\n      });\r\n    }\r\n  }\r\n}\r\n"],"names":["MyQuill","selector","autosave","toolbar","editable","theme","dto","el","$","DTO","Quill","IsJson","json","delta","post","productId","txt"],"mappings":"wIAOe,MAAMA,CAAQ,CAC3B,YACEC,EAAW,eACXC,EAAW,GACXC,EAAU,GACVC,EAAW,GACXC,EAAQ,OACRC,EAAM,KACN,CACA,MAAMC,EAAKC,EAAEP,CAAQ,EAAE,MAAK,EAC5B,GAAI,CAACM,EAAI,MAAO,GAChB,KAAK,GAAKA,EACV,KAAK,MACHC,EAAE,cAAc,EAAE,MAAO,GAAE,SAAS,OAASF,GAAK,OAAS,KAC7D,KAAK,GAAK,KAAK,OAAO,SAAS,IAAMA,GAAK,IAAM,KAChD,KAAK,OAASE,EAAE,SAAS,EAAE,MAAK,EAChC,KAAK,SAAWP,EAEhB,KAAK,SAAWC,EAChB,KAAK,SAAWE,EAChB,KAAK,SAAWI,EAAEP,CAAQ,EAAE,MAAO,EAAC,WAAa,MAEjD,KAAK,QAAUE,EAAU,KAAK,WAAU,EAAK,GAC7C,KAAK,QAAU,KAAK,aACpB,KAAK,KAAI,CACV,CAED,YAAa,CACX,MAAO,CACL,CAAC,OAAQ,SAAU,YAAa,QAAQ,EACxC,CAAC,YAAY,EAGb,CAAC,CAAE,KAAM,SAAS,EAAI,CAAE,KAAM,QAAQ,CAAE,EACxC,CAAC,CAAE,OAAQ,KAAK,EAAI,CAAE,OAAQ,OAAO,CAAE,EACvC,CAAC,CAAE,OAAQ,IAAI,EAAI,CAAE,OAAQ,IAAI,CAAE,EAGnC,CAAC,CAAE,KAAM,CAAC,QAAS,GAAO,QAAS,MAAM,EAAG,EAG5C,CAAC,CAAE,MAAO,CAAE,CAAA,EAAI,CAAE,WAAY,CAAE,CAAA,CAAE,EAClC,CAAC,CAAE,KAAM,CAAA,EAAI,EACb,CAAC,CAAE,MAAO,CAAA,EAAI,EAEd,CAAC,OAAO,CACd,CACG,CAED,YAAa,CACX,MAAO,CACL,MAAO,OAEP,YAAa,oBACb,QAAS,CACP,QAAS,KAAK,OACf,CACP,CACG,CAED,KAAM,CACJ,OAAO,IAAIM,EAAI,KAAK,GAAI,KAAK,EAAE,CAChC,CAED,MAAO,CAEL,GADA,KAAK,MAAQ,IAAIC,EAAM,KAAK,SAAU,KAAK,OAAO,EAC9CC,EAAO,KAAK,QAAQ,EAAG,CACzB,MAAMC,EAAO,KAAK,MAAM,KAAK,SAAW;AAAA,CAAI,EAC5C,KAAK,MAAM,YAAYA,CAAI,CACjC,MACM,KAAK,MAAM,QAAQ,KAAK,QAAQ,EAElC,KAAK,MAAM,OAAO,KAAK,QAAQ,EAC3B,KAAK,UACP,KAAK,MAAM,GACT,cACA,SAAUC,EAAO,CAEfC,EAAK,YAAY,KAAK,KAAK,kBAAmB,KAAK,IAAG,CAAE,CAClE,EAAU,KAAK,IAAI,CACnB,EAGQ,KAAK,QACP,KAAK,OAAO,iBAAiB,QAAS,UAAY,CAChD,MAAMC,EAAYP,EAAE,kCAAkC,EAAE,CAAC,EAAE,QAAQ,GAC7DQ,EAAM,KAAK,UAAU,KAAK,MAAM,YAAW,CAAE,EACnDF,EAAK,kCAAmC,CACtC,IAAAE,EACA,GAAID,CACd,CAAS,EAAE,KAAI,CACf,CAAO,CAEJ,CACH"}