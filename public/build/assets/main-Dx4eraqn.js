const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/search-Dnb8tly4.js","assets/constants-ufk865tC.js","assets/modal-CEvgv6So.js","assets/modal-WKCBC1Wf.css","assets/category-B8vEu5wp.js","assets/shippableUnitsTable-C7jBd-yh.js","assets/MyQuill-C0Uqs4nx.js","assets/MyQuill-GClCj9AP.css","assets/Product-CBpsKgr7.js","assets/card_panel-CN0WjdZI.js","assets/card_panel-ebMfmDJg.css","assets/Product-CTChWsCU.css","assets/Promotion-DdMHf4I5.js","assets/Promotion-B7Spb30Y.css","assets/cart-t74uq7nU.js"])))=>i.map(i=>d[i]);
import{$ as g,s as k,c,p as m,b as w,q as d,g as x,e as I,h as q,_ as h}from"./constants-ufk865tC.js";import P from"./modal-CEvgv6So.js";const _=g(".hoist").first();_&&_.addEventListener("click",function(){k()});function B(){const s=g(".header").first();document.addEventListener("scroll",t.bind(s),{passive:!0});function t(){s&&(window.scrollY>30?s.classList.add("short"):s.classList.remove("short"))}}function T(){const s=g(".header-catalog-menu__wrap").first();if(!s)return!1;g(s).on("click",".arrow",({target:t})=>{g(t.closest("li")).find("ul").classList.toggle("visible")})}function R(){const s={rootMargin:"10px",threshold:[1]},t=Array.from(document.querySelectorAll(".typing-animation")),e=function(r,o){r.forEach(a=>{a.target.classList.toggle("typing-animation")})},n=new IntersectionObserver(e,s);t.forEach(r=>n.observe(r)),s.rootMargin="10px",s.threshold=[1],Array.from(document.querySelectorAll(".step"));const i=Array.from(document.querySelectorAll(".static-container")),l=function(r,o){r.forEach(a=>{a.isIntersecting?a.target.querySelector(".step").classList.remove("fade-in"):a.target.querySelector(".step").classList.add("fade-in")})},u=new IntersectionObserver(l,s);i.forEach(r=>u.observe(r))}class S{constructor(){this.navExpand=[].slice.call(document.querySelectorAll(".nav-expand")),this.backLink=`<li class="nav-item">
	<a class="nav-link nav-back-link" href="javascript:;">
		Назад
	</a>
</li>`,this.navExpand.forEach(t=>{t.querySelector(".nav-expand-content").insertAdjacentHTML("afterbegin",this.backLink),t.querySelector(".nav-link").addEventListener("click",()=>t.classList.add("active")),t.querySelector(".nav-back-link").addEventListener("click",()=>t.classList.remove("active"))}),this.ham=document.getElementById("ham"),this.ham&&this.ham.addEventListener("click",function(){document.body.classList.toggle("nav-is-toggled")})}}class A{constructor(t){const{_type:e,_onKeyUp:n,_onInput:i,_className:l,_hidden:u,_required:r,_name:o,_autocomplete:a,_pattern:v,_badgeWidth:b,_id:E,_placeholder:y,_errorEl:p}=t;if(this.container=new c().tag("div").attr("class","input-container").get(),this.input=document.createElement("input"),n&&this.input.addEventListener("keyup",n.bind(this)),i&&this.input.addEventListener("input",i.bind(this)),e&&(this.input.type=e,e==="password"&&this.showPass()),this.input.placeholder=" ",l&&this.input.classList.add(l),u&&(this.input.hidden=u),r&&(this.input.required=r),a&&(this.input.autocomplete=a),o&&(this.input.name=o),v&&(this.input.pattern=v),this.input.id=E,this.labelBadge=new c().tag("div").attr("class","badge").get(),this.labelBadge.style.width=b,this.label=new c().tag("label").text(y).get(),this.label.htmlFor=E,this.container.append(this.input),this.container.append(this.labelBadge),this.container.append(this.label),p){if(this.errorEl=new c().tag("div"),p.startsWith("#")){const f=p.replace("#","");this.errorEl=this.errorEl.attr("id",f)}else if(p.startsWith(".")){const f=p.replace(".","");this.errorEl=this.errorEl.attr("class",f)}this.errorEl=this.errorEl.get(),this.container.append(this.errorEl)}return this.container}showPass(){const t=new c().tag("span").attr("class","password-control").get();t.addEventListener("click",function({target:e}){e.parentNode.querySelector("input").type=e.parentNode.querySelector("input").type==="password"?"text":"password",e.classList.toggle("view")}),this.container.append(t)}}class L{constructor(){this._type="text"}id(t){return this._id=t,this}type(t){return this._type=t,this}hidden(){return this._hidden=!0,this}required(){return this._required=!0,this}name(t){return this._name=t,this}autocomplete(){return this._autocomplete=!0,this}placeholder(t){return this._placeholder=t,this}class(t){return this._class=t,this}pattern(t){let e=new RegExp(t);return this._pattern=e.source,this}badgeWidth(t){return this._badgeWidth=t,this}errorEl(t){return this._errorEl=t,this}onKeyUp(t){return this._onKeyUp=t,this}onInput(t){return this._onInput=t,this}get(){return new A(this)}}class M{constructor(){return{1:[this.getLoginRows()],2:[this.getRegisterRows()],3:[this.getForgotRows()]}}getLoginRows(){return["Вход",this.getEmailInput(),this.getPasswordInput(),this.getLoginButton(),this.createLinks("login"),this.getYandexAuth(),this.getLoginWarning()]}getRegisterRows(){return["Регистрация",this.getEmailInput(),this.getPasswordInput(),this.getPhoneInput(),this.getRegisterButton(),this.createLinks("register"),this.getLoginWarning()]}getForgotRows(){return["Восстановление пароля",this.getEmailInput(),this.getForgotButton(),this.createLinks("forgot"),this.getLoginWarning()]}getEmailInput(){return new L().id("email").required().name("email").type("text").onInput(this.onInputEmail.bind(this)).errorEl("#emailError").badgeWidth("55px").placeholder("email").get()}getPasswordInput(){return new L().id("password").required().name("password").type("password").errorEl("#emailError").onInput(this.onInputPassword.bind(this)).badgeWidth("65px").placeholder("пароль").get()}getPhoneInput(){return new L().id("phone").required().name("phone").type("text").errorEl("#emailError").badgeWidth("65px").placeholder("телефон").get()}getLoginButton(){const t=this.createButton("Войти");return t.addEventListener("click",this.login.bind(this)),t}getRegisterButton(){const t=this.createButton("Регистрация");return t.addEventListener("click",this.register.bind(this)),t}getForgotButton(){const t=this.createButton("Забыл пароль");return t.addEventListener("click",this.forgot.bind(this)),t}getLoginLink(){const t=this.createLink("Войти",1);return t.addEventListener("click",this.switch.bind(this)),t}getRegisterLink(){const t=this.createLink("Регистрация",2);return t.addEventListener("click",this.switch.bind(this)),t}getForgotLink(){const t=this.createLink("Забыл пароль",3);return t.addEventListener("click",this.switch.bind(this)),t}getYandexAuth(){return new c().tag("a").attr("href","https://oauth.yandex.ru/authorize?client_id=1cacd478c22b49c1a22e59ac811d0fc0&redirect_uri=https://vitexopt.ru/auth/yandex&response_type=code&state=132").attr("class","yandex").attr("title","Авторизация Яндекс").get()}getLoginWarning(){return new c().tag("p").text("Оставляя свои данные, вы соглашаетесь с политикой конфиденциальности").get()}createLink(t,e){return new c().tag("div").attr("class","link").attr("data-target",e).text(t).get()}createLinks(t){const e=new c().tag("div").attr("class","row").get();return t==="register"?(e.appendChild(this.getLoginLink()),e.appendChild(this.getForgotLink())):t==="login"?(e.appendChild(this.getRegisterLink()),e.appendChild(this.getForgotLink())):t==="forgot"&&(e.appendChild(this.getLoginLink()),e.appendChild(this.getRegisterLink())),e}switch({target:t},e){const n=new Event("modal.switch",{bubbles:!0});t.dispatchEvent(n)}createButton(t){return new c().tag("button").attr("type","submit").attr("class","button").attr("id","forgot").text(t).get()}async login(t){const e=this.authDTO(t),n=await m("/auth/login",e);if(n?.arr?.role){const i=t.target.closest(".content");i.innerHTML="Вход выполнен";const l=n?.arr?.id;localStorage.setItem("id",l),n?.arr?.role==="employee"?window.location="/adminsc":n?.arr?.role==="user"?window.location="/auth/profile":n?.error}}async register(t){const e=await m("/auth/register",this.authDTO(t)),n=t.target.closest(".content");e?.arr?.success?n.innerHTML="-Пользователь зарегистрирован.<br>-Для подтверждения регистрации зайдите на почту, <bold>email.</bold>-Перейдите по ссылке в письме.":e?.arr?.error==="mail exists"?n.innerHTML="Эта почта уже зарегистрирована. Войдите в систему по кнопке внизу Войти или, если не помните пароль, восстановите пароль по кнопке Забыл пароль":n.innerHTML=e?.arr?.error}async forgot(t){const e=this.authDTO(t);if((await m("/auth/returnpass",e))?.arr?.success){const i=t.target.closest(".content");i.innerHTML="Новый пароль отпарвлен на почту"}}authDTO(t){t.preventDefault();const e=t.target.closest(".box"),n=w(e[d]("input#email")?.value)??null,i=w(e[d]("input#password")?.value)??null,l=w(e[d]("input#phone")?.value)??null,u=x()??null;return{email:n,password:i,phone:l,sess:u}}onInputEmail({target:t}){const e=t.closest(".input-container"),n=t.value,i=I(n);e.querySelector("#emailError").innerText=i.length?i[0]:"",e.querySelector("label").style.color=i.length?"#dc2f55":"#2fdcdb",t.style.outline=i.length?"solid 1px #dc2f55":"solid 1px #2fdcdb"}onInputPassword({target:t}){const e=t.closest(".input-container"),n=t.value,i=q(n);e.querySelector("#emailError").innerText=i.length?i[0]:"",e.querySelector("label").style.color=i.length?"#dc2f55":"#2fdcdb",t.style.outline=i.length?"solid 1px #dc2f55":"solid 1px #2fdcdb"}}document.addEventListener("DOMContentLoaded",async function(){if(R(),T(),B(),window.location.pathname.includes("adminsc"))return!1;if(document[d](".utils .search")){const{default:r}=await h(async()=>{const{default:o}=await import("./search-Dnb8tly4.js");return{default:o}},__vite__mapDeps([0,1]));new r}if(new P({triggers:[".guest-menu","#cartLogin"],boxes:new M}),new S,document[d](".modal")){const{default:r}=await h(async()=>{const{default:o}=await import("./modal-CEvgv6So.js");return{default:o}},__vite__mapDeps([2,1,3]));new r}if(document[d](".category")){const{default:r}=await h(async()=>{const{default:o}=await import("./category-B8vEu5wp.js");return{default:o}},__vite__mapDeps([4,1,5,6,7]));new r}if(document[d](".product-card")){const{default:r}=await h(async()=>{const{default:o}=await import("./Product-CBpsKgr7.js");return{default:o}},__vite__mapDeps([8,1,9,10,5,6,7,11]));new r}if(document[d](".promotions-index")){const{default:r}=await h(async()=>{const{default:o}=await import("./Promotion-DdMHf4I5.js").then(a=>a.a);return{default:o}},__vite__mapDeps([12,1,13]));new r}if(document[d](".user-content .cart")){const{default:r}=await h(async()=>{const{default:o}=await import("./cart-t74uq7nU.js");return{default:o}},__vite__mapDeps([14,1,5]));new r}});
//# sourceMappingURL=main-Dx4eraqn.js.map
