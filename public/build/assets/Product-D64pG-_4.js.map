{"version":3,"mappings":";yRASe,MAAMA,CAAQ,CAC3B,aAAc,CACZ,MAAMC,EAAU,SAASC,CAAE,EAAE,kCAAkC,EAC/D,GAAI,CAACD,EAAS,MAAO,GACrB,KAAK,QAAUA,EACf,KAAK,MAAQ,UACb,KAAK,GAAKE,EAAE,KAAK,OAAO,EAAE,KAAK,mBAAmB,EAAE,UAEpD,KAAK,WAAW,OAEhB,KAAK,eAAe,OACpB,KAAK,eAAe,OAEpBC,EAAa,OAAO,OAAQC,EAAW,yBAAyB,EAChED,EAAa,OAAO,eAAgBC,EAAW,yBAAyB,EACxE,KAAK,sBAAqB,CAC3B,CAED,uBAAwB,CACtB,MAAMC,EAAQH,EAAE,wBAAwB,EACxC,GAAG,QAAQ,KAAKG,EAAQC,GAAS,CAC3BA,EAAK,QAAQ,IAAI,IAAIC,EAAUD,CAAI,CAC7C,CAAK,CACF,CAED,MAAM,cAAe,CACnB,MAAME,EAAY,SAASP,CAAE,EAAE,OAAO,EACtC,GAAIO,EAAW,CACb,KAAM,CAAE,QAASC,GAAQ,MAAKC,EAAA,wBAAAD,CAAA,OAAC,QAAO,mBAA0B,yBACpD,MAAM,IAAIA,EAAID,EAAW,KAAK,YAAY,CACvD,CACF,CAED,MAAM,WAAY,CAChB,KAAM,CAAE,QAASG,GAAW,MAAKD,EAAA,wBAAAC,CAAA,OAAC,QAAO,sBAAa,iBAAAA,CAAA,iCACtD,IAAIA,EAAO,KAAK,OAAO,CACxB,CAED,MAAM,UAAW,CACf,KAAM,CAAE,QAASC,GAAU,MAAKF,EAAA,wBAAAE,CAAA,OAAC,QAAO,qBAAY,iBAAAA,CAAA,4CACpD,IAAIA,EAAM,KAAK,OAAO,CACvB,CAED,MAAM,cAAe,CAEnB,GADkB,SAASX,CAAE,EAAE,YAAY,EAC5B,CACb,KAAM,CAAE,QAASY,CAAS,EAAK,MAAMH,EAAA,wBAAAG,CAAA,eACnC,0BACR,iDACM,IAAIA,CACL,CACF,CAED,MAAM,aAAaC,EAAOC,EAAQ,CAChC,MAAMC,EAAM,CAAE,UAAWD,EAAO,QAAQ,YAAY,EAAE,QAAQ,IACxDE,EAAOC,EAAqBF,EAAKF,EAAM,CAAC,CAAC,EAGzCK,GADM,MAAMC,EAAK,iCAAkCH,CAAI,IAC5C,IAAI,CAAC,EACtB,GAAIE,EAAK,CACP,MAAME,EAAYN,EAAO,QAAQ,gBAAgB,EAAE,cAAc,KAAK,EACtEM,EAAU,gBAAgB,KAAK,EAC/BA,EAAU,aAAa,MAAOF,CAAG,CAClC,CACF,CACH","names":["Product","product","qs","$","QuillFactory","QuillConst","units","unit","SelectNew","dragNdrop","Dnd","__vitePreload","Fields","Props","cardPanel","files","target","obj","data","objAndFiles2FormData","src","post","mainImage"],"ignoreList":[],"sources":["../../src/Admin/Product/Product.js"],"sourcesContent":["import \"./product.scss\";\r\nimport \"./units.scss\";\r\nimport { $, objAndFiles2FormData, post } from \"../../common.js\";\r\nimport \"./Props.js\";\r\nimport { qs } from \"../../constants\";\r\nimport SelectNew from \"@src/components/select/SelectNew.js\";\r\nimport QuillFactory from \"@src/components/quill/QuillFactory.js\";\r\nimport { QuillConst } from \"@src/components/quill/QuillConstans.js\";\r\n\r\nexport default class Product {\r\n  constructor() {\r\n    const product = document[qs](`.item-wrap[data-model='product']`);\r\n    if (!product) return false;\r\n    this.product = product;\r\n    this.model = \"product\";\r\n    this.id = $(this.product).find(`[data-field='id']`).innerText;\r\n\r\n    this.setProps().then();\r\n\r\n    this.setDragNDrop().then();\r\n    this.setCardPanel().then();\r\n\r\n    QuillFactory.create(\".txt\", QuillConst.ADMIN_PRODUCT_DESCRIPTION);\r\n    QuillFactory.create(\"#seo-article\", QuillConst.ADMIN_PRODUCT_SEO_ARTICLE);\r\n    this.setUnitsCustomSelects();\r\n  }\r\n\r\n  setUnitsCustomSelects() {\r\n    const units = $(\".units [custom-select]\");\r\n    [].forEach.call(units, (unit) => {\r\n      if (unit.dataset.id) new SelectNew(unit);\r\n    });\r\n  }\r\n\r\n  async setDragNDrop() {\r\n    const dragNdrop = document[qs](\"[dnd]\");\r\n    if (dragNdrop) {\r\n      const { default: Dnd } = await import(\"../../components/dnd/dnd\");\r\n      const dnd = await new Dnd(dragNdrop, this.addMainImage);\r\n    }\r\n  }\r\n\r\n  async setFields() {\r\n    const { default: Fields } = await import(\"./Fields.js\");\r\n    new Fields(this.product);\r\n  }\r\n\r\n  async setProps() {\r\n    const { default: Props } = await import(\"./Props.js\");\r\n    new Props(this.product);\r\n  }\r\n\r\n  async setCardPanel() {\r\n    const cardPanel = document[qs](`.cardPanel`);\r\n    if (cardPanel) {\r\n      const { default: cardPanel } = await import(\r\n        \"./../../share/card_panel/card_panel\"\r\n      );\r\n      new cardPanel();\r\n    }\r\n  }\r\n\r\n  async addMainImage(files, target) {\r\n    const obj = { productId: target.closest(\".item-wrap\").dataset.id };\r\n    const data = objAndFiles2FormData(obj, files[0]);\r\n\r\n    const res = await post(\"/adminsc/product/saveMainImage\", data);\r\n    const src = res?.arr[0];\r\n    if (src) {\r\n      const mainImage = target.closest(\".dnd-container\").querySelector(\"img\");\r\n      mainImage.removeAttribute(\"src\");\r\n      mainImage.setAttribute(\"src\", src);\r\n    }\r\n  }\r\n}\r\n"],"file":"assets/Product-D64pG-_4.js"}