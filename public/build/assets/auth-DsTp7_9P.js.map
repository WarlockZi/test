{"version":3,"mappings":"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","names":["input","$","autocomplete","search","result","data","e","a","showPassword","viewPassword","target","msg","res","post","registerForm","sendData","parseRegisterResponse","email","password","loginForm","Login","__vitePreload","Modal"],"ignoreList":[],"sources":["../../src/components/header/Autocomplete/autocomplete.js","../../src/components/showPassword/showPassword.js","../../src/Auth/changepassword.js","../../src/Auth/register.js","../../src/Auth/edit.js","../../src/Auth/auth.js"],"sourcesContent":["import \"./autocomplete.scss\";\r\nimport { $ } from \"../../../common\";\r\n\r\nlet input = $(\".search input\").first();\r\nif (input) {\r\n  input.addEventListener(\"input\", function () {\r\n    autocomplete(input);\r\n  });\r\n}\r\n\r\nasync function autocomplete(input) {\r\n  let search = input.parentNode;\r\n  let result = $(search).find(\".search__result\");\r\n\r\n  if (input.value.length < 1) {\r\n    if (result) result.innerHTML = \"\";\r\n    return;\r\n  }\r\n\r\n  let data = await fetch(\"/search?q=\" + input.value);\r\n  data = await data.json(data);\r\n\r\n  if (result.childNodes.length !== 0) {\r\n    result.innerHTML = \"\";\r\n  }\r\n\r\n  data.map((e) => {\r\n    let a = document.createElement(\"a\");\r\n    a.href = e.alias;\r\n    a.innerHTML = `<img src='/pic/${e.preview_pic}' alt='${e.name}'>` + e.name;\r\n    result.appendChild(a);\r\n  });\r\n\r\n  $(\"body\").on(\"click\", function (e) {\r\n    if (result && e.target !== result) {\r\n      result.innerHTML = \"\";\r\n    }\r\n  });\r\n}\r\n","import \"./showPassword.scss\";\r\nimport { $ } from \"../../common\";\r\n\r\nexport default function showPassword() {\r\n  const showPassword = $(\".password-control\");\r\n  if (showPassword) {\r\n    $(\".password-control\").on(\"click\", viewPassword);\r\n  }\r\n\r\n  function viewPassword({ target }) {\r\n    const input = target.parentNode.querySelector(\"input\");\r\n    if (input.getAttribute(\"type\") === \"password\") {\r\n      input.setAttribute(\"type\", \"text\");\r\n    } else {\r\n      input.setAttribute(\"type\", \"password\");\r\n    }\r\n    target.classList.toggle(\"view\");\r\n  }\r\n}\r\n","import { $, post } from \"../common\";\r\n\r\n$(\".changepassword\").on(\"click\", async function (e) {\r\n  let data = {\r\n    old_password: $('[name=\"old_password\"]')[0].value,\r\n    new_password: $('[name=\"new_password\"]')[0].value,\r\n  };\r\n  let msg = $(\".message\")[0];\r\n\r\n  let res = await post(\"/auth/changepassword\", data);\r\n\r\n  if (res.success) {\r\n    msg.innerText = res.success;\r\n    $(msg).addClass(\"success\");\r\n    $(msg).removeClass(\"error\");\r\n  } else if (res.error) {\r\n    msg.innerText = res.error;\r\n    $(msg).addClass(\"error\");\r\n    $(msg).removeClass(\"success\");\r\n  }\r\n});\r\n","import { $, post, trimStr, validate } from \"../common\";\r\n\r\nlet registerForm = $(\"[data-auth='register']\")[0];\r\nif (registerForm) {\r\n  // debugger\r\n  $(registerForm).on(\"click\", sendData);\r\n}\r\n\r\nfunction sendData({ target }) {\r\n  // if (isValid(email, password))\r\n  parseRegisterResponse(email, password);\r\n}\r\n\r\n// function renderError(error) {\r\n//   let msg = $('.message')[0];\r\n//   msg.innerText = '';\r\n//   msg.innerText = msg.innerText + error;\r\n//   $(msg).removeClass('success');\r\n//   $(msg).addClass('error');\r\n// }\r\n\r\n// function isValid() {\r\n//    const email = trimStr($('input[type = email]')[0].value);\r\n//    const password = trimStr($('input[name = password]')[0].value);\r\n//    const error = validate.email(email);\r\n//    if (error) {\r\n//       renderError(error);\r\n//       return false\r\n//    }\r\n//    const error = validate.password(password);\r\n//    if (error) {\r\n//       renderError(error);\r\n//       return false\r\n//    }\r\n//    return true\r\n// }\r\n\r\nasync function parseRegisterResponse(email, password) {\r\n  const msg = $(\".message\")[0];\r\n  const data = {\r\n    email,\r\n    password,\r\n    surName: $(\"[name='surName']\")[0].value,\r\n    name: $(\"[name='name']\")[0].value,\r\n  };\r\n  // debugger\r\n\r\n  const res = await post(\"/auth/register\", data);\r\n\r\n  if (res?.arr?.success === \"confirm\") {\r\n    msg.classList.remove(\"error\");\r\n    msg.classList.add(\"success\");\r\n    msg.innerHTML =\r\n      \"-Пользователь зарегистрирован.<br>\" +\r\n      \"-Для подтверждения регистрации зайдите на почту, \" +\r\n      \"<bold>email</bold>.<br> \" +\r\n      \"-Перейдите по ссылке в письме.\";\r\n  } else if (res.msg === \"mail exists\") {\r\n    msg.innerHTML =\r\n      \"Эта почта уже зарегистрирована. Войдите в систему по кнопке внизу Войти или, если не помните пароль, восстановите пароль по кнопке Забыл пароль\";\r\n    msg.classList.remove(\"success\");\r\n    msg.classList.add(\"error\");\r\n  } else {\r\n    msg.innerHTML = res.msg;\r\n    msg.classList.remove(\"success\");\r\n    msg.classList.add(\"error\");\r\n  }\r\n}\r\n","import \"./edit.scss\";\r\nimport { post, $ } from \"../common\";\r\nimport getSex from \"./getSex\";\r\n\r\n$(\"#save\").on(\"click\", async function (e) {\r\n  e.preventDefault();\r\n\r\n  let data = {\r\n    name: $('[name = \"name\"]')[0].value,\r\n    surName: $('[name = \"surName\"]')[0].value,\r\n    middleName: $('[name = \"middleName\"]')[0].value,\r\n    birthDate: $('[name = \"birthDate\"]')[0].value,\r\n    phone: $('[name = \"phone.blade.php\"]')[0].value,\r\n    sex: getSex(),\r\n  };\r\n\r\n  let res = await post(\"/user/edit\", data);\r\n});\r\n","import \"../components/header/Autocomplete/autocomplete\";\r\n\r\nimport \"../components/showPassword/showPassword\";\r\nimport \"../components/cookie/cookie\";\r\nimport \"./changepassword\";\r\n\r\nimport \"./register\";\r\nimport \"./profile\";\r\nimport \"./return_pass\";\r\nimport \"./edit\";\r\nimport \"./auth.scss\";\r\n\r\nimport showPassword from \"../components/showPassword/showPassword\";\r\nimport { $ } from \"../common\";\r\n\r\nconst loginForm = $(\"[data-auth='login']\").first();\r\nif (loginForm) {\r\n  const { default: Login } = await import(\"./login.js\");\r\n  new Login();\r\n}\r\n\r\nif ($(\".modal\").first()) {\r\n  const { default: Modal } = await import(\"../components/Modal/modal.js\");\r\n  new Modal();\r\n}\r\n\r\nshowPassword();\r\n"],"file":"assets/auth-DsTp7_9P.js"}