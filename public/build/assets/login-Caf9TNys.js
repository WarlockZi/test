import{$ as a,v as t,p as n}from"./common-DQYaDImd.js";var r={VITE_APP_ENV:"development",VITE_SU_EMAIL:"vvoronik@yandex.ru"};class d{constructor(){if(this.loginForm=a("[data-auth='login']").first(),!this.loginForm)return!1;this.loginForm.addEventListener("click",this.sendData.bind(this)),this.email=a("input[type = email]")[0],this.pass=a("input[name= password]")[0],this.msg=a(".message")[0]}async sendData({target:s}){if(s.classList.contains("submit__button")){let e={email:this.email.value,password:this.pass.value};if(this.validateData()){const i=await this.send(e);await this.parseLoginResponse(i)}}}validateData(){let s=t.email(this.email.value);return s?(this.msg.innerText="",this.msg.innerText=s,a(this.msg).addClass("error"),!1):!(r.VITE_SU_EMAIL===this.email.value)&&(s=t.password(this.pass.value),s)?(this.msg.innerText="",this.msg.innerText=s,a(this.msg).addClass("error"),!1):!0}async send(s){return await n("/auth/login",s)}async parseLoginResponse(s){const e=s?.arr?.id;localStorage.setItem("id",e),s?.arr?.role==="employee"?window.location="/adminsc":s?.arr?.role==="user"?window.location="/auth/cabinet":s?.error}}export{d as default};
