{"version":3,"mappings":";8VAce,MAAMA,CAAQ,CAC3B,aAAc,CACZ,MAAMC,EAAU,SAASC,CAAE,EAAE,kCAAkC,EAC/D,GAAI,CAACD,EAAS,MAAO,GACrB,KAAK,QAAUA,EACf,KAAK,MAAQ,UACb,KAAK,GAAKE,EAAE,KAAK,OAAO,EAAE,KAAK,mBAAmB,EAAE,UAEpD,KAAK,SAAU,EAAC,KAAM,EAEtB,KAAK,aAAc,EAAC,KAAM,EAC1B,KAAK,aAAc,EAAC,KAAM,EAE1BC,EAAa,OAAO,OAAQC,EAAW,yBAAyB,EAChED,EAAa,OAAO,eAAgBC,EAAW,yBAAyB,EACxE,KAAK,sBAAuB,CAChC,CAEE,uBAAwB,CACtB,MAAMC,EAAQH,EAAE,wBAAwB,EACxC,GAAG,QAAQ,KAAKG,EAAQC,GAAS,CAC3BA,EAAK,QAAQ,IAAI,IAAIC,EAAUD,CAAI,CAC7C,CAAK,CACL,CAEE,MAAM,cAAe,CACnB,MAAME,EAAY,SAASP,CAAE,EAAE,OAAO,EACtC,GAAIO,EAAW,CACb,KAAM,CAAE,QAASC,CAAG,EAAK,wCAAM,QAAO,mBAA0B,EAAC,eAAAA,CAAA,uBACjE,MAAM,IAAIA,EAAID,EAAW,KAAK,YAAY,CAChD,CACA,CAEE,MAAM,WAAY,CAChB,KAAM,CAAE,QAASE,CAAM,EAAK,MAAMC,EAAA,wBAAAD,CAAA,eAAO,sBAAa,EAAC,eAAAA,CAAA,mDACvD,IAAIA,EAAO,KAAK,OAAO,CAC3B,CAEE,MAAM,UAAW,CACf,KAAM,CAAE,QAASE,CAAK,EAAK,MAAMD,EAAA,wBAAAC,CAAA,eAAO,qBAAY,EAAC,eAAAA,CAAA,qEACrD,IAAIA,EAAM,KAAK,OAAO,CAC1B,CAEE,MAAM,cAAe,CAEnB,GADkB,SAASX,CAAE,EAAE,YAAY,EAC5B,CACb,KAAM,CAAE,QAASY,CAAS,EAAK,wCAAM,QACnC,0BACD,iBAAAA,CAAA,+CACD,IAAIA,CACV,CACA,CAEE,MAAM,aAAaC,EAAOC,EAAQ,CAChC,MAAMC,EAAM,CAAE,UAAWD,EAAO,QAAQ,YAAY,EAAE,QAAQ,EAAI,EAC5DE,EAAOC,EAAwBF,EAAKF,EAAM,CAAC,CAAC,EAI5CK,GAFM,MAAMC,EAAK,iCAAkCH,CAAI,IAE5C,UACjB,GAAIE,EAAK,CACP,MAAME,EAAYN,EAAO,QAAQ,gBAAgB,EAAE,cAAc,KAAK,EACtEM,EAAU,gBAAgB,KAAK,EAC/BA,EAAU,aAAa,MAAOF,CAAG,CACvC,CACA,CACA","names":["Product","product","qs","$","QuillFactory","QuillConst","units","unit","SelectNew","dragNdrop","Dnd","Fields","__vitePreload","Props","cardPanel","files","target","obj","data","newObjAndFiles2FormData","src","post","mainImage"],"ignoreList":[],"sources":["../../src/Admin/Product/Product.js"],"sourcesContent":["import \"./product.scss\";\nimport \"./units.scss\";\nimport {\n  $,\n  newObjAndFiles2FormData,\n  objAndFiles2FormData,\n  post,\n} from \"../../common.js\";\nimport \"./Props.js\";\nimport { qs } from \"../../constants\";\nimport SelectNew from \"@src/components/select/SelectNew.js\";\nimport QuillFactory from \"@src/components/quill/QuillFactory.js\";\nimport { QuillConst } from \"@src/components/quill/QuillConstans.js\";\n\nexport default class Product {\n  constructor() {\n    const product = document[qs](`.item-wrap[data-model='product']`);\n    if (!product) return false;\n    this.product = product;\n    this.model = \"product\";\n    this.id = $(this.product).find(`[data-field='id']`).innerText;\n\n    this.setProps().then();\n\n    this.setDragNDrop().then();\n    this.setCardPanel().then();\n\n    QuillFactory.create(\".txt\", QuillConst.ADMIN_PRODUCT_DESCRIPTION);\n    QuillFactory.create(\"#seo-article\", QuillConst.ADMIN_PRODUCT_SEO_ARTICLE);\n    this.setUnitsCustomSelects();\n  }\n\n  setUnitsCustomSelects() {\n    const units = $(\".units [custom-select]\");\n    [].forEach.call(units, (unit) => {\n      if (unit.dataset.id) new SelectNew(unit);\n    });\n  }\n\n  async setDragNDrop() {\n    const dragNdrop = document[qs](\"[dnd]\");\n    if (dragNdrop) {\n      const { default: Dnd } = await import(\"../../components/dnd/dnd\");\n      await new Dnd(dragNdrop, this.addMainImage);\n    }\n  }\n\n  async setFields() {\n    const { default: Fields } = await import(\"./Fields.js\");\n    new Fields(this.product);\n  }\n\n  async setProps() {\n    const { default: Props } = await import(\"./Props.js\");\n    new Props(this.product);\n  }\n\n  async setCardPanel() {\n    const cardPanel = document[qs](`.cardPanel`);\n    if (cardPanel) {\n      const { default: cardPanel } = await import(\n        \"@components/card_panel/card_panel\"\n      );\n      new cardPanel();\n    }\n  }\n\n  async addMainImage(files, target) {\n    const obj = { productId: target.closest(\".item-wrap\").dataset.id };\n    const data = newObjAndFiles2FormData(obj, files[0]);\n\n    const res = await post(\"/adminsc/product/saveMainImage\", data);\n    // debugger;\n    const src = res?.mainImage;\n    if (src) {\n      const mainImage = target.closest(\".dnd-container\").querySelector(\"img\");\n      mainImage.removeAttribute(\"src\");\n      mainImage.setAttribute(\"src\", src);\n    }\n  }\n}\n"],"file":"assets/Product-CUSB4ovX.js"}