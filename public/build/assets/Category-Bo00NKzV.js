/* empty css                */import{q as n,b as h,$ as d,p as o}from"./constants-mwD5SO1c.js";import{S as l}from"./Promotion-c7-OSdTF.js";class p{constructor(e){this.el=e,this.$addBtn=this.el[n](".add-property"),this.$addBtn&&this.$addBtn[h]("click",this.newRow.bind(this))}async handleClick({target:e}){e.classList.contains("del")?this.deleteRow(e):e.classList.contains("edit")&&this.editProperty(e)}async editProperty(e){let t=e.closest(".row").querySelector("[select-new]").dataset.value;location.href=`/adminsc/property/edit/${t}`}async deleteRow(e){let t=e.closest(".row"),s=+d(t).find("[select-new]").dataset.value,a=this.dto();a.morphed.new_id=0,a.morphed.old_id=s;let r=await o("/adminsc/category/changeProperty",a);r!=null&&r.ok&&t.remove()}async propertyChange(e){{let t=this.dto(e);await o("/adminsc/category/changeProperty",t)}}dto(e={}){var t,i,s,a;return{category_id:this.el.closest('[data-model="category"]').dataset.id,morphed:{old_id:+((i=(t=e==null?void 0:e.detail)==null?void 0:t.prev)==null?void 0:i.value),new_id:+((a=(s=e==null?void 0:e.detail)==null?void 0:s.next)==null?void 0:a.value)}}}newRow(){let e=this.rowsWrap.querySelector(".none .row").cloneNode(!0);new l(d(e).find("[custom-select]")),this.rowsWrap.append(e)}}class m{constructor(e){this.el=e,this.id=e.dataset.id,this.setCategoryId(),this.setShowOnFrontPage(),this.setProperties(),this.setImage()}setCategoryId(){const e=d("[data-field='category_id']").first();new l(e).sel.addEventListener("customSelect.changed",this.attachCategory.bind(this))}setProperties(){new p(this.el.querySelector('[data-relation="properties"]'))}setShowOnFrontPage(){}setImage(){}dto(){return{id:this.el.dataset.id}}attachCategory({detail:e}){debugger;let t={id:this.id,category_id:+e.next.value};o("/adminsc/category/updateOrCreate",t)}}export{m as default};
