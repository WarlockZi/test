import{$ as s,p as o}from"./common-HbR8gfPR.js";import{Q as a}from"./quill.bubble--vF6heEE.js";class u{constructor(t="#detail-text",e=!1,i=!1,n=!1,l="snow"){if(!s(t))return!1;this.model=s("[data-model]").first()?.dataset?.model??null,this.id=s("[data-model]").first()?.dataset?.id??null,this.button=s("#button").first(),this.selector=t,this.autosave=e,this.editable=n,this.contents=s(t).first().innerText,this.toolbar=i?this.setToolbar():!1,this.options=this.setOptions(),this.init()}setToolbar(){return[["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]}setOptions(){return{theme:"snow",placeholder:"Compose an epic...",modules:{toolbar:this.toolbar}}}dto(t){return{id:this.id,relation:"ownProperties",fields:{seo_article:t}}}init(){const t=new a(this.selector,this.options);if(this.isJson(this.contents)){const e=JSON.parse(this.contents);t.setContents(e)}else t.setText(this.contents);this.editable||t.enable(!1),this.autosave&&t.on("text-change",function(e){o(`/adminsc/${this.model}/updateOrCreate`,this.dto(JSON.stringify(t.getContents())))}.bind(this)),this.button&&this.button.addEventListener("click",function(){const e=s(".item-wrap[data-model='product']")[0].dataset.id,i=JSON.stringify(t.getContents());o("/adminsc/product/updateOrCreate",{txt:i,id:e}).then()})}isJson(t){try{return JSON.parse(t),!0}catch{return!1}}}export{u as M};
