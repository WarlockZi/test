{"version":3,"file":"ProductFilter-BnnhdLej.js","sources":["../../src/Admin/ProductFilter/ProductFilter.js"],"sourcesContent":["import \"./ProductFilter.css\";\r\nimport { ael, qa, qs } from \"@src/constants.js\";\r\nimport { $, post } from \"@src/common.js\";\r\nimport SelectNew from \"@src/components/select/SelectNew.js\";\r\n\r\nexport default class ProductFilter {\r\n  constructor(productsFilter) {\r\n    if (!productsFilter) return;\r\n    this.wrap = productsFilter;\r\n    this.panel = productsFilter[qs](\".list-filter\");\r\n    this.url = \"/adminsc/report/filter\";\r\n    this.wrap[ael](\"click\", this.handleClick.bind(this));\r\n    this.setSelects();\r\n  }\r\n\r\n  setSelects() {\r\n    const selects = this.wrap[qa](`[select-new]`);\r\n    [].map.call(selects, (select) => {\r\n      new SelectNew(select);\r\n    });\r\n  }\r\n\r\n  async handleClick(e) {\r\n    const target = e.target;\r\n    if (target.classList.contains(\"filter-button\")) {\r\n      e.preventDefault();\r\n      const req = this.getClickedFilters();\r\n      const res = await post(this.url, req);\r\n      this.renderDataFromResponce(res);\r\n    }\r\n  }\r\n\r\n  getClickedFilters() {\r\n    const req = {};\r\n\r\n    const selected = this.wrap[qa](`[select-new]`);\r\n    [].map.call(selected, (select) => {\r\n      req[select.getAttribute(\"name\")] = select.dataset.value;\r\n      return null;\r\n    });\r\n\r\n    const checked = this.panel[qa](`[type='checkbox']:checked`);\r\n    [].forEach.call(checked, (check) => {\r\n      req[check.name] = \"on\";\r\n    });\r\n    return req;\r\n  }\r\n\r\n  renderDataFromResponce(res) {\r\n    $(\".used-filters\").first().innerHTML = res?.arr?.filterString;\r\n    $(\".list-filter\").first().innerHTML = res?.arr?.filterPanel;\r\n    const table = $(\"[custom-table]\").first();\r\n    table.innerHTML = res?.arr?.productsTable;\r\n    this.setSelects();\r\n  }\r\n}\r\n"],"names":["ProductFilter","productsFilter","qs","ael","selects","qa","select","SelectNew","e","req","res","post","selected","checked","check","$","table"],"mappings":"6OAKe,MAAMA,CAAc,CACjC,YAAYC,EAAgB,CACrBA,IACL,KAAK,KAAOA,EACZ,KAAK,MAAQA,EAAeC,CAAE,EAAE,cAAc,EAC9C,KAAK,IAAM,yBACX,KAAK,KAAKC,CAAG,EAAE,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EACnD,KAAK,WAAU,EAChB,CAED,YAAa,CACX,MAAMC,EAAU,KAAK,KAAKC,CAAE,EAAE,cAAc,EAC5C,CAAA,EAAG,IAAI,KAAKD,EAAUE,GAAW,CAC/B,IAAIC,EAAUD,CAAM,CAC1B,CAAK,CACF,CAED,MAAM,YAAYE,EAAG,CAEnB,GADeA,EAAE,OACN,UAAU,SAAS,eAAe,EAAG,CAC9CA,EAAE,eAAc,EAChB,MAAMC,EAAM,KAAK,oBACXC,EAAM,MAAMC,EAAK,KAAK,IAAKF,CAAG,EACpC,KAAK,uBAAuBC,CAAG,CAChC,CACF,CAED,mBAAoB,CAClB,MAAMD,EAAM,CAAA,EAENG,EAAW,KAAK,KAAKP,CAAE,EAAE,cAAc,EAC7C,CAAA,EAAG,IAAI,KAAKO,EAAWN,IACrBG,EAAIH,EAAO,aAAa,MAAM,CAAC,EAAIA,EAAO,QAAQ,MAC3C,KACR,EAED,MAAMO,EAAU,KAAK,MAAMR,CAAE,EAAE,2BAA2B,EAC1D,OAAA,EAAG,QAAQ,KAAKQ,EAAUC,GAAU,CAClCL,EAAIK,EAAM,IAAI,EAAI,IACxB,CAAK,EACML,CACR,CAED,uBAAuBC,EAAK,CAC1BK,EAAE,eAAe,EAAE,MAAK,EAAG,UAAYL,GAAK,KAAK,aACjDK,EAAE,cAAc,EAAE,MAAK,EAAG,UAAYL,GAAK,KAAK,YAChD,MAAMM,EAAQD,EAAE,gBAAgB,EAAE,MAAK,EACvCC,EAAM,UAAYN,GAAK,KAAK,cAC5B,KAAK,WAAU,CAChB,CACH"}