{"version":3,"mappings":";uLASe,MAAMA,CAAQ,CAC1B,aAAc,CACX,MAAMC,EAAU,SAASC,CAAE,EAAE,kCAAkC,EAC/D,GAAI,CAACD,EAAS,MAAO,GACrB,KAAK,QAAUA,EACf,KAAK,MAAQ,UACb,KAAK,GAAKE,EAAE,KAAK,OAAO,EAAE,KAAK,mBAAmB,EAAE,UAEpD,KAAK,SAAU,EAAC,KAAM,EAEtB,KAAK,aAAc,EAAC,KAAM,EAC1B,KAAK,aAAc,EAAC,KAAM,EAE1BC,EAAa,OAAO,OAAQC,EAAW,yBAAyB,EAChED,EAAa,OAAO,eAAgBC,EAAW,yBAAyB,EACxE,KAAK,sBAAuB,CAC9B,CAED,uBAAwB,CACrB,MAAMC,EAAQH,EAAE,wBAAwB,EACxC,GAAG,QAAQ,KAAKG,EAAQC,GAAS,CAC1BA,EAAK,QAAQ,IAAI,IAAIC,EAAUD,CAAI,CAChD,CAAO,CACH,CAED,MAAM,cAAe,CAClB,MAAME,EAAY,SAASP,CAAE,EAAE,OAAO,EACtC,GAAIO,EAAW,CACZ,KAAM,CAAC,QAASC,CAAG,EAAI,wCAAM,QAAO,mBAA0B,yBAClD,MAAM,IAAIA,EAAID,EAAW,KAAK,YAAY,CACxD,CACH,CAED,MAAM,WAAY,CACf,KAAM,CAAC,QAASE,CAAM,EAAI,MAAKC,EAAA,wBAAAD,CAAA,OAAC,QAAO,sBAAa,iBAAAA,CAAA,6BACpD,IAAIA,EAAO,KAAK,OAAO,CACzB,CAED,MAAM,UAAW,CACd,KAAM,CAAC,QAASE,CAAK,EAAI,MAAKD,EAAA,wBAAAC,CAAA,OAAC,QAAO,qBAAY,iBAAAA,CAAA,uCAClD,IAAIA,EAAM,KAAK,OAAO,CACxB,CAGD,MAAM,cAAe,CAElB,GADkB,SAASX,CAAE,EAAE,YAAY,EAC5B,CACZ,KAAM,CAAC,QAASY,CAAS,EAAI,MAAKF,EAAA,wBAAAE,CAAA,OAAC,QAAO,0BAAqC,kDAC/E,IAAIA,CACN,CACH,CAED,MAAM,aAAaC,EAAOC,EAAQ,CAC/B,MAAMC,EAAM,CAAC,UAAWD,EAAO,QAAQ,YAAY,EAAE,QAAQ,IACvDE,EAAOC,EAAqBF,EAAKF,EAAM,CAAC,CAAC,EAGzCK,GADM,MAAMC,EAAK,iCAAkCH,CAAI,IAC5C,IAAI,CAAC,EACtB,GAAIE,EAAK,CACN,MAAME,EAAYN,EAAO,QAAQ,gBAAgB,EAAE,cAAc,KAAK,EACtEM,EAAU,gBAAgB,KAAK,EAC/BA,EAAU,aAAa,MAAOF,CAAG,CACnC,CACH,CAEJ","names":["Product","product","qs","$","QuillFactory","QuillConst","units","unit","SelectNew","dragNdrop","Dnd","Fields","__vitePreload","Props","cardPanel","files","target","obj","data","objAndFiles2FormData","src","post","mainImage"],"ignoreList":[],"sources":["../../src/Admin/Product/Product.js"],"sourcesContent":["import './product.scss'\r\nimport './units.scss'\r\nimport {$, objAndFiles2FormData, post} from '../../common.js'\r\nimport './Props.js'\r\nimport {qs} from '../../constants'\r\nimport SelectNew from \"@src/components/select/SelectNew.js\";\r\nimport QuillFactory from \"@src/components/quill/QuillFactory.js\";\r\nimport {QuillConst} from \"@src/components/quill/QuillConstans.js\";\r\n\r\nexport default class Product {\r\n   constructor() {\r\n      const product = document[qs](`.item-wrap[data-model='product']`)\r\n      if (!product) return false;\r\n      this.product = product\r\n      this.model = 'product'\r\n      this.id = $(this.product).find(`[data-field='id']`).innerText\r\n\r\n      this.setProps().then()\r\n\r\n      this.setDragNDrop().then()\r\n      this.setCardPanel().then()\r\n\r\n      QuillFactory.create('.txt', QuillConst.ADMIN_PRODUCT_DESCRIPTION);\r\n      QuillFactory.create('#seo-article', QuillConst.ADMIN_PRODUCT_SEO_ARTICLE);\r\n      this.setUnitsCustomSelects()\r\n   }\r\n\r\n   setUnitsCustomSelects() {\r\n      const units = $('.units [custom-select]');\r\n      [].forEach.call(units, (unit) => {\r\n         if (unit.dataset.id) new SelectNew(unit)\r\n      })\r\n   }\r\n\r\n   async setDragNDrop() {\r\n      const dragNdrop = document[qs]('[dnd]')\r\n      if (dragNdrop) {\r\n         const {default: Dnd} = await import(\"../../components/dnd/dnd\")\r\n         const dnd = await new Dnd(dragNdrop, this.addMainImage)\r\n      }\r\n   }\r\n\r\n   async setFields() {\r\n      const {default: Fields} = await import(\"./Fields.js\")\r\n      new Fields(this.product)\r\n   }\r\n\r\n   async setProps() {\r\n      const {default: Props} = await import(\"./Props.js\")\r\n      new Props(this.product)\r\n   }\r\n\r\n\r\n   async setCardPanel() {\r\n      const cardPanel = document[qs](`.cardPanel`)\r\n      if (cardPanel) {\r\n         const {default: cardPanel} = await import(\"./../../share/card_panel/card_panel\")\r\n         new cardPanel()\r\n      }\r\n   }\r\n\r\n   async addMainImage(files, target) {\r\n      const obj = {productId: target.closest('.item-wrap').dataset.id,};\r\n      const data = objAndFiles2FormData(obj, files[0]);\r\n\r\n      const res = await post('/adminsc/product/saveMainImage', data);\r\n      const src = res?.arr[0];\r\n      if (src) {\r\n         const mainImage = target.closest('.dnd-container').querySelector('img');\r\n         mainImage.removeAttribute(\"src\");\r\n         mainImage.setAttribute(\"src\", src)\r\n      }\r\n   }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n"],"file":"assets/Product-CveTwxjm.js"}