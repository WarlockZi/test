const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/login-sNysL9aU.js","assets/common-BklKRznI.js","assets/modal-B5MRsSBI.js","assets/constants-D_Ps4z6O.js","assets/modal-WKCBC1Wf.css"])))=>i.map(i=>d[i]);
import{$ as e,g as u,s as m,p as c,_ as d}from"./common-BklKRznI.js";let r=e(".search input").first();r&&r.addEventListener("input",function(){f(r)});async function f(a){let n=a.parentNode,s=e(n).find(".search__result");if(a.value.length<1){s&&(s.innerHTML="");return}let t=await fetch("/search?q="+a.value);t=await t.json(t),s.childNodes.length!==0&&(s.innerHTML=""),t.map(o=>{let i=document.createElement("a");i.href=o.alias,i.innerHTML=`<img src='/pic/${o.preview_pic}' alt='${o.name}'>`+o.name,s.appendChild(i)}),e("body").on("click",function(o){s&&o.target!==s&&(s.innerHTML="")})}function p(){e(".password-control")&&e(".password-control").on("click",n);function n({target:s}){const t=s.parentNode.querySelector("input");t.getAttribute("type")==="password"?t.setAttribute("type","text"):t.setAttribute("type","password"),s.classList.toggle("view")}}w("cn");e("#cn-accept-cookie").on("click",g);function w(a){u(a)?e("#cookie-notice").css("bottom","-100%"):e("#cookie-notice").css("bottom","0")}function g(){m("cn",1,3),e("#cookie-notice").css("bottom","-100%")}e(".changepassword").on("click",async function(a){let n={old_password:e('[name="old_password"]')[0].value,new_password:e('[name="new_password"]')[0].value},s=e(".message")[0],t=await c("/auth/changepassword",n);t.success?(s.innerText=t.success,e(s).addClass("success"),e(s).removeClass("error")):t.error&&(s.innerText=t.error,e(s).addClass("error"),e(s).removeClass("success"))});let l=e("[data-auth='register']")[0];l&&e(l).on("click",v);function v({target:a}){h(email,password)}async function h(a,n){const s=e(".message")[0],t={email:a,password:n,surName:e("[name='surName']")[0].value,name:e("[name='name']")[0].value},o=await c("/auth/register",t);o?.arr?.success==="confirm"?(s.classList.remove("error"),s.classList.add("success"),s.innerHTML="-Пользователь зарегистрирован.<br>-Для подтверждения регистрации зайдите на почту, <bold>email</bold>.<br> -Перейдите по ссылке в письме."):o.msg==="mail exists"?(s.innerHTML="Эта почта уже зарегистрирована. Войдите в систему по кнопке внизу Войти или, если не помните пароль, восстановите пароль по кнопке Забыл пароль",s.classList.remove("success"),s.classList.add("error")):(s.innerHTML=o.msg,s.classList.remove("success"),s.classList.add("error"))}e("#save").on("click",async function(a){a.preventDefault();let n={name:e('[name = "name"]')[0].value,surName:e('[name = "surName"]')[0].value,middleName:e('[name = "middleName"]')[0].value,birthDate:e('[name = "birthDate"]')[0].value,phone:e('[name = "phone"]')[0].value,sex:void 0};await c("/user/edit",n)});const _=e("[data-auth='login']").first();if(_){const{default:a}=await d(async()=>{const{default:n}=await import("./login-sNysL9aU.js");return{default:n}},__vite__mapDeps([0,1]));new a}if(e(".modal")){const{default:a}=await d(async()=>{const{default:n}=await import("./modal-B5MRsSBI.js");return{default:n}},__vite__mapDeps([2,1,3,4]));new a}p();
