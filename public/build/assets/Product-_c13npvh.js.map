{"version":3,"mappings":";uNASe,MAAMA,CAAQ,CAC1B,aAAc,CACX,MAAMC,EAAU,SAASC,CAAE,EAAE,kCAAkC,EAC/D,GAAI,CAACD,EAAS,MAAO,GACrB,KAAK,QAAUA,EAEf,KAAK,SAAU,EAAC,KAAM,EAEtB,KAAK,UAAW,EAAC,KAAM,EACvB,KAAK,aAAc,EAAC,KAAM,EAC1B,KAAK,aAAc,EAAC,KAAM,EAC1B,IAAIE,EAAQ,eAAgB,GAAK,GAAK,EAAI,EAC1C,IAAIA,EAAQ,eAAgB,GAAK,GAAK,EAAI,EAC1C,KAAK,sBAAuB,CAC9B,CACD,uBAAuB,CACpB,MAAMC,EAAQC,EAAE,wBAAwB,EACxC,GAAG,QAAQ,KAAKD,EAAQE,GAAO,CAC5B,IAAIC,EAAOD,CAAI,CACxB,CAAO,CACH,CAED,MAAM,cAAe,CAClB,MAAME,EAAY,SAASN,CAAE,EAAE,OAAO,EACtC,GAAIM,EAAW,CACZ,KAAM,CAAC,QAASC,CAAG,EAAI,wCAAM,QAAO,mBAA0B,yBAClD,MAAM,IAAIA,EAAID,EAAW,KAAK,YAAY,CACxD,CACH,CAED,MAAM,WAAY,CACf,KAAM,CAAC,QAASE,CAAM,EAAI,MAAKC,EAAA,wBAAAD,CAAA,OAAC,QAAO,sBAAa,iBAAAA,CAAA,+BACpD,IAAIA,EAAO,KAAK,OAAO,CACzB,CAED,MAAM,UAAW,CACd,KAAM,CAAC,QAASE,CAAK,EAAI,MAAKD,EAAA,wBAAAC,CAAA,OAAC,QAAO,qBAAY,iBAAAA,CAAA,yCAClD,IAAIA,EAAM,KAAK,OAAO,CACxB,CAGD,MAAM,cAAe,CAElB,GADkB,SAASV,CAAE,EAAE,YAAY,EAC5B,CACZ,KAAM,CAAC,QAASW,CAAS,EAAI,MAAKF,EAAA,wBAAAE,CAAA,OAAC,QAAO,0BAAqC,iDAC/E,IAAIA,CACN,CACH,CAED,MAAM,aAAaC,EAAOC,EAAQ,CAC/B,MAAMC,EAAM,CAAC,UAAWD,EAAO,QAAQ,YAAY,EAAE,QAAQ,IACvDE,EAAOC,EAAqBF,EAAKF,EAAM,CAAC,CAAC,EAGzCK,GADM,MAAMC,EAAK,iCAAkCH,CAAI,IAC5C,IAAI,CAAC,EACtB,GAAIE,EAAK,CACN,MAAME,EAAYN,EAAO,QAAQ,gBAAgB,EAAE,cAAc,KAAK,EACtEM,EAAU,gBAAgB,KAAK,EAC/BA,EAAU,aAAa,MAAOF,CAAG,CACnC,CACH,CAEJ","names":["Product","product","qs","MyQuill","units","$","unit","Select","dragNdrop","Dnd","Fields","__vitePreload","Props","cardPanel","files","target","obj","data","objAndFiles2FormData","src","post","mainImage"],"ignoreList":[],"sources":["../../src/Admin/Product/Product.js"],"sourcesContent":["import './product.scss'\r\nimport './units.scss'\r\nimport {objAndFiles2FormData, post, $} from '../../common.js'\r\nimport './Props.js'\r\nimport {qs} from '../../constants'\r\nimport MyQuill from \"../../components/quill/MyQuill.js\";\r\nimport Select from \"@src/components/select/SelectNew.js\";\r\n// import UnitTable from './UnitTable'\r\n\r\nexport default class Product {\r\n   constructor() {\r\n      const product = document[qs](`.item-wrap[data-model='product']`)\r\n      if (!product) return false;\r\n      this.product = product\r\n\r\n      this.setProps().then()\r\n\r\n      this.setFields().then()\r\n      this.setDragNDrop().then()\r\n      this.setCardPanel().then()\r\n      new MyQuill('#detail-text', true,true,true);\r\n      new MyQuill('#seo_article', true,true,true);\r\n      this.setUnitsCustomSelects()\r\n   }\r\n   setUnitsCustomSelects(){\r\n      const units = $('.units [custom-select]');\r\n      [].forEach.call(units, (unit)=>{\r\n         new Select(unit)\r\n      })\r\n   }\r\n\r\n   async setDragNDrop() {\r\n      const dragNdrop = document[qs]('[dnd]')\r\n      if (dragNdrop) {\r\n         const {default: Dnd} = await import(\"../../components/dnd/dnd\")\r\n         const dnd = await new Dnd(dragNdrop, this.addMainImage)\r\n      }\r\n   }\r\n\r\n   async setFields() {\r\n      const {default: Fields} = await import(\"./Fields.js\")\r\n      new Fields(this.product)\r\n   }\r\n\r\n   async setProps() {\r\n      const {default: Props} = await import(\"./Props.js\")\r\n      new Props(this.product)\r\n   }\r\n\r\n\r\n   async setCardPanel() {\r\n      const cardPanel = document[qs](`.cardPanel`)\r\n      if (cardPanel) {\r\n         const {default: cardPanel} = await import(\"./../../share/card_panel/card_panel\")\r\n         new cardPanel()\r\n      }\r\n   }\r\n\r\n   async addMainImage(files, target) {\r\n      const obj = {productId: target.closest('.item-wrap').dataset.id,};\r\n      const data = objAndFiles2FormData(obj, files[0]);\r\n\r\n      const res = await post('/adminsc/product/saveMainImage', data);\r\n      const src = res?.arr[0];\r\n      if (src) {\r\n         const mainImage = target.closest('.dnd-container').querySelector('img');\r\n         mainImage.removeAttribute(\"src\");\r\n         mainImage.setAttribute(\"src\", src)\r\n      }\r\n   }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n"],"file":"assets/Product-_c13npvh.js"}