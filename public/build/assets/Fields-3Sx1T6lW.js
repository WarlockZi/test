import{S as s}from"./Promotion-DhzIVehj.js";import{$ as i,p as l}from"./constants-D6t7YzCi.js";class u{constructor(t){this.$product=t,this.$fields=i(".item_content").first(),this.$category_id=i('[data-field="category_id"]').first(),this.$promotions=i('[data-field="promotions"]').first(),this.$base_unit=i('[data-field="base_unit"]').first(),this.$manufacturer_id=i('[data-field="manufacturer_id"]').first(),this.$printName=i("[data-field='print_name']").first(),this.$printName.addEventListener("catalogItem.changed",this.changePrintName.bind(this)),this.$productUrl=i("[data-field='slug']").first(),this.setup()}setup(){this.$fields.addEventListener("customSelect.changed",this.changeFields.bind(this)),new s(this.$category_id),new s(this.$promotions),new s(this.$base_unit),new s(this.$manufacturer_id)}changePrintName(t){var e,a,d;if(t.detail){let r=this.$productUrl.querySelector("a"),n=(d=(a=(e=t.detail)==null?void 0:e.res)==null?void 0:a.arr)==null?void 0:d.model.slug;r.setAttribute("href",`/product/${n}`),r.text=n}}async checkBoxChanged({target:t}){let e=this.dto(this);e[t.dataset.field]=+t.checked,await l("/adminsc/product/updateOrCreate",e)}async changeFields(t){let e=t.detail.target.dataset.field;if(!e)return;let a=this.dto(t);a[e]=t.detail.next.value,await l("/adminsc/product/updateOrCreate",a)}dto(t){return{id:this.$product.dataset.id}}}export{u as default};
