{"version":3,"file":"Fields-DxtIv5HD.js","sources":["../../src/Admin/Product/Fields.js"],"sourcesContent":["import SelectNew from \"../../components/select/SelectNew\";\r\nimport {$, post} from \"../../common.js\";\r\n\r\nexport default class Fields {\r\n  constructor($product) {\r\n    this.$product = $product;\r\n    this.$fields = $('.item_content').first();\r\n\r\n    this.$promotions = $(`[data-field=\"active_promotions\"]`).first();\r\n    this.$category_id = $(`[data-field=\"category_id\"]`).first();\r\n    this.$base_unit = $(`[data-field=\"base_unit\"]`).first();\r\n    this.$manufacturer_id = $(`[data-field=\"manufacturer\"]`).first();\r\n    this.$printName = $(`[data-field='print_name']`).first();\r\n    this.$printName.addEventListener('catalogItem.changed', this.changePrintName.bind(this))\r\n\r\n    this.$productUrl= $(`[data-field='slug']`).first();\r\n    this.setup()\r\n  }\r\n\r\n  setup() {\r\n    this.$fields.addEventListener('customSelect.changed', this.changeFields.bind(this));\r\n    new SelectNew(this.$category_id);\r\n    new SelectNew(this.$promotions);\r\n    new SelectNew(this.$base_unit);\r\n    new SelectNew(this.$manufacturer_id);\r\n  }\r\n\r\n  changePrintName(item) {\r\n    if (item.detail) {\r\n      let $url = this.$productUrl.querySelector('a')\r\n      let slug = item.detail?.res?.arr?.model.slug\r\n      $url.setAttribute('href',`/product/${slug}`)\r\n      $url.text = slug\r\n    }\r\n\r\n  }\r\n\r\n  async checkBoxChanged({target}) {\r\n    let data = this.dto(this);\r\n    data[target.dataset.field] = +target.checked;\r\n    let res = await post('/adminsc/product/updateOrCreate', data)\r\n  }\r\n\r\n  async changeFields(obj) {\r\n    let field = obj.detail.target.dataset.field;\r\n    if (!field) return;\r\n    let data = this.dto(obj);\r\n    data[field] = obj.detail.next.value;\r\n    let res = await post('/adminsc/product/updateOrCreate', data)\r\n  }\r\n\r\n  dto(obj) {\r\n    return {\r\n      id: this.$product.dataset.id,\r\n    }\r\n  }\r\n}"],"names":["Fields","$product","$","SelectNew","item","$url","slug","target","data","post","obj","field"],"mappings":"oDAGe,MAAMA,CAAO,CAC1B,YAAYC,EAAU,CACpB,KAAK,SAAWA,EAChB,KAAK,QAAUC,EAAE,eAAe,EAAE,MAAK,EAEvC,KAAK,YAAcA,EAAE,kCAAkC,EAAE,QACzD,KAAK,aAAeA,EAAE,4BAA4B,EAAE,QACpD,KAAK,WAAaA,EAAE,0BAA0B,EAAE,QAChD,KAAK,iBAAmBA,EAAE,6BAA6B,EAAE,QACzD,KAAK,WAAaA,EAAE,2BAA2B,EAAE,QACjD,KAAK,WAAW,iBAAiB,sBAAuB,KAAK,gBAAgB,KAAK,IAAI,CAAC,EAEvF,KAAK,YAAaA,EAAE,qBAAqB,EAAE,QAC3C,KAAK,MAAO,CACb,CAED,OAAQ,CACN,KAAK,QAAQ,iBAAiB,uBAAwB,KAAK,aAAa,KAAK,IAAI,CAAC,EAClF,IAAIC,EAAU,KAAK,YAAY,EAC/B,IAAIA,EAAU,KAAK,WAAW,EAC9B,IAAIA,EAAU,KAAK,UAAU,EAC7B,IAAIA,EAAU,KAAK,gBAAgB,CACpC,CAED,gBAAgBC,EAAM,CACpB,GAAIA,EAAK,OAAQ,CACf,IAAIC,EAAO,KAAK,YAAY,cAAc,GAAG,EACzCC,EAAOF,EAAK,QAAQ,KAAK,KAAK,MAAM,KACxCC,EAAK,aAAa,OAAO,YAAYC,CAAI,EAAE,EAC3CD,EAAK,KAAOC,CACb,CAEF,CAED,MAAM,gBAAgB,CAAC,OAAAC,CAAM,EAAG,CAC9B,IAAIC,EAAO,KAAK,IAAI,IAAI,EACxBA,EAAKD,EAAO,QAAQ,KAAK,EAAI,CAACA,EAAO,QAC3B,MAAME,EAAK,kCAAmCD,CAAI,CAC7D,CAED,MAAM,aAAaE,EAAK,CACtB,IAAIC,EAAQD,EAAI,OAAO,OAAO,QAAQ,MACtC,GAAI,CAACC,EAAO,OACZ,IAAIH,EAAO,KAAK,IAAIE,CAAG,EACvBF,EAAKG,CAAK,EAAID,EAAI,OAAO,KAAK,MACpB,MAAMD,EAAK,kCAAmCD,CAAI,CAC7D,CAED,IAAIE,EAAK,CACP,MAAO,CACL,GAAI,KAAK,SAAS,QAAQ,EAC3B,CACF,CACH"}