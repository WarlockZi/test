{"version":3,"file":"Table-D-Nfb5o9.js","sources":["../../src/Admin/TableDTO.js","../../src/components/table/Table.js"],"sourcesContent":["export default class TableDTO {\n  constructor(target, prev) {\n    if (!target) return;\n    this.target = target;\n    //model\n    this.id =\n      target?.closest(\".item-wrap\")?.dataset?.id ??\n      target?.dataset?.id ??\n      target?.parentNode?.dataset?.id;\n\n    this.fields = target?.dataset?.field ?? false;\n\n    this.relation =\n      target?.dataset?.relation ??\n      target?.closest(\"[data-relation]\")?.dataset?.relation ??\n      false;\n\n    this.pivot =\n      target?.dataset?.pivot ?? target?.parentNode?.dataset?.pivot ?? false;\n    this.attach =\n      !!this.target?.closest(\"[custom-table]\")?.dataset?.relationtype;\n\n    if (this.fields) {\n      this.fields = {\n        [target?.dataset?.field]:\n          target?.dataset?.value ?? target?.checked ?? target?.innerText,\n      };\n    }\n\n    if (this.relation) {\n      const name = this.relation;\n      this.relation = {};\n      this.relation.name = name;\n      this.relation.id =\n        target?.dataset?.value ??\n        target?.dataset?.id ??\n        0 ??\n        target?.closest(\"[data-relation]\")?.dataset?.relation ??\n        0;\n\n      if (this.attach && !this.pivot) {\n        this.relation.attach =\n          this.target?.dataset?.id ?? this.target?.dataset.value;\n        this.relation.detach = prev ?? null;\n      } else if (this.pivot) {\n        delete this.attach;\n        this.relation.pivot = {};\n        this.relation.pivot[target?.dataset?.pivot] =\n          target?.dataset?.value ?? target?.checked ?? target?.innerText;\n      } else {\n        this.relation.field = {};\n        const fieldName = target?.dataset?.field ?? target?.dataset.pivot;\n        this.relation.field[fieldName] =\n          target?.dataset?.value ?? target?.checked ?? target?.innerText;\n      }\n    }\n    if (!this.fields) delete this.fields;\n    if (!this.relation) delete this.relation;\n    delete this.attach;\n    delete this.pivot;\n    delete this.target;\n  }\n}\n","import \"./table.scss\";\n// import '../select/selectNew.scss';\nimport { $, debounce, post } from \"../../common\";\nimport { ael, qa, qs } from \"@src/constants.js\";\nimport SelectNew from \"../../components/select/SelectNew.js\";\nimport TableDTO from \"@src/Admin/TableDTO.js\";\n\nexport default class Table {\n  constructor(table) {\n    this.table = table;\n    this.model =\n      table.dataset.model ?? table.closest(\"[data-model]\")?.dataset.model;\n    this.modelId =\n      table.dataset.id ?? table.closest(\"[data-model]\")?.dataset.id;\n    this.relation = table.dataset.relation ?? null;\n    this.relationType = table.dataset.relationtype ?? null;\n    this.headers = $(\".head\");\n    this.inputs = $(\"[data-search]\");\n    this.hidden = this.table[qa](\"[hidden]\");\n    this.delUrl = `/adminsc/${this.model}/del`;\n    this.updateOrCreateUrl = `/adminsc/${this.model}/updateOrCreate`;\n\n    this.table[ael](\"click\", this.handleClick.bind(this), true);\n    this.table[ael](\"keyup\", debounce(this.handleKeyup.bind(this)).bind(this));\n    this.table[ael](\"paste\", this.handlePaste.bind(this));\n    this.table[ael](\"customSelect.changed\", this.selectChange.bind(this));\n\n    if (!this.relation) {\n      // this.table[ael]('customSelect.changed', this.selectChange.bind(this));\n      this.table[ael](\"checkbox.changed\", this.checkboxChange.bind(this));\n    }\n    this.setCheckboxes();\n    this.setSelects();\n    this.setSortables();\n  }\n\n  setDelUrl(delUrl) {\n    this.delUrl = delUrl;\n  }\n\n  async checkboxChange(e) {\n    const dto = new TableDTO(e.target);\n    await post(this.updateOrCreateUrl, dto);\n  }\n\n  async selectChange({ detail }) {\n    const target = detail.target;\n    const dto = new TableDTO(target, detail?.prev?.value);\n    const res = await post(`/adminsc/${this.model}/updateorcreate`, dto);\n    if (res?.arr?.detach) {\n      const prevCells = this.table[qa](`[data-id='${detail.prev.value}']`);\n      for (let prevCell of prevCells) {\n        prevCell.dataset.id = detail.next.value;\n      }\n    } else {\n      const prevCells = this.table[qa](`[data-id='0']:not([hidden])`);\n      for (let prevCell of prevCells) {\n        prevCell.dataset.id = detail.next.value;\n      }\n    }\n  }\n\n  async update(modelId, target) {\n    const dto = new TableDTO(target);\n    const res = await post(`/adminsc/${this.model}/updateorcreate`, dto);\n  }\n\n  async handleClick(e) {\n    const target = e.target;\n\n    /// create\n    if (target.className === \"add-model\") {\n      this.copyEmptyRow();\n\n      /// edit\n    } else if (target.classList.contains(\"edit\")) {\n      this.edit(target);\n\n      /// delete\n    } else if (\n      target.classList.contains(\"del\") &&\n      !target.classList.contains(\"head\")\n    ) {\n      this.modelDel(target);\n    } else if (\n      target.classList.contains(\"head\") ||\n      target.classList.contains(\"icon\")\n    ) {\n      const header = target.closest(\".head\");\n      if (header.hasAttribute(\"data-sort\")) {\n        const index = [].findIndex.call(this.sortables, (el, i, inputs) => {\n          return el === header;\n        });\n        this.sortColumn(index);\n      }\n    }\n  }\n\n  edit(target) {\n    if (target.classList.contains(\"head\")) return false;\n    const model = this.relation ? this.relationModel : this.model;\n    const id = this.relation\n      ? target.dataset.id\n      : (this.modelId ?? target.dataset.id);\n    window.location = `/adminsc/${model}/edit/${id}`;\n  }\n\n  getIds() {\n    const els = $(this.table)[0].querySelectorAll(\"[data-id]\");\n    return [].filter.call(els, function (el) {\n      return el.dataset.id !== \"0\";\n    });\n  }\n\n  handlePaste(e) {\n    e.target.innerText = e.clipboardData.getData(\"text/plain\");\n    this.handleInput(e.target);\n    e.target.innerText = \"\";\n  }\n\n  /// INPUT\n  async handleKeyup({ target }) {\n    if (target.hasAttribute(\"data-search\")) {\n      this.search(target);\n    } else if (target.hasAttribute(\"contenteditable\")) {\n      const res = await post(this.updateOrCreateUrl, new TableDTO(target));\n      if (res?.arr?.id) {\n        this.newRow(res?.arr.id);\n      }\n    }\n  }\n\n  // DELETE\n  async modelDel(target) {\n    if (!confirm(\"Удалить?\")) return;\n    const dto = new TableDTO(target);\n    const res = await post(this.delUrl, dto);\n    if (res?.arr?.id) {\n      this.delRow(res?.arr?.id);\n    }\n  }\n\n  // UPDATE OR CREATE\n  async updateOrcreate(target) {\n    const res = await post(this.updateOrCreateUrl, new TableDTO(target));\n    if (res?.arr?.success) {\n      this.copyEmptyRow(target);\n    } else {\n      this.newRow(res?.arr.id);\n    }\n  }\n\n  copyEmptyRow() {\n    [].forEach.call(this.hidden, (cell) => {\n      const cloneCell = cell.cloneNode(true);\n      cloneCell.removeAttribute(\"hidden\");\n      this.addSelectInNewRow(cloneCell);\n      const table = this.table[qa](\".custom-table\")[0];\n      table.append(cloneCell);\n    });\n  }\n\n  newRow(id) {\n    [].forEach.call(\n      this.hidden,\n      function (el) {\n        const newEl = el.cloneNode(true);\n        newEl.removeAttribute(\"hidden\");\n\n        this.addSelectInNewRow(newEl);\n        const tableContent = $(this.table).find(\".custom-table\");\n        tableContent.appendChild(newEl);\n\n        if ([\"id\"].includes(newEl.dataset.field)) {\n          newEl.innerText = id;\n        } else if (\n          !(\n            [\"del\", \"edit\", \"save\"].includes(newEl.className) ||\n            newEl.hasChildNodes(\"select\")\n          )\n        ) {\n          newEl.innerText = \"\";\n        }\n        newEl.dataset[\"id\"] = id;\n      }.bind(this),\n    );\n  }\n\n  addSelectInNewRow(newEl) {\n    if (newEl[qs](\"[select-new]\")) {\n      const select = newEl[qs](\"[select-new]\");\n      this.removeUsedSelectOptions(select);\n      new SelectNew(select);\n    }\n  }\n\n  removeUsedSelectOptions(select) {\n    const usedSelects = this.table[qa](\"[data-attach]\");\n    [].forEach.call(usedSelects, (usedSelects) => {\n      [].forEach.call(select.options, (option) => {\n        if (option.value === usedSelects.dataset.id) option.remove();\n      });\n    });\n  }\n\n  /// SEARCH\n  search(target, iddex) {\n    const rows = this.fillRows();\n    [].forEach.call(rows, (row) => {\n      [].forEach.call(row, (el) => (el.style.display = \"flex\"));\n    });\n\n    [].forEach.call(this.inputs, (input) => {\n      if (input !== target) input.value = \"\";\n    });\n    const targetHead = target.closest(\".head\");\n    const index = [].findIndex.call(this.headers, (el) => {\n      return el === targetHead;\n    });\n    [].forEach.call(rows, function (row) {\n      const str = row[index].innerText;\n      const regexp = new RegExp(`${target.value}`, \"gi\");\n      if (!str.match(regexp)) {\n        [].forEach.call(row, (el) => {\n          el.style.display = \"none\";\n        });\n      }\n    });\n  }\n\n  fillRows() {\n    const rows = [];\n    const ids = this.getIds();\n    for (let i = 0; i < ids.length; i++) {\n      let id = ids[i].dataset.id;\n      let row = $(this.table)[0].querySelectorAll(`[data-id='${id}']`);\n      rows.push(row);\n    }\n    return rows;\n  }\n\n  // SORT\n  sortColumn(index) {\n    const rows = this.fillRows();\n    const direction = this.directions[index] || \"asc\";\n    const multiplier = direction === \"asc\" ? 1 : -1;\n    const newRows = Array.from(rows);\n\n    newRows.sort(\n      function (rowA, rowB) {\n        const cellA = rowA[index].innerHTML;\n        const cellB = rowB[index].innerHTML;\n\n        const a = this.transform(index, cellA);\n        const b = this.transform(index, cellB);\n\n        switch (true) {\n          case a > b:\n            return 1 * multiplier;\n          case a < b:\n            return -1 * multiplier;\n          case a === b:\n            return 0;\n        }\n      }.bind(this),\n    );\n\n    // Удалить старые строки\n    [].forEach.call(rows, function (nodeList) {\n      [].forEach.call(nodeList, (el) => {\n        el.remove();\n      });\n    });\n\n    // Поменять направление\n    this.directions[index] = direction === \"asc\" ? \"desc\" : \"asc\";\n\n    // Добавить новую строку\n    newRows.forEach(\n      function (newRow) {\n        newRow = Array.from(newRow);\n        newRow.reverse();\n        [].forEach.call(newRow, (el) => {\n          this.headers[this.headers.length - 1].after(el);\n        });\n      }.bind(this),\n    );\n  }\n\n  transform(index, content) {\n    // Преобразовать содержимое данной ячейки в заданном столбце\n    if (!this.sortables[index]) return;\n    const type = this.sortables[index].getAttribute(\"data-type\");\n    return type === \"number\" ? parseFloat(content) : content;\n  }\n\n  delRow(id) {\n    const cells = $(`[data-id='${id}']`);\n    [].forEach.call(cells, function (cell) {\n      cell.remove();\n    });\n  }\n\n  setSortables() {\n    this.sortables = $(\"[data-sort]\");\n    this.directions = Array.from(this.sortables).map(function (sortable) {\n      return \"\";\n    });\n  }\n\n  setSelects() {\n    const selects = $(\"[select-new]:has(option)\");\n    [].forEach.call(selects, (select) => {\n      if (!select.parentNode.hasAttribute(\"hidden\")) new SelectNew(select);\n    });\n  }\n\n  setCheckboxes() {\n    const checkboxes = this.table[qa](\"[my-checkbox]\");\n    [].forEach.call(checkboxes, (checkbox) => {\n      checkbox[ael](\"change\", this.checkboxChange.bind(this));\n    });\n  }\n}\n"],"names":["TableDTO","target","prev","name","fieldName","Table","table","$","qa","ael","debounce","delUrl","e","dto","post","detail","prevCells","prevCell","modelId","header","index","el","i","inputs","model","id","els","res","cell","cloneCell","newEl","qs","select","SelectNew","usedSelects","option","iddex","rows","row","input","targetHead","str","regexp","ids","direction","multiplier","newRows","rowA","rowB","cellA","cellB","a","b","nodeList","newRow","content","cells","sortable","selects","checkboxes","checkbox"],"mappings":"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"}