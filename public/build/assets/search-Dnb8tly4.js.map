{"version":3,"file":"search-Dnb8tly4.js","sources":["../../src/components/search/search.js"],"sourcesContent":["import \"./search.scss\";\r\nimport {$, createEl, debounce, post} from '../../common.js'\r\nimport {ael} from \"../../constants.js\";\r\n\r\nexport default class Search {\r\n\r\n   constructor(admin = false) {\r\n\r\n      this.admin = admin;\r\n      const openBtn = $('.utils .search').first();\r\n      const panel = $('.search-panel').first();\r\n\r\n      if (!openBtn || !panel) return;\r\n      this.openBtn = openBtn;\r\n      this.panel = panel;\r\n\r\n      this.text = $(panel).find('.text');\r\n      this.result = $(panel).find('.result');\r\n      this.closeBtn = $(panel).find('.close');\r\n\r\n      this.debouncedKeyUp = debounce(this.find, 800);\r\n\r\n      this.text[ael]('keyup', this.debouncedKeyUp.bind(this))\r\n      this.openBtn[ael]('click', this.togglePanel.bind(this))\r\n      this.closeBtn[ael]('click', this.togglePanel.bind(this))\r\n   }\r\n\r\n   togglePanel() {\r\n      this.panel.classList.toggle('show');\r\n      this.result.innerHTML = '';\r\n      this.text.value = ''\r\n   }\r\n\r\n   async find({target}) {\r\n      this.result.innerHTML = '';\r\n\r\n      const text = target.value;\r\n      if (!text) return false;\r\n      const res = await post('/search', {text});\r\n      if (res?.arr?.found) {\r\n         this.result.style.display = 'initial';\r\n         res?.arr?.found.map((row) => {\r\n            this.result.append(this.createLi(row))\r\n         })\r\n      }\r\n   }\r\n\r\n   createLi(row) {\r\n      const li = createEl('li');\r\n\r\n      const a = createEl('a');\r\n      a.href = this.admin ? `/adminsc/product/edit/${row.id}` : `/product/${row.slug}`;\r\n      if (row.deleted_at) {\r\n         a.classList.add('deleted')\r\n      }\r\n      li.appendChild(a);\r\n      const name = createEl('div', 'name', row.name);\r\n      const art = createEl('div', 'art', row.art);\r\n      const img = createEl('img');\r\n      img.src = row.mainImage;\r\n      a.append(art);\r\n      a.append(name);\r\n      a.append(img);\r\n      li.append(a);\r\n      return li\r\n   }\r\n\r\n\r\n}"],"names":["Search","admin","openBtn","$","panel","debounce","ael","target","text","res","post","row","li","createEl","a","name","art","img"],"mappings":"wEAIe,MAAMA,CAAO,CAEzB,YAAYC,EAAQ,GAAO,CAExB,KAAK,MAAQA,EACb,MAAMC,EAAUC,EAAE,gBAAgB,EAAE,MAAK,EACnCC,EAAQD,EAAE,eAAe,EAAE,MAAK,EAElC,CAACD,GAAW,CAACE,IACjB,KAAK,QAAUF,EACf,KAAK,MAAQE,EAEb,KAAK,KAAOD,EAAEC,CAAK,EAAE,KAAK,OAAO,EACjC,KAAK,OAASD,EAAEC,CAAK,EAAE,KAAK,SAAS,EACrC,KAAK,SAAWD,EAAEC,CAAK,EAAE,KAAK,QAAQ,EAEtC,KAAK,eAAiBC,EAAS,KAAK,KAAM,GAAG,EAE7C,KAAK,KAAKC,CAAG,EAAE,QAAS,KAAK,eAAe,KAAK,IAAI,CAAC,EACtD,KAAK,QAAQA,CAAG,EAAE,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EACtD,KAAK,SAASA,CAAG,EAAE,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EACzD,CAED,aAAc,CACX,KAAK,MAAM,UAAU,OAAO,MAAM,EAClC,KAAK,OAAO,UAAY,GACxB,KAAK,KAAK,MAAQ,EACpB,CAED,MAAM,KAAK,CAAC,OAAAC,CAAM,EAAG,CAClB,KAAK,OAAO,UAAY,GAExB,MAAMC,EAAOD,EAAO,MACpB,GAAI,CAACC,EAAM,MAAO,GAClB,MAAMC,EAAM,MAAMC,EAAK,UAAW,CAAC,KAAAF,CAAI,CAAC,EACpCC,GAAK,KAAK,QACX,KAAK,OAAO,MAAM,QAAU,UAC5BA,GAAK,KAAK,MAAM,IAAKE,GAAQ,CAC1B,KAAK,OAAO,OAAO,KAAK,SAASA,CAAG,CAAC,CACjD,CAAU,EAEN,CAED,SAASA,EAAK,CACX,MAAMC,EAAKC,EAAS,IAAI,EAElBC,EAAID,EAAS,GAAG,EACtBC,EAAE,KAAO,KAAK,MAAQ,yBAAyBH,EAAI,EAAE,GAAK,YAAYA,EAAI,IAAI,GAC1EA,EAAI,YACLG,EAAE,UAAU,IAAI,SAAS,EAE5BF,EAAG,YAAYE,CAAC,EAChB,MAAMC,EAAOF,EAAS,MAAO,OAAQF,EAAI,IAAI,EACvCK,EAAMH,EAAS,MAAO,MAAOF,EAAI,GAAG,EACpCM,EAAMJ,EAAS,KAAK,EAC1B,OAAAI,EAAI,IAAMN,EAAI,UACdG,EAAE,OAAOE,CAAG,EACZF,EAAE,OAAOC,CAAI,EACbD,EAAE,OAAOG,CAAG,EACZL,EAAG,OAAOE,CAAC,EACJF,CACT,CAGJ"}