import{$ as i,d as r,p as d,h as a}from"./common-CU1ZZgk5.js";class p{constructor(t=!1){this.admin=t;let s=i(".utils .search").first(),e=i(".search-panel").first();!s||!e||(this.button=s,this.panel=e,this.text=i(e).find(".text"),this.result=i(e).find(".result"),this.closeBtn=i(e).find(".close"),this.button.onclick=this.showPanel.bind(this),this.panel.onclick=this.closePanel.bind(this),this.debouncedKeyUp=r(this.find,800),this.text.onkeyup=this.debouncedKeyUp.bind(this),this.closeBtn.onklick=this.closePanel.bind(this))}showPanel(){this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value=""}closePanel({target:t}){(t.classList.contains("search-panel")||t.classList.contains("close"))&&(this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value="")}async find({target:t}){this.result.innerHTML="";let s=t.value;if(!s)return!1;let e=await d("/search",{text:s});e?.arr?.found&&(this.result.style.display="initial",this.makeString(e?.arr?.found))}makeString(t){t.map(s=>{this.result.append(this.createLi(s))})}composeHref(t){return this.admin?`/adminsc/product/edit/${t.id}`:`/product/${t.slug}`}createLi(t){let s=a("li"),e=a("a");e.href=this.composeHref(t),t.deleted_at&&e.classList.add("deleted"),s.appendChild(e);let l=a("div","name",t.name),h=a("div","art",t.art),n=a("img");return n.src=t.mainImage,e.append(h),e.append(l),e.append(n),s.append(e),s}}export{p as default};
