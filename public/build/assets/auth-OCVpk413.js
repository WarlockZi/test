const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./login-D5JW1A-X.js","./common-BmR94jh_.js","./modal-DKF24q_4.js","./constants-D_Ps4z6O.js","./modal-CKZnJzOE.css"])))=>i.map(i=>d[i]);
import{$ as s,p as l,_ as d}from"./common-BmR94jh_.js";import"./cookie-BXUjIv5R.js";let o=s(".search input").first();o&&o.addEventListener("input",function(){u(o)});async function u(t){let r=t.parentNode,e=s(r).find(".search__result");if(t.value.length<1){e&&(e.innerHTML="");return}let a=await fetch("/search?q="+t.value);a=await a.json(a),e.childNodes.length!==0&&(e.innerHTML=""),a.map(n=>{let i=document.createElement("a");i.href=n.alias,i.innerHTML=`<img src='/pic/${n.preview_pic}' alt='${n.name}'>`+n.name,e.appendChild(i)}),s("body").on("click",function(n){e&&n.target!==e&&(e.innerHTML="")})}function m(){s(".password-control")&&s(".password-control").on("click",r);function r({target:e}){const a=e.parentNode.querySelector("input");a.getAttribute("type")==="password"?a.setAttribute("type","text"):a.setAttribute("type","password"),e.classList.toggle("view")}}s(".changepassword").on("click",async function(t){let r={old_password:s('[name="old_password"]')[0].value,new_password:s('[name="new_password"]')[0].value},e=s(".message")[0],a=await l("/auth/changepassword",r);a.success?(e.innerText=a.success,s(e).addClass("success"),s(e).removeClass("error")):a.error&&(e.innerText=a.error,s(e).addClass("error"),s(e).removeClass("success"))});let c=s("[data-auth='register']")[0];c&&s(c).on("click",p);function p({target:t}){f(email,password)}async function f(t,r){const e=s(".message")[0],a={email:t,password:r,surName:s("[name='surName']")[0].value,name:s("[name='name']")[0].value},n=await l("/auth/register",a);n?.arr?.success==="confirm"?(e.classList.remove("error"),e.classList.add("success"),e.innerHTML="-Пользователь зарегистрирован.<br>-Для подтверждения регистрации зайдите на почту, <bold>email</bold>.<br> -Перейдите по ссылке в письме."):n.msg==="mail exists"?(e.innerHTML="Эта почта уже зарегистрирована. Войдите в систему по кнопке внизу Войти или, если не помните пароль, восстановите пароль по кнопке Забыл пароль",e.classList.remove("success"),e.classList.add("error")):(e.innerHTML=n.msg,e.classList.remove("success"),e.classList.add("error"))}s("#save").on("click",async function(t){t.preventDefault();let r={name:s('[name = "name"]')[0].value,surName:s('[name = "surName"]')[0].value,middleName:s('[name = "middleName"]')[0].value,birthDate:s('[name = "birthDate"]')[0].value,phone:s('[name = "phone.blade.php"]')[0].value,sex:void 0};await l("/user/edit",r)});const w=s("[data-auth='login']").first();if(w){const{default:t}=await d(async()=>{const{default:r}=await import("./login-D5JW1A-X.js");return{default:r}},__vite__mapDeps([0,1]),import.meta.url);new t}if(s(".modal").first()){const{default:t}=await d(async()=>{const{default:r}=await import("./modal-DKF24q_4.js");return{default:r}},__vite__mapDeps([2,1,3,4]),import.meta.url);new t}m();
//# sourceMappingURL=auth-OCVpk413.js.map
