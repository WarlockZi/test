{"version":3,"file":"Promotion-CQlvPAQ5.js","sources":["../../src/Promotions/Promotion.js"],"sourcesContent":["import './promotion.scss'\r\nimport {$, post} from '../common'\r\nimport SelectNew from \"../components/select/SelectNew\";\r\n\r\nexport default class Promotion {\r\n   constructor() {\r\n      this.$promotion = $('.promotion-edit').first();\r\n      if (!this.$promotion) return;\r\n      this.updateUrl = '/adminsc/promotion/updateOrCreate'\r\n      this.id = $(this.$promotion).find(`[data-field='id']`).innerText;\r\n      this.$count = $(`[data-field='count']`).first();\r\n\r\n      this.$unit = $('[select-new].unit').first();\r\n      new SelectNew(this.$unit);\r\n      $(`[data-field=\"unit\"]`).first().addEventListener('customSelect.changed', this.unitChanged.bind(this));\r\n\r\n      this.$newPrice = $(`[data-field=\"new_price\"]`).first();\r\n\r\n      this.$activeTill = $(`[data-field='active-till']`).first();\r\n      this.$activeTill.addEventListener('change', this.activetillChanged.bind(this));\r\n   }\r\n\r\n   unitChanged(customEvent) {\r\n      let data = this.dto(this);\r\n      data.unit_id = customEvent.detail.next.value;\r\n      let res = post(this.updateUrl, data);\r\n\r\n   }\r\n\r\n   async activetillChanged({target}) {\r\n      let data = this.dto(this);\r\n      data.active_till = target.value;\r\n      let res = await post(this.updateUrl, data);\r\n      if (res) {\r\n      }\r\n   }\r\n\r\n   dto(self) {\r\n      return {\r\n         id: this.id,\r\n      }\r\n   }\r\n\r\n\r\n}"],"names":["Promotion","$","SelectNew","customEvent","data","post","target","self"],"mappings":"4FAIe,MAAMA,CAAU,CAC5B,aAAc,CACX,KAAK,WAAaC,EAAE,iBAAiB,EAAE,MAAK,EACvC,KAAK,aACV,KAAK,UAAY,oCACjB,KAAK,GAAKA,EAAE,KAAK,UAAU,EAAE,KAAK,mBAAmB,EAAE,UACvD,KAAK,OAASA,EAAE,sBAAsB,EAAE,QAExC,KAAK,MAAQA,EAAE,mBAAmB,EAAE,MAAK,EACzC,IAAIC,EAAU,KAAK,KAAK,EACxBD,EAAE,qBAAqB,EAAE,MAAK,EAAG,iBAAiB,uBAAwB,KAAK,YAAY,KAAK,IAAI,CAAC,EAErG,KAAK,UAAYA,EAAE,0BAA0B,EAAE,QAE/C,KAAK,YAAcA,EAAE,4BAA4B,EAAE,QACnD,KAAK,YAAY,iBAAiB,SAAU,KAAK,kBAAkB,KAAK,IAAI,CAAC,EAC/E,CAED,YAAYE,EAAa,CACtB,IAAIC,EAAO,KAAK,IAAI,IAAI,EACxBA,EAAK,QAAUD,EAAY,OAAO,KAAK,MAC7BE,EAAK,KAAK,UAAWD,CAAI,CAErC,CAED,MAAM,kBAAkB,CAAC,OAAAE,CAAM,EAAG,CAC/B,IAAIF,EAAO,KAAK,IAAI,IAAI,EACxBA,EAAK,YAAcE,EAAO,MAChB,MAAMD,EAAK,KAAK,UAAWD,CAAI,CAG3C,CAED,IAAIG,EAAM,CACP,MAAO,CACJ,GAAI,KAAK,EACX,CACH,CAGJ"}