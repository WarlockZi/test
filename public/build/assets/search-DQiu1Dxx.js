import{$ as i,d,p as r,h as a}from"./constants-D6t7YzCi.js";class p{constructor(e=!1){this.admin=e;let s=i(".utils .search").first(),t=i(".search-panel").first();!s||!t||(this.button=s,this.panel=t,this.text=i(t).find(".text"),this.result=i(t).find(".result"),this.closeBtn=i(t).find(".close"),this.button.onclick=this.showPanel.bind(this),this.panel.onclick=this.closePanel.bind(this),this.debouncedKeyUp=d(this.find,800),this.text.onkeyup=this.debouncedKeyUp.bind(this),this.closeBtn.onklick=this.closePanel.bind(this))}showPanel(){this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value=""}closePanel({target:e}){(e.classList.contains("search-panel")||e.classList.contains("close"))&&(this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value="")}async find({target:e}){var n,l;this.result.innerHTML="";let s=e.value;if(!s)return!1;let t=await r("/search",{text:s});(n=t==null?void 0:t.arr)!=null&&n.found&&(this.result.style.display="initial",this.makeString((l=t==null?void 0:t.arr)==null?void 0:l.found))}makeString(e){e.map(s=>{this.result.append(this.createLi(s))})}composeHref(e){return this.admin?`/adminsc/product/edit/${e.id}`:`/product/${e.slug}`}createLi(e){let s=a("li"),t=a("a");t.href=this.composeHref(e),e.deleted_at&&t.classList.add("deleted"),s.appendChild(t);let n=a("div","name",e.name),l=a("div","art",e.art),h=a("img");return h.src=e.mainImage,t.append(l),t.append(n),t.append(h),s.append(t),s}}export{p as default};
