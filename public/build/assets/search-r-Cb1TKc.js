import{$ as a,f as h,p,i as n}from"./common-rqzyLVVo.js";import{a as d}from"./constants-D_Ps4z6O.js";class f{constructor(s=0,e=null){this.id=s??e?.parentNode?.dataset?.id??0,this.attach=e?.parentNode?.dataset?.attach??!1,this.fields={[e?.dataset?.field]:e?.dataset?.value??e?.checked??e?.innerText};const t=e?.dataset?.field,i=t?{[t]:e?.dataset?.value??e.innerText??e.checked}:{};this.relation={name:e?.dataset?.relation??e?.closest("[data-relation]")?.dataset?.relation??"",id:e?.dataset?.value??e?.dataset?.id??0,fields:i,pivot:{field:e?.dataset?.pivotField??e?.parentNode?.dataset?.pivot,value:e?.dataset?.pivotValue??e?.innerText}}}}class m{constructor(s=!1){this.admin=s;const e=a(".utils .search").first(),t=a(".search-panel").first();!e||!t||(this.openBtn=e,this.panel=t,this.text=a(t).find(".text"),this.result=a(t).find(".result"),this.closeBtn=a(t).find(".close"),this.debouncedKeyUp=h(this.find,800),this.text[d]("keyup",this.debouncedKeyUp.bind(this)),this.openBtn[d]("click",this.togglePanel.bind(this)),this.closeBtn[d]("click",this.togglePanel.bind(this)))}togglePanel(){window.ym==!0&&YM("click_search"),this.panel.classList.toggle("show"),this.result.innerHTML="",this.text.value=""}async find({target:s}){this.result.innerHTML="";const e=s.value;if(!e)return!1;const t=await p("/search",{text:e});t?.arr?.found&&(this.result.style.display="initial",t?.arr?.found.map(i=>{this.result.append(this.createLi(i))}))}createLi(s){const e=n("li"),t=n("a");t.href=this.admin?`/adminsc/product/edit/${s.id}`:`/product/${s.slug}`,s.deleted_at&&t.classList.add("deleted"),e.appendChild(t);const i=n("div","name",s.name),o=n("div","art",s.art),l=n("img");return l.src=s.mainImage,t.append(o),t.append(i),t.append(l),e.append(t),e}}export{f as D,m as S};
//# sourceMappingURL=search-r-Cb1TKc.js.map
