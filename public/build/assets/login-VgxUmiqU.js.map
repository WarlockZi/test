{"version":3,"file":"login-VgxUmiqU.js","sources":["../../src/Auth/login.js"],"sourcesContent":["import { $, post, validate } from \"../common\";\n\nexport default class Login {\n  constructor() {\n    this.loginForm = $(\"[data-auth='login']\").first();\n    if (!this.loginForm) return false;\n    this.loginForm.addEventListener(\"click\", this.sendData.bind(this));\n    this.email = $(\"input[type = email]\")[0];\n    this.pass = $(\"input[name= password]\")[0];\n    this.msg = $(\".message\")[0];\n  }\n\n  async sendData({ target }) {\n    if (target.classList.contains(\"submit__button\")) {\n      let data = {\n        email: this.email.value,\n        password: this.pass.value,\n      };\n      if (this.validateData()) {\n        const res = await this.send(data);\n        await this.parseLoginResponse(res);\n      }\n    }\n  }\n\n  validateData() {\n    let error = validate.email(this.email.value);\n    if (error) {\n      this.msg.innerText = \"\";\n      this.msg.innerText = error;\n      $(this.msg).addClass(\"error\");\n      return false;\n    }\n    const suemail = env?.VITE_SU_EMAIL;\n    const su = suemail === this.email.value;\n    if (!su) {\n      error = validate.password(this.pass.value);\n      if (error) {\n        this.msg.innerText = \"\";\n        this.msg.innerText = error;\n        $(this.msg).addClass(\"error\");\n        return false;\n      }\n    }\n    return true;\n  }\n\n  async send(data) {\n    return await post(\"/auth/login\", data);\n  }\n\n  async parseLoginResponse(res) {\n    const id = res?.arr?.id;\n    localStorage.setItem(\"id\", id);\n    if (res?.arr?.role === \"employee\") {\n      window.location = \"/adminsc\";\n    } else if (res?.arr?.role === \"user\") {\n      window.location = \"/auth/profile\";\n    } else if (res?.error) {\n    }\n  }\n}\n"],"names":["Login","$","target","data","res","error","validate","define_env_default","post","id"],"mappings":"kGAEA,MAAqBA,CAAM,CACzB,aAAc,CAER,GADJ,KAAK,UAAYC,EAAE,qBAAqB,EAAE,MAAM,EAC5C,CAAC,KAAK,UAAkB,MAAA,GAC5B,KAAK,UAAU,iBAAiB,QAAS,KAAK,SAAS,KAAK,IAAI,CAAC,EACjE,KAAK,MAAQA,EAAE,qBAAqB,EAAE,CAAC,EACvC,KAAK,KAAOA,EAAE,uBAAuB,EAAE,CAAC,EACxC,KAAK,IAAMA,EAAE,UAAU,EAAE,CAAC,CAAA,CAG5B,MAAM,SAAS,CAAE,OAAAC,GAAU,CACzB,GAAIA,EAAO,UAAU,SAAS,gBAAgB,EAAG,CAC/C,IAAIC,EAAO,CACT,MAAO,KAAK,MAAM,MAClB,SAAU,KAAK,KAAK,KACtB,EACI,GAAA,KAAK,eAAgB,CACvB,MAAMC,EAAM,MAAM,KAAK,KAAKD,CAAI,EAC1B,MAAA,KAAK,mBAAmBC,CAAG,CAAA,CACnC,CACF,CAGF,cAAe,CACb,IAAIC,EAAQC,EAAS,MAAM,KAAK,MAAM,KAAK,EAC3C,OAAID,GACF,KAAK,IAAI,UAAY,GACrB,KAAK,IAAI,UAAYA,EACrBJ,EAAE,KAAK,GAAG,EAAE,SAAS,OAAO,EACrB,IAIL,EAFYM,GAAK,gBACE,KAAK,MAAM,SAEhCF,EAAQC,EAAS,SAAS,KAAK,KAAK,KAAK,EACrCD,IACF,KAAK,IAAI,UAAY,GACrB,KAAK,IAAI,UAAYA,EACrBJ,EAAE,KAAK,GAAG,EAAE,SAAS,OAAO,EACrB,IAGJ,EAAA,CAGT,MAAM,KAAKE,EAAM,CACR,OAAA,MAAMK,EAAK,cAAeL,CAAI,CAAA,CAGvC,MAAM,mBAAmBC,EAAK,CACtB,MAAAK,EAAKL,GAAK,KAAK,GACR,aAAA,QAAQ,KAAMK,CAAE,EACzBL,GAAK,KAAK,OAAS,WACrB,OAAO,SAAW,WACTA,GAAK,KAAK,OAAS,OAC5B,OAAO,SAAW,gBACTA,GAAK,KAChB,CAEJ"}