{"version":3,"file":"Category-BJ4RNipb.js","sources":["../../src/Admin/Category/PropertyTable.js","../../src/Admin/Category/Category.js"],"sourcesContent":["import { $, post } from \"../../common.js\";\nimport SelectNew from \"../../components/select/SelectNew\";\nimport { ael, qa, qs } from \"../../constants.js\";\n\nexport default class PropertyTable {\n  constructor(el) {\n    this.el = el;\n    // this.rowsWrap = this.el[qs]('.rows');\n    // this.rows = this.el[qa]('.rows>.row');\n    this.$addBtn = this.el[qs](\".add-property\");\n\n    if (this.$addBtn) this.$addBtn[ael](\"click\", this.newRow.bind(this));\n  }\n\n  async handleClick({ target }) {\n    {\n      if (target.classList.contains(\"del\")) {\n        this.deleteRow(target);\n      } else if (target.classList.contains(\"edit\")) {\n        this.editProperty(target);\n      }\n    }\n  }\n\n  async editProperty(target) {\n    let id = target.closest(\".row\").querySelector(\"[select-new]\").dataset.value;\n    location.href = `/adminsc/property/edit/${id}`;\n  }\n\n  async deleteRow(target) {\n    let $row = target.closest(\".row\");\n    let $selector = $($row).find(\"[select-new]\");\n    let id = +$selector.dataset.value;\n    let data = this.dto();\n    data.morphed.new_id = 0;\n    data.morphed.old_id = id;\n    let res = await post(`/adminsc/category/changeProperty`, data);\n    if (res?.ok) $row.remove();\n  }\n\n  async propertyChange(obj) {\n    {\n      let data = this.dto(obj);\n      let res = await post(`/adminsc/category/changeProperty`, data);\n    }\n  }\n\n  dto(obj = {}) {\n    return {\n      category_id: this.el.closest(`[data-model=\"category\"]`).dataset.id,\n      morphed: {\n        old_id: +obj?.detail?.prev?.value,\n        new_id: +obj?.detail?.next?.value,\n      },\n    };\n  }\n\n  newRow() {\n    let $clone = this.rowsWrap.querySelector(\".none .row\").cloneNode(true);\n    new SelectNew($($clone).find(\"[custom-select]\"));\n    this.rowsWrap.append($clone);\n  }\n}\n","import \"../Product/product.scss\";\nimport \"./category.scss\";\nimport PropertyTable from \"./PropertyTable\";\nimport { $, post } from \"../../common.js\";\nimport SelectNew from \"../../components/select/SelectNew\";\nimport QuillFactory from \"@src/components/quill/QuillFactory.js\";\nimport { QuillConst } from \"@src/components/quill/QuillConstans.js\";\n\nexport default class Category {\n  constructor(el) {\n    this.el = el;\n    this.id = el.dataset.id;\n    this.setCategoryId();\n    this.setProperties();\n    QuillFactory.create(\"#seo-article\", QuillConst.ADMIN_CATEGORY_SEO_ARTICLE);\n  }\n\n  setCategoryId() {\n    const el = $(`[data-field='category_id']`).first();\n    const parentSelector = new SelectNew(el);\n  }\n\n  setProperties() {\n    new PropertyTable(this.el.querySelector(`[data-relation=\"properties\"]`));\n  }\n\n  dto(change) {\n    return {\n      id: this.id,\n      relation: \"ownProperties\",\n      fields: {\n        seo_article: change,\n      },\n    };\n  }\n\n  attachCategory({ detail }) {\n    const data = {\n      id: this.id,\n      relation: detail.target.dataset.relationmodel,\n      fields: {\n        category_id: +detail.next.value,\n      },\n    };\n    post(`/adminsc/category/updateOrCreate`, data);\n  }\n}\n"],"names":["PropertyTable","el","qs","ael","target","id","$row","$","data","post","obj","$clone","SelectNew","Category","QuillFactory","QuillConst","change","detail"],"mappings":"4RAIe,MAAMA,CAAc,CACjC,YAAYC,EAAI,CACd,KAAK,GAAKA,EAGV,KAAK,QAAU,KAAK,GAAGC,CAAE,EAAE,eAAe,EAEtC,KAAK,SAAS,KAAK,QAAQC,CAAG,EAAE,QAAS,KAAK,OAAO,KAAK,IAAI,CAAC,CACvE,CAEE,MAAM,YAAY,CAAE,OAAAC,GAAU,CAEtBA,EAAO,UAAU,SAAS,KAAK,EACjC,KAAK,UAAUA,CAAM,EACZA,EAAO,UAAU,SAAS,MAAM,GACzC,KAAK,aAAaA,CAAM,CAGhC,CAEE,MAAM,aAAaA,EAAQ,CACzB,IAAIC,EAAKD,EAAO,QAAQ,MAAM,EAAE,cAAc,cAAc,EAAE,QAAQ,MACtE,SAAS,KAAO,0BAA0BC,CAAE,EAChD,CAEE,MAAM,UAAUD,EAAQ,CACtB,IAAIE,EAAOF,EAAO,QAAQ,MAAM,EAE5BC,EAAK,CADOE,EAAED,CAAI,EAAE,KAAK,cAAc,EACvB,QAAQ,MACxBE,EAAO,KAAK,IAAK,EACrBA,EAAK,QAAQ,OAAS,EACtBA,EAAK,QAAQ,OAASH,GACZ,MAAMI,EAAK,mCAAoCD,CAAI,IACpD,IAAIF,EAAK,OAAQ,CAC9B,CAEE,MAAM,eAAeI,EAAK,CACxB,CACE,IAAIF,EAAO,KAAK,IAAIE,CAAG,EACb,MAAMD,EAAK,mCAAoCD,CAAI,CACnE,CACA,CAEE,IAAIE,EAAM,GAAI,CACZ,MAAO,CACL,YAAa,KAAK,GAAG,QAAQ,yBAAyB,EAAE,QAAQ,GAChE,QAAS,CACP,OAAQ,CAACA,GAAK,QAAQ,MAAM,MAC5B,OAAQ,CAACA,GAAK,QAAQ,MAAM,KAC7B,CACF,CACL,CAEE,QAAS,CACP,IAAIC,EAAS,KAAK,SAAS,cAAc,YAAY,EAAE,UAAU,EAAI,EACrE,IAAIC,EAAUL,EAAEI,CAAM,EAAE,KAAK,iBAAiB,CAAC,EAC/C,KAAK,SAAS,OAAOA,CAAM,CAC/B,CACA,CCtDe,MAAME,CAAS,CAC5B,YAAYZ,EAAI,CACd,KAAK,GAAKA,EACV,KAAK,GAAKA,EAAG,QAAQ,GACrB,KAAK,cAAe,EACpB,KAAK,cAAe,EACpBa,EAAa,OAAO,eAAgBC,EAAW,0BAA0B,CAC7E,CAEE,eAAgB,CACd,MAAMd,EAAKM,EAAE,4BAA4B,EAAE,MAAO,EAC3B,IAAIK,EAAUX,CAAE,CAC3C,CAEE,eAAgB,CACd,IAAID,EAAc,KAAK,GAAG,cAAc,8BAA8B,CAAC,CAC3E,CAEE,IAAIgB,EAAQ,CACV,MAAO,CACL,GAAI,KAAK,GACT,SAAU,gBACV,OAAQ,CACN,YAAaA,CACd,CACF,CACL,CAEE,eAAe,CAAE,OAAAC,GAAU,CACzB,MAAMT,EAAO,CACX,GAAI,KAAK,GACT,SAAUS,EAAO,OAAO,QAAQ,cAChC,OAAQ,CACN,YAAa,CAACA,EAAO,KAAK,KAC3B,CACF,EACDR,EAAK,mCAAoCD,CAAI,CACjD,CACA"}