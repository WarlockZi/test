import{$ as a,v as e,p as n}from"./common-HbR8gfPR.js";class l{constructor(){if(this.loginForm=a("[data-auth='login']").first(),!this.loginForm)return!1;this.loginForm.addEventListener("click",this.sendData.bind(this)),this.email=a("input[type = email]")[0],this.pass=a("input[name= password]")[0],this.msg=a(".message")[0]}async sendData({target:s}){if(s.classList.contains("submit__button")){let i={email:this.email.value,password:this.pass.value};if(this.validateData()){const t=await this.send(i);await this.parseLoginResponse(t)}}}validateData(){let s=e.email(this.email.value);return s?(this.msg.innerText="",this.msg.innerText=s,a(this.msg).addClass("error"),!1):!(env.VITE_SU_EMAIL===this.email.value)&&(s=e.password(this.pass.value),s)?(this.msg.innerText="",this.msg.innerText=s,a(this.msg).addClass("error"),!1):!0}async send(s){return await n("/auth/login",s)}async parseLoginResponse(s){const i=s?.arr?.id;localStorage.setItem("id",i),s?.arr?.role==="employee"?window.location="/adminsc":s?.arr?.role==="user"?window.location="/auth/cabinet":s?.error}}export{l as default};
