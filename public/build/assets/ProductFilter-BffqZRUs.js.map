{"version":3,"file":"ProductFilter-BffqZRUs.js","sources":["../../src/Admin/ProductFilter/ProductFilter.js"],"sourcesContent":["import \"./ProductFilter.scss\";\nimport { ael, qa, qs } from \"@src/constants.js\";\nimport { $, post } from \"@src/common.js\";\nimport SelectNew from \"@src/components/select/SelectNew.js\";\n\nexport default class ProductFilter {\n  constructor(productsFilter) {\n    if (!productsFilter) return;\n    this.wrap = productsFilter;\n    this.panel = productsFilter[qs](\".list-filter\");\n    this.url = \"/adminsc/report/updateFilter\";\n    this.wrap[ael](\"click\", this.handleClick.bind(this));\n    this.checkboxes = Array.from(this.panel[qa](`[type='checkbox']`));\n    this.selects = Array.from(this.wrap[qa](`[select-new]`));\n\n    this.setSelects();\n  }\n\n  setSelects() {\n    [].map.call(this.selects, (select) => {\n      new SelectNew(select);\n    });\n  }\n\n  async handleClick(e) {\n    const target = e.target;\n    if (target.classList.contains(\"filter-button\")) {\n      e.preventDefault();\n      const req = this.getClickedFilters();\n      const res = await post(this.url, req);\n      this.renderDataFromResponce(res);\n    }\n  }\n\n  getClickedFilters() {\n    const req = {};\n\n    req.toSelect = this.selects\n      .filter((select) => select.dataset.value !== \"0\")\n      .reduce((obj, select) => {\n        obj[select.getAttribute(\"name\")] = select.dataset.value;\n        return obj;\n      }, {});\n\n    req.toSave = this.checkboxes\n      .filter((check) => check.checked === true)\n      .map((check) => check.name);\n\n    return req;\n  }\n\n  renderDataFromResponce(res) {\n    $(\".used-filters\").first().innerHTML = res?.arr?.filterString;\n    $(\".list-filter\").first().innerHTML = res?.arr?.filterPanel;\n    const table = $(\"[custom-table]\").first();\n    table.innerHTML = res?.arr?.productsTable;\n    this.setSelects();\n  }\n}\n"],"names":["ProductFilter","productsFilter","qs","ael","qa","select","SelectNew","e","req","res","post","obj","check","$","table"],"mappings":"wSAKe,MAAMA,CAAc,CACjC,YAAYC,EAAgB,CACrBA,IACL,KAAK,KAAOA,EACZ,KAAK,MAAQA,EAAeC,CAAE,EAAE,cAAc,EAC9C,KAAK,IAAM,+BACX,KAAK,KAAKC,CAAG,EAAE,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EACnD,KAAK,WAAa,MAAM,KAAK,KAAK,MAAMC,CAAE,EAAE,mBAAmB,CAAC,EAChE,KAAK,QAAU,MAAM,KAAK,KAAK,KAAKA,CAAE,EAAE,cAAc,CAAC,EAEvD,KAAK,WAAY,EACrB,CAEE,YAAa,CACX,CAAE,EAAC,IAAI,KAAK,KAAK,QAAUC,GAAW,CACpC,IAAIC,EAAUD,CAAM,CAC1B,CAAK,CACL,CAEE,MAAM,YAAYE,EAAG,CAEnB,GADeA,EAAE,OACN,UAAU,SAAS,eAAe,EAAG,CAC9CA,EAAE,eAAgB,EAClB,MAAMC,EAAM,KAAK,kBAAmB,EAC9BC,EAAM,MAAMC,EAAK,KAAK,IAAKF,CAAG,EACpC,KAAK,uBAAuBC,CAAG,CACrC,CACA,CAEE,mBAAoB,CAClB,MAAMD,EAAM,CAAE,EAEd,OAAAA,EAAI,SAAW,KAAK,QACjB,OAAQH,GAAWA,EAAO,QAAQ,QAAU,GAAG,EAC/C,OAAO,CAACM,EAAKN,KACZM,EAAIN,EAAO,aAAa,MAAM,CAAC,EAAIA,EAAO,QAAQ,MAC3CM,GACN,EAAE,EAEPH,EAAI,OAAS,KAAK,WACf,OAAQI,GAAUA,EAAM,UAAY,EAAI,EACxC,IAAKA,GAAUA,EAAM,IAAI,EAErBJ,CACX,CAEE,uBAAuBC,EAAK,CAC1BI,EAAE,eAAe,EAAE,MAAK,EAAG,UAAYJ,GAAK,KAAK,aACjDI,EAAE,cAAc,EAAE,MAAK,EAAG,UAAYJ,GAAK,KAAK,YAChD,MAAMK,EAAQD,EAAE,gBAAgB,EAAE,MAAO,EACzCC,EAAM,UAAYL,GAAK,KAAK,cAC5B,KAAK,WAAY,CACrB,CACA"}