{"version":3,"file":"catalog-item-Bd6t51-i.js","sources":["../../src/components/date/date.js","../../src/components/checkbox/checkbox.js","../../src/Admin/components/catalog-item/catalog-item.js"],"sourcesContent":["import {fragmentDate} from '../../common'\r\nimport './date.scss'\r\nimport {ael} from \"@src/constants.js\";\r\n\r\nexport default class CustomDate {\r\n   constructor(date) {\r\n      this.date = date;\r\n      this.date[ael]('change', this.onChange.bind(this));\r\n   }\r\n\r\n   onChange({target}) {\r\n      const {yyyy, mm, dd} = fragmentDate(target.value)\r\n      const formated = `${yyyy}-${mm}-${dd}`\r\n      target.setAttribute('data-value', formated)\r\n      const customEvent =\r\n         new CustomEvent('date.changed',\r\n            {bubbles: true, cancelable: true, detail: {value: formated}}\r\n         )\r\n      target.dispatchEvent(customEvent)\r\n   }\r\n}\r\n","import {ael} from \"@src/constants.js\";\r\n\r\nexport default class Checkbox {\r\n   constructor(checkbox) {\r\n      this.id = checkbox.id;\r\n      this.checkbox = checkbox;\r\n      checkbox[ael]('change', this.changed.bind(this));\r\n   }\r\n\r\n   async changed({target}) {\r\n      target.dataset.pivotValue= +target.checked\r\n      this.checkbox.dispatchEvent(\r\n         new CustomEvent('checkbox.changed', {\r\n            bubbles:true,\r\n            detail: target.checked})\r\n      );\r\n   }\r\n}","import './catalog-item.scss';\r\nimport {$, debounce, post} from '@src/common.js';\r\nimport {ael} from \"@src/constants.js\";\r\nimport DTO from \"@src/Admin/DTO.js\";\r\nimport Checkbox from \"@src/components/checkbox/checkbox.js\";\r\nimport SelectNew from \"@src/components/select/SelectNew.js\";\r\nimport CustomDate from \"@src/components/date/date.js\";\r\n\r\nexport default class CatalogItem {\r\n   constructor(catalogItem) {\r\n      if (!catalogItem) return false\r\n\r\n      this.model = catalogItem.dataset.model;\r\n      this.id = +catalogItem.dataset.id;\r\n      this.setCheckboxes()\r\n      this.setSelects()\r\n      this.setDates()\r\n\r\n      catalogItem[ael]('click', this.handleClick.bind(this))\r\n      catalogItem[ael]('keyup', debounce(this.handleKeyup.bind(this)))\r\n      catalogItem[ael]('date.changed', this.handleDateChange.bind(this))\r\n      catalogItem[ael]('customSelect.changed', this.handleSelectChange.bind(this))\r\n      catalogItem[ael]('checkbox.changed', this.handleChexboxChange.bind(this))\r\n   }\r\n   setCheckboxes() {\r\n      const checks = $('[my-checkbox]');\r\n      [].forEach.call(checks, function (check){\r\n         new Checkbox(check)\r\n      })\r\n   }\r\n   setDates() {\r\n      const dates = $('[custom-date]');\r\n      [].forEach.call(dates, function (date){\r\n         new CustomDate(date)\r\n      })\r\n   }\r\n   setSelects() {\r\n      const selects = $('[select-new]:has(option)');\r\n      [].forEach.call(selects, function (select){\r\n         new SelectNew(select)\r\n      })\r\n   }\r\n   async handleChexboxChange({target}) {\r\n      this.update(target)\r\n   }\r\n   async handleSelectChange({target}) {\r\n      this.update(target)\r\n   }\r\n\r\n   async handleDateChange({target}) {\r\n      this.update(target)\r\n   }\r\n\r\n   async handleKeyup({target}) {\r\n      if (!target.hasAttribute('contenteditable') ||\r\n         !target.dataset.field) return false\r\n      const dto = new DTO(this.id, target)\r\n      const res = await post(`/adminsc/${this.model}/updateOrCreate`, dto)\r\n      if (res) {\r\n         target.dispatchEvent(new CustomEvent('catalogItem.changed',\r\n            {bubbles: true, detail: {res}})\r\n         )\r\n      }\r\n   }\r\n\r\n   async handleClick({target}) {\r\n      if ((target.classList.contains('tab'))) {\r\n         this.handleTabClick(target)\r\n      }\r\n   }\r\n\r\n   handleTabClick(target) {\r\n      $(`[data-tab].show`).first().classList.toggle('show');\r\n      $(`[data-tab='${target.dataset.tabId}']`).first().classList.toggle('show');\r\n      $(`.tab.active`).first().classList.toggle('active');\r\n      target.classList.toggle('active')\r\n   }\r\n\r\n   async update(target) {\r\n      const dto = new DTO(this.id, target)\r\n      let res = await post(`/adminsc/${this.model}/updateorcreate`, dto)\r\n   }\r\n}"],"names":["CustomDate","date","ael","target","yyyy","mm","dd","fragmentDate","formated","customEvent","Checkbox","checkbox","CatalogItem","catalogItem","debounce","checks","$","check","dates","selects","select","SelectNew","dto","DTO","res","post"],"mappings":"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"}