{"version":3,"file":"Fields-DcovJGfv.js","sources":["../../src/Admin/Product/Fields.js"],"sourcesContent":["import SelectNew from \"../../components/select/SelectNew\";\nimport { $, post } from \"../../common.js\";\n\nexport default class Fields {\n  constructor($product) {\n    this.$product = $product;\n    this.$fields = $(\".item_content\").first();\n\n    this.$promotions = $(`[data-field=\"active_promotions\"]`).first();\n    this.$category_id = $(`[data-field=\"category_id\"]`).first();\n    this.$base_unit = $(`[data-field=\"base_unit\"]`).first();\n    this.$manufacturer_id = $(`[data-field=\"manufacturer\"]`).first();\n    this.$printName = $(`[data-field='print_name']`).first();\n    this.$printName.addEventListener(\n      \"catalogItem.changed\",\n      this.changePrintName.bind(this),\n    );\n\n    this.$productUrl = $(`[data-field='slug']`).first();\n    this.setup();\n  }\n\n  setup() {\n    this.$fields.addEventListener(\n      \"customSelect.changed\",\n      this.changeFields.bind(this),\n    );\n    new SelectNew(this.$category_id);\n    new SelectNew(this.$promotions);\n    new SelectNew(this.$base_unit);\n    new SelectNew(this.$manufacturer_id);\n  }\n\n  changePrintName(item) {\n    if (item.detail) {\n      let $url = this.$productUrl.querySelector(\"a\");\n      let slug = item.detail?.res?.arr?.model.slug;\n      $url.setAttribute(\"href\", `/product/${slug}`);\n      $url.text = slug;\n    }\n  }\n\n  async checkBoxChanged({ target }) {\n    let data = this.dto(this);\n    data[target.dataset.field] = +target.checked;\n    let res = await post(\"/adminsc/product/updateOrCreate\", data);\n  }\n\n  async changeFields(obj) {\n    let field = obj.detail.target.dataset.field;\n    if (!field) return;\n    let data = this.dto(obj);\n    data[field] = obj.detail.next.value;\n    let res = await post(\"/adminsc/product/updateOrCreate\", data);\n  }\n\n  dto(obj) {\n    return {\n      id: this.$product.dataset.id,\n    };\n  }\n}\n"],"names":["Fields","$product","$","SelectNew","item","$url","slug","target","data","post","obj","field"],"mappings":"yJAGe,MAAMA,CAAO,CAC1B,YAAYC,EAAU,CACpB,KAAK,SAAWA,EAChB,KAAK,QAAUC,EAAE,eAAe,EAAE,MAAO,EAEzC,KAAK,YAAcA,EAAE,kCAAkC,EAAE,MAAO,EAChE,KAAK,aAAeA,EAAE,4BAA4B,EAAE,MAAO,EAC3D,KAAK,WAAaA,EAAE,0BAA0B,EAAE,MAAO,EACvD,KAAK,iBAAmBA,EAAE,6BAA6B,EAAE,MAAO,EAChE,KAAK,WAAaA,EAAE,2BAA2B,EAAE,MAAO,EACxD,KAAK,WAAW,iBACd,sBACA,KAAK,gBAAgB,KAAK,IAAI,CAC/B,EAED,KAAK,YAAcA,EAAE,qBAAqB,EAAE,MAAO,EACnD,KAAK,MAAO,CAChB,CAEE,OAAQ,CACN,KAAK,QAAQ,iBACX,uBACA,KAAK,aAAa,KAAK,IAAI,CAC5B,EACD,IAAIC,EAAU,KAAK,YAAY,EAC/B,IAAIA,EAAU,KAAK,WAAW,EAC9B,IAAIA,EAAU,KAAK,UAAU,EAC7B,IAAIA,EAAU,KAAK,gBAAgB,CACvC,CAEE,gBAAgBC,EAAM,CACpB,GAAIA,EAAK,OAAQ,CACf,IAAIC,EAAO,KAAK,YAAY,cAAc,GAAG,EACzCC,EAAOF,EAAK,QAAQ,KAAK,KAAK,MAAM,KACxCC,EAAK,aAAa,OAAQ,YAAYC,CAAI,EAAE,EAC5CD,EAAK,KAAOC,CAClB,CACA,CAEE,MAAM,gBAAgB,CAAE,OAAAC,GAAU,CAChC,IAAIC,EAAO,KAAK,IAAI,IAAI,EACxBA,EAAKD,EAAO,QAAQ,KAAK,EAAI,CAACA,EAAO,QAC3B,MAAME,EAAK,kCAAmCD,CAAI,CAChE,CAEE,MAAM,aAAaE,EAAK,CACtB,IAAIC,EAAQD,EAAI,OAAO,OAAO,QAAQ,MACtC,GAAI,CAACC,EAAO,OACZ,IAAIH,EAAO,KAAK,IAAIE,CAAG,EACvBF,EAAKG,CAAK,EAAID,EAAI,OAAO,KAAK,MACpB,MAAMD,EAAK,kCAAmCD,CAAI,CAChE,CAEE,IAAIE,EAAK,CACP,MAAO,CACL,GAAI,KAAK,SAAS,QAAQ,EAC3B,CACL,CACA"}